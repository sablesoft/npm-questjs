{"version":3,"file":"quest.umd.cjs","sources":["../src/lib/_util.js","../src/lib/_settings.js","../src/lang/lang-en.js","../src/lib/_file_saver.js","../src/lib/_saveload.js","../src/lib/_text.js","../src/lib/_io.js","../src/lib/_command.js","../src/lib/_defaults.js","../node_modules/picocolors/picocolors.browser.js","../__vite-browser-external","../node_modules/postcss/lib/css-syntax-error.js","../node_modules/postcss/lib/symbols.js","../node_modules/postcss/lib/stringifier.js","../node_modules/postcss/lib/stringify.js","../node_modules/postcss/lib/node.js","../node_modules/postcss/lib/declaration.js","../node_modules/nanoid/non-secure/index.cjs","../node_modules/postcss/lib/previous-map.js","../node_modules/postcss/lib/input.js","../node_modules/postcss/lib/map-generator.js","../node_modules/postcss/lib/comment.js","../node_modules/postcss/lib/container.js","../node_modules/postcss/lib/document.js","../node_modules/postcss/lib/warn-once.js","../node_modules/postcss/lib/warning.js","../node_modules/postcss/lib/result.js","../node_modules/postcss/lib/tokenize.js","../node_modules/postcss/lib/at-rule.js","../node_modules/postcss/lib/root.js","../node_modules/postcss/lib/list.js","../node_modules/postcss/lib/rule.js","../node_modules/postcss/lib/parser.js","../node_modules/postcss/lib/parse.js","../node_modules/postcss/lib/lazy-result.js","../node_modules/postcss/lib/no-work-result.js","../node_modules/postcss/lib/processor.js","../node_modules/postcss/lib/fromJSON.js","../node_modules/postcss/lib/postcss.js","../node_modules/postcss/lib/postcss.mjs","../src/lib/_templates.js","../src/lib/_world.js","../src/lib/_npc.js","../src/lib/_parser.js","../src/lib/_commands.js"],"sourcesContent":["\"use strict\";\n\n// ============  Utilities  =================================\n\n// Should all be language neutral\n\nimport {\n    world,\n    lang,\n    settings,\n    w,\n    errormsg,\n    player,\n    setPlayer,\n    parser,\n    io,\n    saveLoad,\n    commentmsg,\n    msg, falsemsg, game\n} from \"../index.js\";\n\nexport const INDEFINITE = 1\nexport const DEFINITE = 2\nexport const COUNT = 3\n\nexport const NULL_FUNC = function() {}\n\n\nexport const test = {};\ntest.testing = false;\n\n//@DOC\n// ## General Utility Functions\n//@UNDOC\n\n\n\n// If we try to do anything fancy with log we get this line number not the calling line\nexport const log = console.log\nexport const debuglog = (s) => { if(settings.playMode === 'dev' || settings.playMode === 'beta'){ log(s)} }\nexport const parserlog = (s) => { if(parser.debug){ log(s)} }\n\n\n//@DOC\n// Runs the given string as though the player typed it, including recording it in the output\nexport function runCmd(cmd) {\n  io.msgInputText(cmd)\n  parser.parse(cmd)\n}\n\n\nexport function doOnce(o, s) {\n  if (s === undefined) s = 'unspecifiedDoOnceFlag'\n  if (o[s]) return false\n  o[s] = true\n  return true\n}\n\n\n\n\n\nexport function c(str) {\n  if (saveLoad.transcript) {\n    commentmsg(\"Comment: \" + str)\n    return 'Comment added to transcript'\n  }\n  else {\n   return 'This function is designed for adding comments whilst recording a transcript. You have are not currently recording a transcript.'\n  }\n}\n\n\n\n//@DOC\n// If the given attribute is a string it is printed, if it is a\n// function it is called. Otherwise an error is generated.\n// If options.multiple is true, the object name is prefixed.\nexport function printOrRun(char, item, attname, options) {\n  if (options === undefined) options = {}\n  if (!options.char) options.char = char\n  if (!options.item) options.item = item\n\n  if (typeof item[attname] === \"string\") {\n    // The attribute is a string\n    let s = item[attname]\n    if (item[attname + 'Addendum']) s += item[attname + 'Addendum'](char)\n    msg(s, options);\n    return true;\n  }\n  else if (typeof item[attname] === \"function\"){\n    // The attribute is a function\n      return item[attname](options);\n  }\n  else {\n    const s = \"Unsupported type for printOrRun (\" + attname + \" is a \" + (typeof item[attname]) + \").\"\n    errormsg(s)\n    throw new Error(s)\n  }\n}\n\n\n\nexport function verbify(s) { return s.toLowerCase().replace(/[^a-zA-Z0-9_]/g, '') }\n\n\n\n// ============  Random Utilities  =======================================\n//@DOC\n// ## Random Functions\n//@UNDOC\n\nexport const random = {\n  buffer:[],\n}\n\n//@DOC\n// Returns a random number from 0 to n1, or n1 to n2, inclusive.\nrandom.int = function(n1, n2) {\n  if (this.buffer.length > 0) return this.buffer.shift()\n  if (n2 === undefined) {\n    n2 = n1;\n    n1 = 0;\n  }\n  return Math.floor(Math.random() * (n2 - n1 + 1)) + n1;\n}\n\n\n\n//@DOC\n// Returns true 'percentile' times out of 100, false otherwise.\nrandom.chance = function(percentile) {\n  return random.int(99) < percentile;\n}\n\n\n\n//@DOC\n// Returns a random element from the array, or null if it is empty\n// If the second parameter is true, then the selected value is also deleted from the array,\n// preventing it from being selected a second time.\n// If sent a string instead of an array, the string will be broken into an array on |.\nrandom.fromArray = function(arr, deleteEntry) {\n  if (typeof arr === 'string') arr.split('|')\n  if (arr.length === 0) return null;\n  const index = random.int(arr.length - 1);\n  const res = arr[index];\n  if (deleteEntry) arr.splice(index, 1)\n  return res;\n}\n\n\n\n//@DOC\n// Returns the given array, in random order using the Fisher-Yates algorithm\nrandom.shuffle = function(arr) {\n  if (typeof arr === \"number\") arr = [...Array(arr).keys()]\n  const res = []\n  while (arr.length > 0) {\n    res.push(random.fromArray(arr, true))\n  }\n  return res;\n}\n\n\n\n//@DOC\n// Returns a random number based on the standard RPG dice notation.\n// For example 2d6+3 means roll two six sided dice and add three.\n// Returns he number if sent a number.\n// It can cope with complex strings such as 2d8-3d6\n// You can also specify unusual dice, i.e., not a sequence from one to n, by separating each value with a colon,\n// so d1:5:6 rolls a three sided die, with 1, 5 and 6 on the sides.\n// It will cope with any number of parts, so -19+2d1:5:6-d4 will be fine.\n// If average is true, calculates the mean expected roll\nrandom.dice = function(s, average) {\n  if (typeof s === 'number') return s\n  s = s.replace(/ /g, '').replace(/\\-/g, '+-')\n  let total = 0\n  random.diceLog = []\n\n  for (let dice of s.split(\"+\")) {\n    if (dice === '') continue\n    let negative = 1\n    if (/^\\-/.test(dice)) {\n      dice = dice.substring(1)\n      negative = -1\n    }\n    total += negative * random.diceSubPart(dice, average)\n  }\n  return total\n}\n\n\n\n// If average is true, calculates the mean expected roll\nrandom.diceSubPart = function(dice, average) {\n  // just a number\n  if (/^\\d+$/.test(dice)) return parseInt(dice)\n\n  // normalise\n  if (/^d/.test(dice)) dice = \"1\" + dice\n\n  // collect data\n  const match = /^(\\d+)[dD]([0-9\\:]+)([hHlLeErRcC])?(\\d+)?/.exec(dice)\n  if (!match) return errormsg (\"Can't parse dice type: \" + dice)\n  let rolls = []\n  const number = parseInt(match[1])\n  const sides = match[2]\n\n  // roll the dice\n  for (let i = 0; i < number; i++) {\n    const n = random.diceRoll(sides, average)\n    rolls.push(n)\n  }\n\n  // handle highest/lowest/exploding\n  if (match[3] === 'h' || match[3] === 'H') {\n    const highestOf = match[4] ? parseInt(match[4]) : 1\n    rolls = rolls.sort(function(a, b) {\n      return b - a\n    }).slice(0, highestOf)\n  }\n  if (match[3] === 'l' || match[3] === 'L') {\n    const highestOf = match[4] ? parseInt(match[4]) : 1\n    rolls = rolls.sort(function(a, b) {\n      return a - b\n    }).slice(0, highestOf)\n  }\n  if (match[3] === 'e' || match[3] === 'E') {\n    const explodeOn = match[4] ? parseInt(match[4]) : parseInt(sides)\n    if (explodeOn < 2) return errormsg (\"Bad exploding dice will crash the game: \" + dice)\n    let exploderCount = rolls.filter(el => el >= explodeOn).length\n    for (let i = 0; i < exploderCount; i++) {\n      const n = random.diceRoll(sides, average)\n      rolls.push(n)\n      if (match[3] === 'E' && n >= explodeOn) exploderCount++\n    }\n  }\n  if (match[3] === 'r') {\n    const rerollOn = match[4] ? parseInt(match[4]) : 1\n    for (let i = 0; i < rolls.length; i++) {\n      if (rolls[i] <= rerollOn) rolls[i] = random.diceRoll(sides, average)\n    }\n  }\n  if (match[3] === 'R') {\n    const rerollOn = match[4] ? parseInt(match[4]) : 1\n    for (let i = 0; i < rolls.length; i++) {\n      while (rolls[i] <= rerollOn) rolls[i] = random.diceRoll(sides, average)\n    }\n  }\n  if (match[3] === 'C') {\n    const countIf = parseInt(match[4])\n    for (let i = 0; i < rolls.length; i++) {\n      rolls[i] = (rolls[i] >= countIf) ? 1 : 0\n    }\n  }\n  if (match[3] === 'c') {\n    const countIf = parseInt(match[4])\n    for (let i = 0; i < rolls.length; i++) {\n      rolls[i] = (rolls[i] <= countIf) ? 1 : 0\n    }\n  }\n\n  // Add them up\n  let total = 0\n  for (const n of rolls) total += n\n  return total\n}\n\n\n// Expects a string that is either:\n// a number, the number of sides for the dice, so returns a random number from 1 to that number\n// or a set of numbers separated by colon, so returns one picked at random\n// If average is true, calculates the mean expected roll\nrandom.diceRoll = function(s, average) {\n  if (average) {\n    if (/^\\d+$/.test(s)) return parseInt(s) / 2 + 0.5\n    let total = 0\n    const ary = s.split(':')\n    for (const s2 of ary) {\n      log(total)\n      total += parseInt(s2)\n    }\n      log(total)\n    return total / ary.length\n  }\n\n  const n = (/^\\d+$/.test(s)) ? random.int(1, parseInt(s)) : parseInt(random.fromArray(s.split(':')))\n  random.diceLog.push(n)\n  return n\n}\n\n\n\n\n//@DOC\n// Loads up a buffer with the given number or array of numbers.\n// The random.int function will grab the first number from the buffer and return that instead of a random\n// number, if there is anything in the buffer. Note that the other random functions all use random.int,\n// so you can use random.prime to force any of them to return a certain value. Note that there is no\n// checking, so random.int(4) could return 7 or even \"seven\". It is up to you to ensure the numbers you\n// prime the buffer with make sense.\n// This is most useful when testing, as you know in advance what the random number will be.\nrandom.prime = function(ary) {\n  if (typeof ary === 'number') ary = [ary]\n  this.buffer = ary\n}\n\n// ============  String Utilities  =======================================\n//@DOC\n// ## String Functions\n//@UNDOC\n\n//@DOC\n// Returns the string with the first letter capitalised\nexport function sentenceCase(str) {\n  if (str.length === 0) return ''\n  return str.replace(str[0], str[0].toUpperCase())\n}\n\n//@DOC\n// Returns the string with the first letter of each word capitalised\nexport function titleCase(str) {\n  return str.toLowerCase().split(' ').map(el => el.replace(el[0], el[0].toUpperCase())).join(' ')\n}\n\n//@DOC\n// Returns the string with the first letter capitalised,\n// but will ignore any HTML tags embedded in the string.\n// If the string may have HTML codes to do special formating, etc.,\n// this is probably the version you need.\nexport function sentenceCaseForHTML(str) {\n  const template = document.createElement('template')\n  template.innerHTML = str.trim()\n  let node = template.content\n  while (node.hasChildNodes()) node = node.firstChild\n  node.textContent = sentenceCase(node.textContent)\n  return template.innerHTML\n}\n\n//@DOC\n// Returns the string in a span element that will cause each\n// word to _appear_ to be capitalised, without\n// actually changing the text.\nexport function titleCaseForHTML(str) {\n  return '<span style=\"text-transform: capitalize;\">' + str + '</span>'\n}\n\n//@DOC\n// Returns a string with the given number of hard spaces. Browsers collapse multiple white spaces to just show\n// one, so you need to use hard spaces (NBSPs) if you want several together.\nexport function spaces(n) {\n  return \"&nbsp;\".repeat(n)\n}\n\n//@DOC\n// If multiple is true, returns the item name, otherwise nothing. This is useful in commands that handle\n// multiple objects, as you can have this at the start of the response string. For example, if the player does GET BALL,\n// the response might be \"Done\". If she does GET ALL, then the response for the ball needs to be \"Ball: Done\".\n// In the command, you can have `msg(\"Done\"), and it is sorted.\nexport function prefix(item, options) {\n  if (!options.multiple) { return \"\"; }\n  return sentenceCase(item.alias) + \": \";\n}\n\nexport function warningFor(o, msg) { log('Warning for ' + o.name + ': ' + msg) }\n\n//@DOC\n// Creates a string from an array. If the array element is a string, that is used, if it is an item, `lang.getName` is used (and passed the `options`). Items are sorted alphabetically, based on the \"name\" attribute.\n//\n// Options:\n//\n// * article:    DEFINITE (for \"the\") or INDEFINITE (for \"a\"), defaults to none (see `lang.getName`)\n// * sep:        separator (defaults to comma)\n// * lastSep: separator for last two items (just separator if not provided); you should not include any spaces\n// * modified:   item aliases modified (see `lang.getName`) (defaults to false)\n// * nothing:    return this if the list is empty (defaults to empty string)\n// * count:      if this is a number, the name will be prefixed by that (instead of the article)\n// * doNotSort   if true the list is not sorted\n// * separateEnsembles:  if true, ensembles are listed as the separate items\n//\n// For example:\n//\n// ```\n// formatList(listOfOjects, {article:INDEFINITE, lastSep:\"and\"})\n// -> \"a hat, Mary and some boots\"\n//\n// formatList(list, {lastSep:\"or\", nothing:\"nowhere\");\n// -> north, east or up\n// ```\n//\nexport function formatList(itemArray, options) {\n  if (options === undefined) { options = {}; }\n  // For backwards compatibility, suggest it can be removed summer 2024 (after two years)\n  if (options.lastJoiner && !options.lastSep) options.lastSep = options.lastJoiner\n\n  if (itemArray.length === 0) {\n    return options.nothing ? options.nothing : \"\";\n  }\n\n  if (!options.sep) options.sep = \",\"\n\n\n  if (!options.separateEnsembles) {\n    const toRemove = [];\n    const toAdd = [];\n    for (let item of itemArray) {\n      if (item.ensembleMaster && item.ensembleMaster.isAllTogether()) {\n        toRemove.push(item);\n        if (!toAdd.includes(item.ensembleMaster)) toAdd.push(item.ensembleMaster);\n      }\n    }\n    itemArray = array.subtract(itemArray, toRemove);\n    itemArray = itemArray.concat(toAdd);\n  }\n\n  // sort the list alphabetically on name\n  if (!options.doNotSort) {\n    itemArray.sort(function(a, b){\n      if (a.name) a = a.name;\n      if (b.name) b = b.name;\n      return a.localeCompare(b)\n    });\n  }\n\n  const l = itemArray.map(el => {\n    //if (el === undefined) return \"[undefined]\";\n    return typeof el === \"string\" ? el : lang.getName(el, options)\n  })\n\n\n  let s = \"\";\n  if (settings.oxfordComma && l.length === 2 && options.lastSep) return l[0] + ' ' + options.lastSep + ' ' + l[1]\n  do {\n    s += l.shift()\n    if (l.length === 1 && options.lastSep) {\n      if (settings.oxfordComma) s += options.sep\n      s += ' ' + options.lastSep + ' '\n    } else if (l.length > 0) s += options.sep + ' '\n  } while (l.length > 0);\n\n  return s;\n}\n\n//@DOC\n// Lists the properties of the given object; useful for debugging only.\n// To inspect an object use JSON.stringify(obj)\nexport function listProperties(obj) {\n  return Object.keys(obj).join(\", \");\n}\n\nconst arabic = [1000,900,500,400,100,90,50,40,10,9,5,4,1];\nconst roman = \"M;CM;D;CD;C;XC;L;XL;X;IX;V;IV;I\".split(\";\");\n\n//@DOC\n// Returns the given number as a string in Roman numerals.\nexport function toRoman(number) {\n  if (typeof number !== \"number\") {\n    errormsg (\"toRoman can only handle numbers\");\n    return number;\n  }\n\n  let result = \"\";\n  //var a, r;\n  for (let i = 0; i < 13; i++) {\n    while (number >= arabic[i]) {\n      result = result + roman[i];\n      number = number - arabic[i];\n    }\n  }\n  return result;\n}\n\n//@DOC\n// Returns the given number as a string formatted as money. The formatting is defined by settings.moneyFormat.\nexport function displayMoney(n) {\n  if (typeof settings.moneyFormat === \"undefined\") {\n    errormsg (\"No format for money set (set settings.moneyFormat in settings.js).\");\n    return \"\" + n;\n  }\n  const ary = settings.moneyFormat.split(\"!\");\n  if (ary.length === 2) {\n    return settings.moneyFormat.replace(\"!\", \"\" + n);\n  }\n  else if (ary.length === 3) {\n    const negative = (n < 0)\n    n = Math.abs(n);\n    let options = ary[1]\n    const showsign = options.startsWith(\"+\")\n    if (showsign) {\n      options = options.substring(1);\n    }\n    let number = displayNumber(n, options)\n    if (negative) {\n      number = \"-\" + number;\n    }\n    else if (n !== 0 && showsign) {\n      number = \"+\" + number;\n    }\n    return (ary[0] + number + ary[2]);\n  }\n  else if (ary.length === 4) {\n    const options = n < 0 ? ary[2] : ary[1];\n    return ary[0] + displayNumber(n, options) + ary[3];\n  }\n  else {\n    errormsg (\"settings.moneyFormat in settings.js expected to have either 1, 2 or 3 exclamation marks.\")\n    return \"\" + n;\n  }\n}\n\n//@DOC\n// Returns the given number as a string formatted as per the control string.\n// The control string is made up of five parts.\n// The first is a sequence of characters that are not digits that will be added to the start of the string, and is optional.\n// The second is a sequence of digits and it the number of characters left of the decimal point; this is padded with zeros to make it longer.\n// The third is a single non-digit character; the decimal marker.\n// The fourth is a sequence of digits and it the number of characters right of the decimal point; this is padded with zeros to make it longer.\n// The fifth is a sequence of characters that are not digits that will be added to the end of the string, and is optional.\nexport function displayNumber(n, control) {\n  n = Math.abs(n);  // must be positive\n  const regex = /^(\\D*)(\\d+)(\\D)(\\d*)(\\D*)$/;\n  if (!regex.test(control)) {\n    errormsg (\"Unexpected format in displayNumber (\" + control + \"). Should be a number, followed by a single character separator, followed by a number.\");\n    return \"\" + n;\n  }\n  const options = regex.exec(control);\n  const places = parseInt(options[4]);                      // eg 2\n  let padding = parseInt(options[2]);             // eg 3\n  if (places > 0) {\n    // We want a decimal point, so the padding, the total length, needs that plus the places\n    padding = padding + 1 + places;               // eg 6\n  }\n  const factor = Math.pow (10, places)            // eg 100\n  const base = (n / factor).toFixed(places);      // eg \"12.34\"\n  const decimal = base.replace(\".\", options[3])   // eg \"12,34\"\n  return (options[1] + decimal.padStart(padding, \"0\") + options[5])   // eg \"(012,34)\"\n}\n\n//@DOC\n// Converts the string to the standard direction name, so \"down\", \"dn\" and \"d\" will all return \"down\".\n// Uses the EXITS array, so language neutral.\nexport function getDir(s) {\n  for (let exit of lang.exit_list) {\n    if (exit.type === 'nocmd') continue;\n    if (exit.name === s) return exit.name;\n    if (exit.abbrev.toLowerCase() === s) return exit.name;\n    if (new RegExp(\"^(\" + exit.alt + \")$\").test(s)) return exit.name;\n  }\n  return false;\n}\n\nexport function rChunkString(str, len) {\n  str = str.toString()\n  const r = []\n\n  while (str) {\n    const chunk = str.slice(-len)\n    str = str.slice(0, -len)\n    r.unshift(chunk)\n  }\n  return r\n}\n\n// ============  Array Utilities  =======================================\n//@DOC\n// ## Array (List) Functions\n//@UNDOC\n\nexport const array = {}\n\n//@DOC\n// Returns a new array, derived by subtracting each element in b from the array a.\n// If b is not an array, then b itself will be removed.\n// Unit tested.\narray.subtract = function(a, b) {\n  if (!Array.isArray(b)) b = [b]\n  const res = []\n  for (let i = 0; i < a.length; i++) {\n    if (!b.includes(a[i])) res.push(a[i]);\n  }\n  return res;\n}\n\n//@DOC\n// Returns true if the arrays a and b are equal. They are equal if both are arrays, they have the same length,\n// and each element in order is the same.\n// Assumes a is an array, but not b.\n// Unit tested\narray.compare = function(a, b) {\n  if (!Array.isArray(b)) return false;\n  if (a.length !== b.length) return false;\n  for (let i = 0; i < a.length; i++) {\n    if (b[i] !== a[i]) return false;\n  }\n  return true;\n}\n\n//@DOC\n// Returns true if each element in a matches the elements in b, but not necessarily in the same order\n// (assumes each element is unique; repeated elements may give spurious results).\n// Assumes a is an array, but not b.\n// Unit tested\narray.compareUnordered = function(a, b) {\n  if (!Array.isArray(b)) return false;\n  if (a.length !== b.length) return false;\n  for (let el of a) {\n    if (!b.includes(el)) return false;\n  }\n  return true;\n}\n\n//@DOC\n// Removes the element el from the array, ary.\n// Unlike array.subtract, no new array is created; the original array is modified, and nothing is returned.\narray.remove = function(ary, ...el) {\n  if (el.length === 0) return\n  let index = ary.indexOf(el.shift())\n  if (index !== -1) {\n    ary.splice(index, 1)\n  }\n  array.remove(ary, ...el)\n}\n\n//@DOC\n// Returns a new array containing all the elements that are in both the given arrays.\n// Assumes no duplicates in the arrays\narray.intersection = function(ary1, ary2) {\n  return ary1.filter(function(x) {\n    // checking second array contains the element \"x\"\n    return ary2.indexOf(x) !== -1;\n  })\n}\n\n//@DOC\n// Returns a new array based on ary, but including only those objects for which the attribute attName is equal to value.\n// To filter for objects that do not have the attribute you can filter for the value undefined.\narray.filterByAttribute = function(ary, attName, value) {\n  return ary.filter(el => el[attName] === value)\n}\n\n//@DOC\n// Returns the next element after el from the array, ary.\n// If el is present more than once, it goes with the first.\n// If el is the last element, and circular is true it return the fist element and false otherwise.\narray.next = function(ary, el, circular) {\n  let index = ary.indexOf(el) + 1\n  if (index === 0) return false\n  if (index === ary.length) return circular ? ary[0] : false\n  return ary[index]\n}\n\n//@DOC\n// Returns the next element after el from the array, ary, for which the attribute, att, is true.\n// If el is present more than once, it goes with the first.\n// If el is the last element, and circular is true it return the fist element and false otherwise.\narray.nextFlagged = function(ary, el, att, circular) {\n  let o = el\n  let count = ary.length\n  while (o && !o[att] && count > 0) {\n    o = array.next(ary, o, circular)\n    count = count - 1\n  }\n  if (!o || !o[att]) return false\n  return (o)\n}\n\n//@DOC\n// Returns a copy of the given array. Members of the array are not cloned.\narray.clone = function(ary, options) {\n  if (!options) options = {}\n  let newary = options.compress ? [...new Set(ary)] : [...ary]\n  if (options.value) newary = newary.map(el => el[options.value])\n  if (options.function) newary = newary.map(el => el[options.function]())\n  if (options.attribute) newary = newary.map(el => typeof el[options.attribute] === 'function' ? el[options.attribute]() : el[options.attribute])\n  return options.reverse ? newary.reverse() : newary\n}\n\n//@DOC\n// Returns true if any member of the array matches the string.\n// It is a match if the element is also a string and they are the same or\n// if the elem,ent is a regex and the pattern matches\narray.hasMatch = function(ary, s) {\n  for (let e of ary) {\n    if (typeof e === 'string' && e === s) return true\n    if (e instanceof RegExp && s.match(e)) return true\n  }\n  return false\n}\n\n//@DOC\n// Returns an array of combinations based on the given array\n// Combinations have between one and three elements from the original array\n// and will be in the original order.\n// Each combination is a string with the elements separated with a space.\n// Used by the parser (in case it seems obscure and pointless!)\narray.combos = function(ary, sep=' ') {\n  const res = []\n  for (let i = 0; i < ary.length; i++) {\n    res.push(ary[i])\n    for (let j = i + 1; j < ary.length; j++) {\n      res.push(ary[i] + sep + ary[j])\n      for (let k = j + 1; k < ary.length; k++) {\n        res.push(ary[i] + sep + ary[j] + sep + ary[k])\n      }\n    }\n  }\n  return res\n}\n\narray.fromTokens = function(ary, scope, cmdParams) {\n  const items = []\n  while (ary.length > 0) {\n    const res = array.oneFromTokens(ary, scope, cmdParams)\n    if (!res) return null\n    items.push(res)\n  }\n  return items\n}\n\narray.oneFromTokens = function(ary, scope, cmdParams = {}) {\n  for (let i = ary.length; i > 0; i--) {\n    const s = ary.slice(0, i).join(' ')\n    const items = parser.findInList(s, scope, cmdParams)\n    if (items.length > 0) {\n      for (let j = 0; j < i; j++) ary.shift()\n      return items\n    }\n  }\n  return null\n}\n\narray.value = function(ary, index, opt) {\n  if (index >= ary.length || index < 0) {\n    if (opt === 'none') return ''\n    if (opt === 'wrap') return ary[index % ary.length]\n    if (opt === 'end') return ary[ary.length - 1]\n    if (opt === 'start') return ary[0]\n  }\n  return ary[index]\n}\n\n// ============  Scope Utilities  =======================================\n\n\n//@DOC\n// ## Scope Functions\n//@UNDOC\n\n\n\n//@DOC\n// Returns an array of objects the player can currently reach and see.\nexport function scopeReachable() {\n  const list = [];\n  for (let key in w) {\n    if (w[key].scopeStatus.canReach && world.ifNotDark(w[key])) {\n      list.push(w[key]);\n    }\n  }\n  return list;\n}\n\n//@DOC\n// Returns an array of objects held by the given character.\nexport function scopeHeldBy(chr = player(), situation = world.PARSER) {\n  return chr.getContents(situation)\n}\n\n//@DOC\n// Returns an array of objects at the player's location that can be seen.\nexport function scopeHereListed() {\n  const list = [];\n  for (let key in w) {\n    const o = w[key]\n    if (!o.player && o.isAtLoc(player().loc, world.LOOK) && world.ifNotDark(o)) {\n      list.push(o);\n    }\n  }\n  return list;\n}\n\n//@DOC\n// Returns an array of objects at the player's location that can be seen.\nexport function scopeHereParser() {\n  const list = [];\n  for (let key in w) {\n    const o = w[key]\n    if (!o.player && o.isAtLoc(player().loc, world.PARSER)) {\n      list.push(o);\n    }\n  }\n  return list;\n}\n\n//@DOC\n// Returns an array of NPCs at the player's location (excludes those flagged as scenery).\nexport function scopeNpcHere(ignoreDark) {\n  const list = [];\n  for (let key in w) {\n    const o = w[key]\n    if (o.isAtLoc(player().loc, world.LOOK) && o.npc && (world.ifNotDark(o) || ignoreDark)) {\n      list.push(o);\n    }\n  }\n  return list;\n}\n\n//@DOC\n// Returns an array of NPCs at the player's location (includes those flagged as scenery).\nexport function scopeAllNpcHere(ignoreDark) {\n  const list = [];\n  for (let key in w) {\n    const o = w[key]\n    if (o.isAtLoc(player().loc, world.PARSER) && o.npc && (world.ifNotDark(o) || ignoreDark)) {\n      list.push(o);\n    }\n  }\n  return list;\n}\n\n//@DOC\n// Returns an array of objects for which the given export function returns true.\nexport function scopeBy(func) {\n  const list = [];\n  for (let key in w) {\n    if (func(w[key])) {\n      list.push(w[key]);\n    }\n  }\n  return list;\n}\n\nexport const util = {};\n\nutil.getContents = function(situation) {\n  const list = [];\n  for (let key in w) {\n    if (w[key].isAtLoc(this.name, situation)) {\n      list.push(w[key]);\n    }\n  }\n  return list;\n}\n\n// Is this container already inside the given object, and hence\n// putting the object in the container will destroy the universe\nutil.testForRecursion = function(char, item) {\n  let contName = this.name;\n  while (w[contName]) {\n    if (w[contName].loc === item.name) return falsemsg(lang.container_recursion, {char:char, container:this, item:item})\n    contName = w[contName].loc\n  }\n  return true;\n}\n\nutil.nameModifierFunctionForContainer = function(o, list) {\n  //console.log(\"here\")\n  const contents = o.getContents(world.LOOK);\n  //console.log(contents)\n  if (contents.length > 0 && (!o.closed || o.transparent)) {\n    list.push(lang.contentsForData[o.contentsType].prefix + o.listContents(world.LOOK) + lang.contentsForData[o.contentsType].suffix)\n  }\n  //console.log(list)\n}\n\n//@DOC\n// Returns the given number, num, but restricted to lie\n// between min and max; i.e., if number is less than min,\n// then min will be returned instead.\nutil.clamp = function(num, min, max) {\n  return num <= min ? min : (num >= max  ? max : num)\n}\n\nutil.registerTimerFunction = function(eventName, func) {\n  if (world.isCreated && !settings.saveDisabled) {\n    errormsg(\"Attempting to use registerEvent after set up.\")\n    return\n  }\n  settings.eventFunctions[eventName] = func;\n}\nutil.registerTimerEvent = function(eventName, triggerTime, interval) {\n  if (!settings.eventFunctions[eventName]) errormsg(\"A timer is trying to call event '\" + eventName + \"' but no such function is registered.\")\n  game.timerEventNames.push(eventName)\n  game.timerEventTriggerTimes.push(triggerTime)\n  game.timerEventIntervals.push(interval ? interval : -1)\n}\n\nutil.findTopic = function(alias, char, n = 1) {\n  if (w[alias]) return w[alias]\n  for (const key in w) {\n    const o = w[key]\n    if (o.conversationTopic && (!char || o.belongsTo(char.name)) && o.alias === alias) {\n      n--\n      if (n === 0) return o\n    }\n  }\n  if (char) {\n    errormsg(\"Trying to find topic \" + n + \" called \\\"\" + alias + \"\\\" for \" + char.name + \" and came up empty-handed!\")\n  }\n  else {\n    errormsg(\"Trying to find topic \" + n + \" called \\\"\" + alias + \"\\\" for anyone and came up empty-handed!\")\n  }\n}\n\n// Useful in a receiveItems array, as it just sorts out giving for you, based on the standard parameters\nutil.giveItem = function(p) {\n  p.item.moveToFrom(p, p.npc, p.char)\n}\n\nutil.changeListeners = []\n\n// This is used in world.endTurn, before turn events are run, and after too (just once if no turn events). Also after timer events if one fired\nutil.handleChangeListeners = function() {\n  for (let el of util.changeListeners) {\n    if (el.test(el.object, el.object[el.attName], el.oldValue, el.attName)) {\n      el.func(el.object, el.object[el.attName], el.oldValue, el.attName)\n    }\n    el.oldValue = el.object[el.attName]\n  }\n}\n\nutil.defaultChangeListenerTest = function(object, currentValue, oldValue, attName) {\n  return currentValue !== oldValue\n}\n\nutil.addChangeListener = function(object, attName, func, test = util.defaultChangeListenerTest) {\n  if (world.isCreated && !settings.saveDisabled) {\n    errormsg(\"Attempting to use addChangeListener after set up.\")\n    return\n  }\n  util.changeListeners.push({object:object, attName:attName, func:func, test:test, oldValue:object[attName]})\n}\n\nutil.getChangeListenersSaveString = function() {\n  if (util.changeListeners.length === 0) return \"NoChangeListeners\"\n  const strings = util.changeListeners.map(el => el.oldValue.toString())\n    return \"ChangeListenersUsedStrings=\" + saveLoad.encodeArray(strings);\n}\n\nutil.setChangeListenersLoadString = function(s) {\n  if (s === \"NoChangeListeners\") return\n  const parts = s.split(\"=\");\n  if (parts.length !== 2) return errormsg(\"Bad format in saved data (\" + s + \")\")\n  if (parts[0] !== \"ChangeListenersUsedStrings\") return errormsg(\"Expected ChangeListenersUsedStrings to be first\")\n  const strings = saveLoad.decodeArray(parts[1])\n  for (let i = 0; i < strings.length; i++) {\n    util.changeListeners[i].oldValue = strings[i].match(/^\\d+$/) ? parseInt(strings[i]) : strings[i]\n  }\n}\n\n\n// ============  Response Utilities  =======================================\n\n\n//@DOC\n// ## The Respond Function\n//@UNDOC\n\n//@DOC\n// Searches the given list for a suitable response, according to the given params, and runs that response.\n// This is a big topic, see [here](https://github.com/ThePix/QuestJS/wiki/The-respond-function) for more.\nexport function respond(params, list) {\n  if (settings.responseDebug) log(params)\n  if (!params.char) errormsg(\"A call to \\\"respond\\\" does not have \\\"char\\\" set in the params.\")\n  const response = util.findResponse(params, list, params.extraTest)\n  if (!response) {\n    if (params.afterScript) params.afterScript(params)\n    if (!params.noResponseNotError) {\n      errormsg(\"Failed to find a response. ASK/TELL or some other system using the respond function was given a list of options that did not have a default. Below the stack trace, you should see the parameters sent and the list of responses. The last response should have no test function (or a test function that always returns true).\")\n      log(params)\n      log(list)\n    }\n    return false\n  }\n  if (params.beforeScript) params.beforeScript.bind(params.char)(params, response)\n  if (response.script) response.script.bind(params.char)(params, response)\n  if (response.msg) {\n    if (params.char) {\n      params.char.msg(response.msg, params)\n    }\n    else {\n      msg(response.msg, params)\n    }\n  }\n  if (!response.script && !response.msg && !response.failed) {\n    errormsg(\"No script or msg for response\")\n    console.log(response)\n  }\n  if (params.afterScript) params.afterScript.bind(params.char)(params, response)\n  return !response.failed\n}\n\nexport function getResponseList(params, list, result) {\n  if (!result) result = []\n  for (let item of list) {\n    if (item.name) {\n      params.text = item.name.toLowerCase()\n      //console.log(\"check item: \" + item.name)\n      if (item.test) {\n        if (!result.includes(item) && item.test.bind(params.char)(params, item)) result.push(item)\n      }\n      else {\n        if (!result.includes(item)) result.push(item)\n      }\n      //console.log(\"item is good: \" + item.name)\n    }\n    if (item.responses) result = getResponseList(params, item.responses, result)\n    //console.log(\"done\")\n  }\n  return result\n}\n\nutil.findResponse = function(params, list, extraTest) {\n  for (let item of list) {\n    if (extraTest && !extraTest.bind(params.char)(params, item)) continue\n    if (item.test && !item.test.bind(params.char)(params, item)) continue\n    if (item.regex && !params.text.match(item.regex)) continue\n    if (item.responses) return util.findResponse(params, item.responses)\n    return item\n  }\n  return false\n}\n\nutil.addResponse = function(route, data, list) {\n  util.addResponseToList(route, data, list)\n}\n\nutil.addResponseToList = function(route, data, list) {\n  const sublist = util.getResponseSubList(route, list)\n  sublist.unshift(data)\n}\n\nutil.getResponseSubList = function(route, list) {\n  const s = route.shift()\n  if (s) {\n    const sublist = list.find(el => el.name === s)\n    if (!sublist) throw \"Failed to add sub-list with \" + s\n    return util.getResponseSubList(route, sublist.responses)\n  }\n  else {\n    return list\n  }\n}\n\nutil.verifyResponses = function(list, level) {\n  //  console.log(list)\n  if (level === undefined) level = 1\n  if (list[list.length - 1].test) {\n    console.log(\"WARNING: Last entry at depth \" + level + \" has a test condition:\")\n    console.log(list)\n  }\n  for (let item of list) {\n    if (item.responses) {\n      //console.log(item.name)\n      if (item.responses.length === 0) {\n        console.log(\"Zero responses at depth \" + level + \" for: \" + item.name)\n      }\n      else {\n        util.verifyResponses(item.responses, level + 1)\n      }\n    }\n  }\n}\n\n// This should be assigned to an object, and then used from there\nutil.listContents = function(situation, modified = true) {\n  return formatList(this.getContents(situation), {article:INDEFINITE, lastSep:lang.list_and, modified:modified, nothing:lang.list_nothing, loc:this.name})\n}\n\n//@DOC\n// Returns the number of the internal the given number falls in\n// For example, if intervals\n// Unit tested.\nutil.getByInterval = function(intervals, n) {\n  let count = 0\n  while (count < intervals.length) {\n    if (n < intervals[count]) return count\n    n -= intervals[count]\n    count++\n  }\n  return false\n}\n\nutil.guessMyType = function(value) {\n  if (value.match(/^\\d+$/)) value = parseInt(value)\n  if (value === 'true') value = true\n  if (value === 'false') value = false\n  if (value === 'undefined') value = undefined\n  return value\n}\n\n//@DOC\n// Returns a string formatted in CSS from the given dictionary.\n// If includeCurlyBraces is true, you get curly braces too.\nutil.dictionaryToCss = function(d, includeCurlyBraces) {\n  const ary = []\n  for (let key in d) ary.push(key + ':' + d[key])\n  return includeCurlyBraces ? '{' + ary.join(';') + '}' : ary.join(';')\n}\n\nutil.getNameModifiers = function(item, options) {\n  if (!options.modified) return ''\n  const list = []\n  for (let f of item.nameModifierFunctions) f(item, list, options)\n  if (item.nameModifierFunction) item.nameModifierFunction(list, options)\n  if (list.length === 0) return ''\n  if (options.noBrackets) return ' ' + list.join('; ')\n  return ' (' + list.join('; ') + ')'\n}\n\n//@DOC\n// Returns the game time as a string. The game time is game.elapsedTime seconds after game.startTime.\nutil.getDateTime = function(options) {\n  if (!settings.dateTime.formats) {\n    const time = new Date(game.elapsedTime * 1000 + game.startTime.getTime())\n    return time.toLocaleString(settings.dateTime.locale, settings.dateTime)\n  }\n\n  return util.getCustomDateTime(options)\n}\n\nutil.getDateTimeDict = function(options) {\n  if (!options) options = {}\n  return settings.dateTime.formats ? util.getCustomDateTimeDict(options) : util.getStdDateTimeDict(options)\n}\n\nutil.getStdDateTimeDict = function(options) {\n  const dict = {}\n  let timeInSeconds = game.elapsedTime\n  if (options.add) timeInSeconds += options.add\n  const time = new Date(timeInSeconds * 1000 + game.startTime.getTime())\n  dict.second = time.getSeconds()\n  dict.minute = time.getMinutes()\n  dict.hour = time.getHours()\n  dict.date = time.getDate()\n  dict.weekday = time.toLocaleString('default', { weekday: 'long' })\n  dict.month = time.toLocaleString('default', { month: 'long' })\n  dict.year = time.getFullYear()\n\n  return dict\n}\n\nutil.getCustomDateTimeDict = function(options) {\n  const dict = {}\n  let time = settings.dateTime.startTime + game.elapsedTime\n  if (options.is) time = settings.dateTime.startTime + options.is\n  if (options.add) time += options.add\n  for (let el of settings.dateTime.data) {\n    dict[el.name] = time % el.number\n    time = Math.floor(time / el.number)\n  }\n  return dict\n}\n\nutil.getCustomDateTime = function(options) {\n  if (!options) options = {}\n  const dict = util.getCustomDateTimeDict(options)\n  let s = options.format ? settings.dateTime.formats[options.format] : settings.dateTime.formats.def\n  for (let key in settings.dateTime.functions) {\n    s = s.replace('%' + key + '%', settings.dateTime.functions[key](dict))\n  }\n  return s\n}\n\nutil.seconds = function(seconds, minutes = 0, hours = 0, days = 0) {\n  if (settings.dateTime.convertSeconds) return settings.dateTime.convertSeconds(seconds, minutes, hours, days)\n  return ((((days * 24) + hours) * 60) + minutes) * 60 + seconds\n}\n\nutil.elapsed = function(seconds, minutes = 0, hours = 0, days = 0) {\n  return util.seconds(seconds, minutes, hours, days) >= game.elapsedTime\n}\n\nutil.isAfter = function(timeString) {\n  if (typeof timeString === 'number') return game.elapsedTime > timeString\n\n  if (timeString.match(/^\\d\\d\\d\\d$/)) {\n    // This is a 24h clock time, so a daily\n    const dict = util.getDateTimeDict()\n\n    const hour = parseInt(timeString.substring(0, 2))\n    const minute = parseInt(timeString.substring(2, 4))\n    if (hour < dict.hour) return true\n    if (hour > dict.hour) return false\n    return (minute < dict.minute)\n  }\n\n  const nowTime = new Date(game.elapsedTime * 1000 + game.startTime.getTime())\n  const targetTime = Date.parse(timeString)\n  if (targetTime) return nowTime > targetTime\n  return errormsg(\"Failed to parse date-time string: \" + timeString)\n}\n\nutil.changePOV = function(char, pronouns) {\n  if (typeof char === 'string') {\n    if (!w[char]) return errormsg(\"Failed to change POV, no object called '\" + char + \"'\")\n    char = w[char]\n  }\n  else if (!char) errormsg(\"Failed to change POV, char not defined.\")\n\n  if (player()) {\n    player().player = false\n    player().pronouns = player().npcPronouns\n    player().regex = new RegExp('^(' + (char.npcAlias ? char.npcAlias : char.alias) + ')$')\n  }\n  char.player = true\n  char.npcPronouns = char.pronouns\n  char.pronouns = pronouns ? pronouns : lang.pronouns.secondperson\n  char.regex = new RegExp('^(me|myself|player|' + (char.npcAlias ? char.npcAlias : char.alias) + ')$')\n  setPlayer(char)\n  setPlayer(char)\n  world.update();\n}\n\nutil.getObj = function(name) {\n  if (!name) return errormsg(\"Trying to find an object in util.getObj, but name is \" + name)\n  if (typeof name === 'string') {\n    const room = w[name]\n    if (room === undefined) throw new Error(\"Failed to find room: \" + name + \".\")\n    return room\n  }\n  else {\n    if (name.name === undefined) {\n      throw \"Not sure what to do with this room: \" + name + \" (a \" + (typeof name) + \").\"\n    }\n    return name\n  }\n}\n\nutil.findUniqueName = function(s) {\n  if (!w[s]) {\n    return (s);\n  }\n  else {\n    const res = /(\\d+)$/.exec(s);\n    if (!res) {\n      return util.findUniqueName(s + \"0\");\n    }\n    const n = parseInt(res[0]) + 1;\n    return util.findUniqueName(s.replace(/(\\d+)$/, \"\" + n));\n  }\n}\n\nutil.findSource = function(options) {\n  const fluids = options.fluid ? [options.fluid] : settings.fluids\n  const chr = options.char ? options.char : player()\n\n  // Is character a source?\n  if (chr.isSourceOf) {\n    for (const s of fluids) {\n      if (chr.isSourceOf(s)) {\n        options.source = chr\n        options.fluid = s\n        return true\n      }\n    }\n  }\n\n  // Is the room a source?\n  if (w[chr.loc].isSourceOf) {\n    for (const s of fluids) {\n      if (w[chr.loc].isSourceOf(s)) {\n        options.source = w[chr.loc]\n        options.fluid = s\n        return true\n      }\n    }\n  }\n\n  // Is there some other source?\n  const items = scopeReachable()\n  for (const s of fluids) {\n    for (let obj of items) {\n      if (obj.isSourceOf && obj.isSourceOf(s)) {\n        options.source = obj\n        options.fluid = s\n        return true\n      }\n      if (obj.containedFluidName && obj.containedFluidName === s) {\n        options.source = obj\n        options.fluid = s\n        return true\n      }\n    }\n  }\n  return false\n}\n\nutil.multiIsUltimatelyHeldBy = function(obj, objNames) {\n  for (const objName of objNames) {\n    if (!objName) continue\n    let o = w[objName]\n    if (o === obj) return true\n    while (o.loc) {\n      if (o.loc === obj.name) return true\n      o = w[o.loc]\n    }\n  }\n  return false\n}\n\nutil.testAttribute = function(o, attName) {\n  if (typeof o[attName] === 'function') {\n    return o[attName]()\n  }\n  else {\n    return o[attName]\n  }\n}\n\nutil.getLoc = function(options, loc, name) {\n  if (!loc) return\n  if (typeof loc === 'object') {\n    options[name] = loc.name\n  }\n  else if (loc === 'char' || loc === 'name') {\n    options[name] = options.char.name\n  }\n  else if (loc === 'loc' && options.container) {\n    options[name] = options.container.name\n  }\n  else if (loc === 'loc' && options.holder) {\n    options[name] = options.holder.name\n  }\n  else if (loc === 'loc') {\n    options[name] = options.char.loc\n  }\n  else if (settings.placeholderLocations.includes(loc)) {\n    options[name] = loc\n  }\n  else if (w[loc]) {\n    options[name] = loc\n  }\n  else {\n    errormsg(\"Unexpected location in util.setToFrom/util.getLoc: \" + loc)\n  }\n}\n\nutil.setToFrom = function(options, toLoc, fromLoc) {\n  util.getLoc(options, toLoc, \"toLoc\")\n  util.getLoc(options, fromLoc, \"fromLoc\")\n  return options\n}\n\nutil.defaultExitIsGuarded = function() { return false }\n\nutil.defaultExitUse = function(char, exit) {\n  if (!exit) exit = this\n  if (char.testMove && !char.testMove(exit)) return false\n  if (exit.isGuarded()) return false\n  if (exit.isLocked()) {\n    return falsemsg(exit.lockedmsg ? exit.lockedmsg : lang.locked_exit, {char:char, exit:exit})\n  }\n  if (exit.testExit && !exit.testExit(char, exit)) return false\n  for (const el of char.getCarrying()) {\n    if (el.testCarry && !el.testCarry({char:char, item:el, exit:exit})) return false\n  }\n  return this.simpleUse ? this.simpleUse(char) : util.defaultSimpleExitUse(char, exit)\n}\n\nutil.defaultSimpleExitUse = function(char, exit) {\n  if (exit.name === '_') return errormsg(\"Trying to move character to location \\\"_\\\" from room \" + exit.origin.name + \". This is probably a bug, as \\\"_\\\" is used to flag a destination that cannot be reached.\")\n  // noinspection PointlessBooleanExpressionJS\n    if (exit === undefined) exit = this\n\n  char.msg(lang.stop_posture(char))\n  char.movingMsg(exit)\n  char.moveChar(exit)\n  return true\n}\n\n// Helper function for exits.\n// You must set \"door\" and can optionally set \"doorName\" in the exit attributes\nutil.useWithDoor = function(char) {\n  const obj = w[this.door];\n  if (obj === undefined) {\n    errormsg(\"Not found an object called '\" + this.door + \"'. Any exit that uses the 'util.useWithDoor' function must also set a 'door' attribute.\");\n  }\n  const tpParams = {char:char, doorName:this.doorName ? this.doorName : \"door\"}\n  if (!obj.closed) {\n    char.moveChar(this)\n    return true\n  }\n  if (!obj.locked) {\n    obj.closed = false\n    msg(lang.open_and_enter, tpParams)\n    char.moveChar(this)\n    return true\n  }\n  if (obj.testKeys(char)) {\n    obj.closed = false\n    obj.locked = false\n    msg(lang.unlock_and_enter, tpParams)\n    char.moveChar(this)\n    return true\n  }\n  msg(lang.try_but_locked, tpParams)\n  return false\n}\n\n// Helper function for exits.\n// You can optionally set \"msg\" in the exit attributes\nutil.cannotUse = function(char, dir) {\n  const tpParams = {char:char}\n  msg(this.msg ? this.msg : lang.try_but_locked, tpParams)\n  return false\n}\n\n// Helper function for exits.\n// Set \"isHidden\" to this for exits into a transit; the exit will be hidden if the transit is not here\nutil.hiddenIfNoTransit = function() {\n  return w[this.name].transitCurrentLocation !== this.origin.name\n}\n\nutil.commandsToTest = [\n  // saying\n  {\n    name:\"say\",\n    withText:true,\n  },\n  {\n    name:\"cry\",\n    withText:true,\n    onOwn:true,\n  },\n  {\n    name:\"shout\",\n    withText:true,\n    onOwn:true,\n  },\n  {\n    name:\"scream\",\n    withText:true,\n    onOwn:true,\n  },\n  {\n    name:\"pray\",\n    onOwn:true,\n  },\n  {\n    name:\"sing\",\n    onOwn:true,\n  },\n  {\n    name:\"dance\",\n    onOwn:true,\n  },\n\n  // resting\n  {\n    name:\"rest\",\n    onOwn:true,\n  },\n  {\n    name:\"sit\",\n    onOwn:true,\n    withItem:true,\n  },\n  {\n    name:\"sleep\",\n    onOwn:true,\n  },\n\n  // attacking\n  {\n    name:\"hit\",\n    withItem:true,\n  },\n  {\n    name:\"attack\",\n    withItem:true,\n  },\n  {\n    name:\"punch\",\n    withItem:true,\n  },\n  {\n    name:\"pick\",\n    withItem:true,\n  },\n  {\n    name:\"scratch\",\n    withItem:true,\n  },\n\n  // moving\n  {\n    name:\"swim\",\n    onOwn:true,\n    withItem:true,\n  },\n  {\n    name:\"dive\",\n  },\n  {\n    name:\"climb\",\n    onOwn:true,\n    withItem:true,\n  },\n  {\n    name:\"jump\",\n    onOwn:true,\n    withItem:true,\n  },\n\n  // sensing\n  {\n    name:\"touch\",\n    withItem:true,\n  },\n  {\n    name:\"look behind\",\n    withItem:true,\n  },\n  {\n    name:\"look under\",\n    withItem:true,\n  },\n  {\n    name:\"search\",\n    onOwn:true,\n    withItem:true,\n  },\n  {\n    name:\"hear\",\n    onOwn:true,\n    withItem:true,\n  },\n  {\n    name:\"smell\",\n    onOwn:true,\n    withItem:true,\n  },\n\n  // mental\n  {\n    name:\"think\",\n    onOwn:true,\n  },\n  {\n    name:\"think about\",\n    withText:true,\n  },\n  {\n    name:\"remember\",\n    onOwn:true,\n    withItem:true,\n    withText:true,\n  },\n\n  // rude (beause some people will try it)\n  {\n    name:\"piss\",\n    onOwn:true,\n    rude:'p***',\n  },\n  {\n    name:\"fuck\",\n    onOwn:true,\n    withItem:true,\n    rude:'f***',\n  },\n  {\n    name:\"fart\",\n    onOwn:true,\n    rude:'p***',\n  },\n\n  // misc\n  {\n    name:\"dig\",\n  },\n  {\n    name:\"undress\",\n    onOwn:true,\n    withItem:true,\n  },\n  {\n    name:\"kiss\",\n    withItem:true,\n  },\n  {\n    name:\"comfort\",\n    withItem:true,\n  },\n  {\n    name:\"hints\",\n    onOwn:true,\n  },\n  {\n    name:\"plugh\",\n    onOwn:true,\n  },\n  {\n    name:\"xyzzy\",\n    onOwn:true,\n  },\n\n  // check the scenery\n  {\n    name:\"x sky\",\n    onOwn:true,\n  },\n  {\n    name:\"x floor\",\n    onOwn:true,\n  },\n  {\n    name:\"x wall\",\n    onOwn:true,\n  },\n]\n\nutil.testme = function(item) {\n  log('-------------------------------------')\n  log('Testing implementation of odd commands, using ' + item.name)\n  test.testing = true\n  for (const d of util.commandsToTest) {\n    if (d.onOwn) {\n      test.testOutput = []\n      parser.parse(d.name)\n      if (test.testOutput[0] === lang.not_known_msg) log('No command to handle ' + d.name.toUpperCase())\n    }\n    if (d.withText) {\n      test.testOutput = []\n      parser.parse(d.name + ' some text')\n      if (test.testOutput[0] === lang.not_known_msg) log('No command to handle ' + d.name.toUpperCase() + ' <text>')\n    }\n    if (d.withItem) {\n      test.testOutput = []\n      parser.parse(d.name + ' ' + item.alias)\n      if (test.testOutput[0] === lang.not_known_msg) log('No command to handle ' + d.name.toUpperCase() + ' <item>')\n    }\n\n\n\n  }\n  test.testing = false\n}\n","// noinspection JSUnusedGlobalSymbols\n\n\"use strict\";\n\n// Comment necessary for require in QEdit\n\nimport {game, io, lang, sentenceCase, world, player} from \"../index.js\";\n\nexport function run() {\n    world.init()\n    settings.performanceLog('World initiated')\n    io.init()\n    settings.performanceLog('io.init completed')\n}\n\nexport const settings = {\n  performanceLogStartTime:performance.now(),\n\n  // Also title, author, thanks (option; array)\n\n  // Files\n  lang:\"lang-en\",      // Set to the language file of your choice\n  customExits:false,      // Set to true to use custom exits, in exits.js\n  // files:[\"code\", \"data\"], // Additional files to load\n  // libraries:[\n  //     \"_file_saver\",\n  //     \"_saveload\",\n  //     \"_text\",\n  //     \"_io\",\n  //     \"_command\",\n  //     \"_defaults\",\n  //     \"_templates\",\n  //     \"_world\",\n  //     \"_npc\",\n  //     \"_parser\",\n  //     \"_commands\"\n  // ],  // util already loaded\n  // customLibraries:[],\n  imagesFolder:'assets/images/',\n  iconsFolder:'assets/icons/',\n  soundsFolder:'assets/audio/',\n  videosFolder:'assets/video/',\n  cssFolder:'assets/css/',\n  themes:['sans-serif'],\n  styleFile:'style',\n  soundsFileExt:'.mp3',\n\n\n  // The side panes\n  panes:'left',           //Can be set to Left, Right or None (setting PANES to None will more than double the speed of your game!)\n  panesCollapseAt:700,\n  compassPane:true,           // Set to true to have a compass world.\n  symbolsForCompass:true,\n  statusPane:\"Status\",    // Title of the panel; set to false to turn off\n  statusWidthLeft:120,    // How wide the left column is in the status pane\n  statusWidthRight:40,    // How wide the right column is in the status pane\n  status:[\n    function() { return \"<td>Health points:</td><td>\" + player().hitpoints + \"</td>\"; },\n  ],\n  customPaneFunctions:{},\n\n  // Functions for the side panes lists\n  isHeldNotWorn:function(item) {\n    return item.isAtLoc(player().name, world.SIDE_PANE) && world.ifNotDark(item) && !item.getWorn();\n  },\n  isHere:function(item) {\n    return item.isAtLoc(player().loc, settings.sceneryInSidePane ? world.PARSER : world.SIDE_PANE) && world.ifNotDark(item);\n  },\n  isWorn:function(item) {\n    return item.isAtLoc(player().name, world.SIDE_PANE) && world.ifNotDark(item) && item.getWorn();\n  },\n\n\n  // Other UI settings\n  textInput:true,         // Allow the player to type commands\n  cursor:\">\",             // The cursor, obviously\n  cmdEcho:true,           // Commands are printed to the screen\n  textEffectDelay:25,\n  roomTemplate:[\n    \"#{cap:{hereName}}\",\n    \"{terse:{hereDesc}}\",\n    \"{objectsHere:You can see {objects} here.}\",\n    \"{exitsHere:You can go {exits}.}\",\n    \"{ifNot:settings:playMode:play:{ifExists:currentLocation:todo:{class:todo:{show:currentLocation:todo}}}}\",\n  ],\n  silent:false,\n  walkthroughMenuResponses:[],\n  startingDialogEnabled:false,\n  darkModeActive:false,   // setting to true is a bad idea (use io.toggleDarkMode)\n  plainFontModeActive:false,   // setting to true is a bad idea (use io.togglePlainFontMode)\n  narrowMode:0,\n  mapAndImageCollapseAt:1200,\n  funcForDisambigMenu:'showMenuWithNumbers',\n  eventFunctions:{},\n  timerInterval:1000,  // For timer events, in milliseconds\n\n  // Conversations settings\n  noTalkTo:\"TALK TO is not a feature in this game.\",\n  noAskTell:\"ASK/TELL ABOUT is not a feature in this game.\",\n  npcReactionsAlways:false,\n  turnsQuestionsLast:5,\n  givePlayerSayMsg:true,\n  givePlayerAskTellMsg:true,\n  funcForDynamicConv:'showMenu',\n\n  // Other game play settings\n  failCountsAsTurn:false,\n  lookCountsAsTurn:false,\n  beforeEnter:function () {},\n  afterEnter:function () {},\n\n  // When save is disabled, objects can be created during game play\n  saveDisabled:false,\n\n  // Date and time settings\n  dateTime:{\n    year:\"numeric\",\n    month:\"short\",\n    day:\"2-digit\",\n    hour:\"2-digit\",\n    minute:\"2-digit\",\n    secondsPerTurn:60,\n    locale:'en-GB',\n    start:new Date('February 14, 2019 09:43:00'),\n  },\n\n  // Other settings\n  // The parser will convert \"two\" to 2\" in player input (can slow down the game)\n  convertNumbersInParser:true,\n  tests:false,\n  maxUndo:10,\n  moneyFormat:\"$!\",\n  questVersion:'1.4.0',\n  mapStyle:{right:'0', top:'200px', width:'300px', height:'300px', 'background-color':'beige' },\n  openQuotation:\"'\",\n  closeQuotation:\"'\",\n  fluids:[],\n  getDefaultRoomHeading:function(item) { return sentenceCase(lang.addDefiniteArticle(item, {ignorePossessive:'noLink'}) + item.alias) },\n  afterFinish:[],\n  roomSetList:{},\n  placeholderLocations:[],\n  modulesToEndTurn:[],\n  saveLoadExcludedAtts:[\n    \"name\", \"ensembleMembers\", \"clonePrototype\", \"saveLoadExcludedAtts\",  \"startTime\",\n    \"verbFunctions\", \"pronouns\", \"nameModifierFunctions\",\n    \"afterEnterIf\", \"askOptions\", \"tellOptions\", \"regex\",\n    \"reactions\", \"receiveItems\", \"scopeStatus\",\n  ],\n\n  getLocationDescriptionAttName:function() {\n    return game.dark ? \"darkDesc\" : \"desc\"\n  },\n\n  statsData:[\n    {name:'Objects', test:function(o) { return true }},\n    {name:'Locations', test:function(o) { return o.room }},\n    {name:'Items', test:function(o) { return !o.room }},\n    {name:'Takeables', test:function(o) { return o.takeable }},\n    {name:'Scenery', test:function(o) { return o.scenery }},\n    {name:'NPCs', test:function(o) { return o.npc && !o.player }},\n  ],\n\n  performanceLog:function() { },\n\n  // This is split out for io.showInTab to use\n  loadCssFiles:function(doc = document, path = '') {\n    settings.loadCssFile(settings.cssFolder + 'default.css', doc, path)\n    for (let file of settings.themes) {\n      settings.loadCssFile(settings.cssFolder + file + '.css', doc, path)\n    }\n    settings.loadCssFile(settings.folder + settings.styleFile + '.css', doc, path)\n  },\n\n  loadCssFile:function(filename, doc = document, path = '') {\n    const link = document.createElement( \"link\" )\n    link.href = path + filename\n    link.type = \"text/css\"\n    link.rel = \"stylesheet\"\n    link.media = \"screen,print\"\n    doc.head.appendChild(link)\n  },\n}\n\n//settings.scriptLoadLogging = true\nsettings.performanceLogStart = function() {\n  settings.performanceLogStartTime = performance.now()\n}\nsettings.performanceLog = function(s) {\n  if (!settings.performanceLogging) return\n  const dur = Math.round(performance.now() - settings.performanceLogStartTime).toString().padStart(4)\n  console.log(s.padEnd(32) + dur)\n}\n\n// These two functions use values in settings, so have to be set later\nsettings.inventoryPane = [\n  {name:'Items Held', alt:'itemsHeld', test:settings.isHeldNotWorn, getLoc:function() { return player().name; } },\n  {name:'Items Worn', alt:'itemsWorn', test:settings.isWorn, getLoc:function() { return player().name; } },\n  {name:'Items Here', alt:'itemsHere', test:settings.isHere, getLoc:function() { return player().loc; } },\n]\n\nsettings.setUpDialogClick = function() {\n  settings.startingDialogEnabled = false\n  io.enable()\n  settings.startingDialogOnClick()\n  world.begin()\n  if (settings.textInput) { document.querySelector('#textbox').focus(); }\n  document.querySelector(\"#dialog\").style.display = 'none'\n}\n\nsettings.setUpDialog = function() {\n  const diag = document.querySelector(\"#dialog\")\n  document.querySelector(\"#dialog-title\").innerHTML = settings.startingDialogTitle\n  document.querySelector(\"#dialog-content\").innerHTML = settings.startingDialogHtml\n  if (settings.startingDialogButton) document.querySelector(\"#dialog-button\").innerHTML = settings.startingDialogButton\n  document.querySelector(\"#dialog-button\").addEventListener('click', settings.setUpDialogClick)\n\n  io.disable()\n  diag.show()\n  diag.style.display = 'block'\n  diag.style.width = settings.startingDialogWidth + 'px'\n  diag.style.height = 'auto'\n  diag.style.top = '100px'\n}\n","\"use strict\";\n\nimport {errormsg, io, metamsg, msg, player, wait} from '../index.js';\n\n// Language support\n\nexport const lang = {\n\n  regex:{\n    //----------------------------------------------------------------------------------------------\n    // Regular Expressions for Commands\n\n    // Meta commands\n    MetaUnfinish:/^unfinish?$/,\n    MetaHello:/^(?:hello|hi|yo)$|^\\?$/,\n    MetaHelp:/^help$|^\\?$/,\n    MetaHint:/^(?:hint|clue)s?$/,\n    MetaCredits:/^(?:about|credits|version|info)$/,\n    MetaDarkMode:/^(?:dark|dark mode|toggle dark|toggle dark mode)$/,\n    MetaAutoScrollMode:/^(?:scroll|autoscroll|toggle scroll|toggle autoscroll)$/,\n    MetaNarrowMode:/^(?:narrow|narrow mode|toggle narrow|toggle narrow mode|mobile|mobile mode|toggle mobile|toggle mobile mode)$/,\n    MetaPlainFontMode:/^(?:font|plain font|plain fonts|fonts)$/,\n    MetaWarnings:/^warn(?:ing|ings|)$/,\n    MetaImages:/^images$/,\n    MetaSilent:/^(?:sh|silent)$/,\n    MetaSpoken:/^spoken$/,\n    MetaIntro:/^intro$/,\n    MetaBrief:/^brief$/,\n    MetaTerse:/^terse$/,\n    MetaVerbose:/^verbose$/,\n    MetaTranscript:/^transcript$|^script$/,\n    MetaTranscriptStart:/^transcript on$|^script start$/,\n    MetaTranscriptOn:/^transcript on$|^script on$/,\n    MetaTranscriptOff:/^transcript off$|^script off$/,\n    MetaTranscriptClear:/^transcript clear$|^script clear$|^transcript delete$|^script delete$/,\n    MetaTranscriptShow:/^transcript show$|^script show$|^show script$|^show transcript$|^showscript$/,\n    MetaTranscriptWalkthrough:/^(?:transcript|script) walk$/,\n    MetaUserComment:/^(?:\\*|\\;)(.+)$/,\n    MetaSave:/^save$/,\n    MetaSaveGame:/^(?:save) (.+)$/,\n    MetaFileSaveGame:/^(?:fsave) (.+)$/,\n    MetaSaveOverwriteGame:/^(?:save) (.+) (?:overwrite|ow)$/,\n    MetaLoad:/^(?:load|reload|restore)$/,\n    MetaLoadGame:/^(?:load|reload|restore) (.+)$/,\n    MetaFileLoadGame:/^(?:fload|freload|frestore)$/,\n    MetaDir:/^(?:reload|load|restore|dir|directory|ls|save ls|save dir)$/,\n    MetaDeleteGame:/^(?:delete|del) (.+)$/,\n    MetaUndo:/^undo$/,\n    MetaAgain:/^(?:again|g)$/,\n    MetaOops:/^(?:oops)$/,\n    MetaRestart:/^restart$/,\n    MetaScore:/^score$/,\n    MetaPronouns:/^pronouns$/,\n    MetaTopicsNote:/^topics?$/,\n\n    // Kind of meta\n    Look:/^l$|^look$|^describe (?:room|the room|location|the location|where i am|here)$/,\n    Exits:/^exits$/,\n    Map:/^map$/,\n    Inv:/^inventory$|^inv$|^i$/,\n\n    // Misc\n    Wait:/^wait$|^z$/,\n    Smell:/^smell$|^sniff$/,\n    Listen:/^listen$/,\n    PurchaseFromList:/^buy$|^purchase$/,\n\n    // Use item\n    Examine:/^(?:examine|exam|ex|x|describe) (.+)$/,\n    LookAt:/^(?:look at|look|l) (.+)$/,\n    LookOut:/^(?:look out of|look out) (.+)$/,\n    LookBehind:/^(?:look behind|check behind) (.+)$/,\n    LookUnder:/^(?:look under|check under) (.+)$/,\n    LookInside:/^(?:look inside|look in) (.+)$/,\n    LookThrough:/^(?:look|peek|peer) (?:down|through) (.+)$/,\n    Search:/^(?:search) (.+)$/,\n    Take:/^(?:take|get|pick up|pick|t|grab) (.+)$/,\n    Drop:/^(?:drop|d|discard) (.+)$/,\n    Wear2:/^put (?:my |your |his |her |)(.+) on$/,\n    Wear:/^(?:wear|don|put on) (?:my |your |his |her |)(.+)$/,\n    Remove:/^(?:remove|doff|take off|unwear) (?:my |your |his |her |)(.+)$/,\n    Remove2:/^take (?:my |your |his |her |)(.+) off$/,\n    Read:/^(?:read|r) (.+)$/,\n    SmellItem:/^(?:smell|sniff) (.+)$/,\n    ListenToItem:/^(?:listen to|listen) (.+)$/,\n    Purchase:/^(?:purchase|buy) (.+)$/,\n    Sell:/^(?:sell) (.+)$/,\n    Smash:/^(?:smash|break|destroy|burst|pierce|puncture|bust) (.+)$/,\n    Turn:/^(?:turn|rotate|twist) (.+)$/,\n    TurnLeft:/^(?:turn|rotate|twist) (.+) (?:left|anticlockwise|anti-clockwise|widdershins)$/,\n    TurnRight:/^(?:turn|rotate|twist) (.+) (?:right|clockwise)$/,\n    SwitchOn:/^(?:turn on|switch on|active|enable) (.+)$/,\n    SwitchOn2:/^(?:turn|switch) (.+) on$/,\n    SwitchOff2:/^(?:turn|switch|deactivate|disable) (.+) off$/,\n    SwitchOff:/^(?:turn off|switch off) (.+)$/,\n    Open:/^(?:open) (.+)$/,\n    OpenWith:[\n      /^(?:open) (.+) (?:with|using) (.+)$/,\n      {regex:/^(?:use|with|using) (.+?) (?:to open|open) (.+)$/, mod:{reverse:true}},\n    ],\n    Close:/^(?:close) (.+)$/,\n    Lock:/^(?:lock) (.+)$/,\n    LockWith:[\n      /^(?:lock) (.+) (?:with|using) (.+)$/,\n      {regex:/^(?:use|with|using) (.+?) (?:to lock|lock) (.+)$/, mod:{reverse:true}},\n    ],\n    Unlock:/^(?:unlock) (.+)$/,\n    UnlockWith:[\n      /^(?:unlock) (.+) (?:with|using) (.+)$/,\n      {regex:/^(?:use|with|using) (.+?) (?:to unlock|unlock) (.+)$/, mod:{reverse:true}},\n    ],\n    Push:/^(?:push|press) (.+)$/,\n    Pull:/^(?:pull|drag) (.+)$/,\n    Fill:/^(?:fill) (.+)$/,\n    Empty:/^(?:empty|discharge|decant|pour out|pour) (.+)$/,\n    Eat:/^(eat|feed on|feed|partake of|partake|dine on|dine) (.+)$/,\n    Drink:/^(drink|imbibe|quaff|guzzle|knock back|swig|swill|sip|down|chug) (.+)$/,\n    Ingest:/^(consume|swallow|ingest) (.+)$/,\n    Sit:/^(?:sit down|sit)$/,\n    Recline:/^(?:recline|lie down|lie)$/,\n    SitOn:/^(?:sit on|sit upon|sit) (.+)$/,\n    StandOn:/^(?:stand on|stand upon|stand) (.+)$/,\n    ReclineOn:/^(?:recline on|recline upon|recline|lie on|lie upon|lie) (.+)$/,\n    GetOff:/^(?:get off|off) (.+)$/,\n    Use:/^(?:use) (.+)$/,\n    TalkTo:/^(?:talk to|talk|speak to|speak|converse with|converse) (.+)$/,\n    Topics:/^topics? (?:for )?(.+)$/,\n\n    Make:/^(?:make|build|construct) (.+)$/,\n    MakeWith:[\n      /^(?:make|build|construct) (.+) (?:with|from|using) (.+)$/,\n      {regex:/^(?:with:from|using) (.+) (?:make|build|construct) (.+)$/, mod:{reverse:true}},\n      {regex:/^(?:use) (.+) to (?:make|build|construct) (.+)$/, mod:{reverse:true}},\n    ],\n    NpcMake:[\n      /^(.+), ?(?:make|build|construct) (.+)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:make|build|construct) (.+)$/,\n    ],\n    NpcMakeWith:[\n      /^(.+), ?(?:make|build|construct) (.+) (?:with|from|using) (.+)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:make|build|construct) (.+) (?:with|from|using) (.+)$/,\n      {regex:/^(.+), ?(?:with:from|using) (.+) (?:make|build|construct) (.+)$/, mod:{reverse:true}},\n      {regex:/^(?:tell|ask|instruct) (.+) to (?:with:from|using) (.+) (?:make|build|construct) (.+)$/, mod:{reverse:true}},\n      {regex:/^(.+), ?(?:use) (.+) to (?:make|build|construct) (.+)$/, mod:{reverse:true}},\n      {regex:/^(?:tell|ask|instruct) (.+) to (?:use) (.+) to (?:make|build|construct) (.+)$/, mod:{reverse:true}},\n    ],\n\n    GoInItem:/^(?:enter|go in|in|inside|go inside|climb in|climb inside|get in|get inside) (.+)$/,\n    GoOutItem:/^(?:exit|go out|out|outside|go outide|leave) (.+)$/,\n    GoUpItem:/^(?:go up|up|climb up|climb|ascend) (.+)$/,\n    GoDownItem:/^(?:go down|down|climb down|descend) (.+)$/,\n    GoThroughItem:/^(?:go through|walk through) (.+)$/,\n    NpcGoInItem:[\n      /^(.+), ?(?:enter|go in|in|inside|go inside|climb in|climb inside|get in|get inside) (.+)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:enter|go in|in|inside|go inside|climb in|climb inside|get in|get inside) (.+)$/,\n    ],\n    NpcGoOutItem:[\n      /^(.+), ?(?:exit|go out|out|outside|go outide|leave) (.+)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:exit|go out|out|outside|go outide|leave) (.+)$/,\n    ],\n    NpcGoUpItem:[\n      /^(.+), ?(?:go up|up|climb up|climb|ascend) (.+)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:go up|up|climb up|climb|ascend) (.+)$/,\n    ],\n    NpcGoDownItem:[\n      /^(.+), ?(?:go down|down|climb down|descend) (.+)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:go down|down|climb down|descend) (.+)$/,\n    ],\n    NpcGoThroughItem:[\n      /^(.+), ?(?:go through|walk through) (.+)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:go through|walk through) (.+)$/,\n    ],\n\n    // Misc again\n    Say:/^(say|shout|whisper|holler|scream|yell) (.+)$/,\n    Stand:/^stand$|^stand up$|^get up$/,\n    NpcStand:[/^(.+), ?(?:stand|stand up|get up)$/, /^(?:tell|ask|instruct) (.+) to (?:stand|stand up|get up)$/],\n    GetFluid:/^(?:get|take|scoop|pick|grab)(?:| up) (.+)$/,\n    FillWith:/^(?:fill) (.+) (?:with) (.+)$/,\n    NpcFillWith:[/^(.+), ?(?:fill) (.+) (?:with) (.+)$/, /^(?:tell|ask|instruct) (.+) to (?:fill) (.+) (?:with) (.+)$/],\n\n    EmptyInto:/^(?:empty|pour out|pour|discharge|decant) (.+) (?:into|in to|in|down|onto|on to|on) (.+)$/,\n    NpcEmptyInto:[/^(.+), ?(?:empty|pour|discharge|decant) (.+) (?:into|in to|in|down|onto|on to|on) (.+)$/, /^(?:tell|ask|instruct) (.+) to (?:empty|pour|discharge) (.+) (?:into|in to|in|down|onto|on to|on) (.+)$/],\n    EmptyFluidInto:/^(?:empty|pour out|pour|discharge|decant) (.+) (?:into|in to|in|down|onto|on to|on) (.+)$/,\n    NpcEmptyFluidInto:[/^(.+), ?(?:empty|pour|discharge|decant) (.+) (?:into|in to|in|down|onto|on to|on) (.+)$/, /^(?:tell|ask|instruct) (.+) to (?:empty|pour|discharge) (.+) (?:into|in to|in|down|onto|on to|on) (.+)$/],\n    PutFluidIn:/^(?:put|place|drop) (.+) (?:in to|into|in|on to|onto|on) (.+)$/,\n\n    PutIn:/^(?:put|place|drop) (.+) (?:in to|into|in|on to|onto|on) (.+)$/,\n    NpcPutIn:[/^(.+), ?(?:put|place|drop|insert) (.+) (?:in to|into|in|on to|onto|on) (.+)$/, /^(?:tell|ask|instruct) (.+) to (?:put|place|drop) (.+) (?:in to|into|in|on to|onto|on) (.+)$/],\n    TakeOut:/^(?:take|get|remove) (.+) (?:from|out of|out|off of|off) (.+)$/,\n    NpcTakeOut:[/^(.+), ?(?:take|get|remove) (.+) (?:from|out of|out|off of|off) (.+)$/, /^(?:tell|ask|instruct) (.+) to (?:take|get|remove) (.+) (?:from|out of|out|off of|off) (.+)$/],\n    GiveTo:/^(?:give|offer|proffer) (.+) (?:to) (.+)$/,\n    NpcGiveTo:[/^(.+), ?(?:give|offer|proffer) (.+) (?:to) (.+)$/, /^(?:tell|ask|instruct) (.+) to ?(?:give|offer|proffer) (.+) (?:to) (.+)$/],\n    Give:/^(?:give|offer|proffer) (.+)$/,\n    NpcGive:[/^(.+), ?(?:give|offer|proffer) (.+)$/, /^(?:tell|ask|instruct) (.+) to ?(?:give|offer|proffer) (.+)$/],\n    //NpcGiveToMe:[/^(.+), ?(?:give) me (.+)$/, /^(?:tell|ask|instruct) (.+) to ?(?:give) me (.+)$/],\n\n    TieUp:/^(?:tie|fasten|attach|connect|hook) (.+)$/,\n    TieTo:/^(?:tie|fasten|attach|connect|hook) (.+) (?:to) (.+)$/,\n    NpcTieUp:[/^(.+), ?(?:tie|fasten|attach|connect|hook) (.+)$/, /^(?:tell|ask|instruct) (.+) to ?(?:tie|fasten|attach) (.+)$/],\n    NpcTieTo:[/^(.+), ?(?:tie|fasten|attach|connect|hook) (.+) (?:to) (.+)$/, /^(?:tell|ask|instruct) (.+) to ?(?:tie|fasten|attach) (.+) (?:to) (.+)$/],\n    Untie:/^(?:untie|unfasten|detach|disconnect|unhook) (.+)$/,\n    NpcUntie:[/^(.+), ?(?:untie|unfasten|detach|disconnect|unhook) (.+)$/, /^(?:tell|ask|instruct) (.+) to ?(?:untie|unfasten|detach) (.+)$/],\n    UntieFrom:/^(?:untie|unfasten|detach) (.+) (?:from) (.+)$/,\n    NpcUntieFrom:[/^(.+), ?(?:untie|unfasten|detach) (.+) (?:frm) (.+)$/, /^(?:tell|ask|instruct) (.+) to ?(?:untie|unfasten|detach) (.+) (?:from) (.+)$/],\n    UseWith:/^(?:use) (.+) (?:with|on) (.+)$/,\n\n    LookExit:/^(?:look|peer|l|glance) (northwest|nw|north|n|northeast|ne|in|in|enter|i|up|u|west|w|east|e|out|out|exit|o|down|dn|d|southwest|sw|south|s|southeast|se)$/,\n\n    PushExit:/^(push|pull|move|shift) (.+) (northwest|nw|north|n|northeast|ne|in|in|enter|i|up|u|west|w|east|e|out|out|exit|o|down|dn|d|southwest|sw|south|s|southeast|se)$/,\n    NpcPushExit:[\n      /^(.+), ?(push|pull|move|shift) (.+) (northwest|nw|north|n|northeast|ne|in|in|enter|i|up|u|west|w|east|e|out|out|exit|o|down|dn|d|southwest|sw|south|s|southeast|se)$/,\n      /^(?:tell|ask|instruct) (.+) to (push|pull|move|shift) (.+) (northwest|nw|north|n|northeast|ne|in|in|enter|i|up|u|west|w|east|e|out|out|exit|o|down|dn|d|southwest|sw|south|s|southeast|se)$/,\n    ],\n    AskAbout:/^(?:ask) (.+?) (about|what|who|how|why|where|when) (.+)$/,\n    TellAbout:/^(?:tell) (.+?) (about|what|who|how|why|where|when) (.+)$/,\n    TalkAbout:[\n      /^(?:talk to|talk with|talk|speak to|speak with|speak) (.+?) about (what|who|how|why|where|when) (.+)$/,\n      /^(?:talk to|talk with|talk|speak to|speak with|speak) (.+?) (about|what|who|how|why|where|when) (.+)$/,\n    ],\n    FollowMe:[/^(.+), ?(?:follow|follow me)$/, /^(?:tell|ask|instruct) (.+) to (?:follow|follow me)$/],\n    WaitHere:[\n      /^(.+), ?(?:stop follow|stop following|stop follow me|stop following me|wait|wait here|stay|stay here)$/,\n      /^(?:tell|ask|instruct) (.+) to (?:stop follow|stop following|stop follow me|stop following me|wait|wait here|stay|stay here)$/,\n    ],\n\n\n    //Debug\n    DebugWalkThrough:/^wt (.+)$/,\n    DebugInspect:/^inspect (.+)$/,\n    DebugInspectByName:/^inspect2 (.+)$/,\n    DebugWarpName:/^warp (.+)$/,\n    DebugTest:/^test$/,\n    DebugInspectCommand:/^(?:cmd|command) (.+)$/,\n    DebugListCommands:/^(?:cmd|command)s$/,\n    DebugListCommands2:/^(?:cmd|command)s2$/,\n    DebugParserToggle:/^parser$/,\n    DebugStats:/^stats?$/,\n    DebugHighlight:/^highlight$/,\n  },\n\n  // This will be added to the start of the regex of a command to make an NPC command\n  // The saved capture group is the NPC's name\n  tell_to_prefixes:{\n    1:'(?:tell|ask|instruct) (.+) to ',   // TELL KYLE TO GET SPOON\n    2:'(.+), ?',                 // KYLE, GET SPOON\n  },\n\n\n\n  //----------------------------------------------------------------------------------------------\n  // Standard Responses\n\n\n\n  // TAKEABLE\n  take_successful:\"{nv:char:take:true} {nm:item:the}{ifIs:params:excess:true:, that is all there is}.\",\n  take_successful_counted:\"{nv:char:take:true} {number:count} {nm:item}.\",\n  drop_successful:\"{nv:char:drop:true} {nm:item:the}{ifIs:params:excess:true:, that is all {nv:char:have}}.\",\n  drop_successful_counted:\"{nv:char:drop:true} {number:count} {nm:item}.\",\n  cannot_take:\"{multi}{pv:char:can't:true} take {ob:item}.\",\n  cannot_drop:\"{multi}{pv:char:can't:true} drop {ob:item}.\",\n  not_carrying:\"{multi}{pv:char:don't:true} have {if:item:countable:any:{ob:item}}.\",\n  already_have:\"{multi}{pv:char:'ve:true} got {ob:item} already.\",\n  cannot_take_component:\"{multi}{pv:char:can't:true} take {ob:item}; {pv:item:be} part of {nm:whole:the}.\",\n\n\n  // EDIBLE\n  eat_successful:\"{nv:char:eat:true} {nm:item:the}.\",\n  drink_successful:\"{nv:char:drink:true} {nm:item:the}.\",\n  cannot_eat:\"{nv:item:be:true} not something {nv:char:can} eat.\",\n  cannot_drink:\"{nv:item:be:true} not something {nv:char:can} drink.\",\n  cannot_ingest:\"{nv:item:be:true} not something {nv:char:can} ingest.\",\n\n\n  // WEARABLE\n  wear_successful:\"{nv:char:put:true} on {nm:item:the}.\",\n  remove_successful:\"{nv:char:take:true} {nm:item:the-pa::char} off.\",\n  cannot_wear:\"{multi}{nv:char:can't:true} wear {ob:item}.\",\n  cannot_wear_ensemble:\"{multi}Individual parts of an ensemble must be worn and removed separately.\",\n  not_wearing:\"{multi}{nv:char:be:true} not wearing {ob:item}.\",\n  cannot_wear_over:\"{nv:char:can't:true} put {nm:item:the} on over {pa:char} {nm:outer}.\",\n  cannot_remove_under:\"{nv:char:can't:true} take off {pa:char} {nm:item} whilst wearing {pa:char} {nm:outer}.\",\n  already_wearing:\"{multi}{nv:char:be:true} already wearing {ob:item}.\",\n  invWearingPrefix:\"wearing\",\n  invHoldingPrefix:\"holding\",\n\n\n  // CONTAINER, etc.\n  open_successful:\"{nv:char:open:true} {nm:container:the}.\",\n  close_successful:\"{nv:char:close:true} {nm:container:the}.\",\n  lock_successful:\"{nv:char:lock:true} {nm:container:the}.\",\n  unlock_successful:\"{nv:char:unlock:true} {nm:container:the}.\",\n  close_and_lock_successful:\"{nv:char:close:true} {nm:container:the} and {cj:char:lock} {sb:container}.\",\n  cannot_open:\"{nv:item:can't:true} be opened.\",\n  cannot_open_with:\"{nv:player:can't:true} open that with {nm:secondItem:the}.\",\n  cannot_lock_with:\"{nv:player:can't:true} lock that with {nm:secondItem:the}.\",\n  cannot_unlock_with:\"{nv:player:can't:true} unlock that with {nm:secondItem:the}.\",\n  cannot_close:\"{nv:item:can't:true} be closed.\",\n  cannot_lock:\"{nv:char:can't:true} lock {ob:item}.\",\n  cannot_unlock:\"{nv:char:can't:true} unlock {ob:item}.\",\n  not_container:\"{nv:container:be:true} not a container.\",\n  not_container_not_vessel:\"{nv:container:be:true} not a container. It is a vessel, they are different, alright?\",\n  container_recursion:\"What? {nv:char:want:true} to put {nm:item:the} in {nm:container:the} when {nm:container:the} is already in {nm:item:the}? That's just too freaky for me.\",\n  not_inside:\"{nv:item:be:true} not inside that.\",\n  locked:\"{nv:container:be:true} locked.\",\n  no_key:\"{nv:char:do:true} not have the right key.\",\n  locked_exit:\"That way is locked.\",\n  open_and_enter:\"{nv:char:open:true} the {show:doorName} and walk through.\",\n  unlock_and_enter:\"{nv:char:unlock:true} the {show:doorName}, open it and walk through.\",\n  try_but_locked:\"{nv:char:try:true} the {show:doorName}, but it is locked.\",\n  container_closed:\"{nv:container:be:true} closed.\",\n  inside_container:\"{nv:item:be:true} inside {nm:container:the}.\",\n  look_inside:\"Inside {nm:container:the} {nv:char:can} see {show:list}.\",\n  look_inside_it:\"Inside {sb:container} {nv:char:can} see {show:list}.\",\n\n\n  // MECHANDISE\n  purchase_successful:\"{nv:char:buy:true} {nm:item:the} for {money:money}.\",\n  sell_successful:\"{nv:char:sell:true} {nm:item:the} for {money:money}.\",\n  cannot_purchase_again:\"{nv:char:can't:true} buy {nm:item:the} here - probably because {pv:char:be} already holding {ob:item}.\",\n  cannot_purchase_here:\"{nv:char:can't:true} buy {nm:item:the} here.\",\n  cannot_afford:\"{nv:char:can't:true} afford {nm:item:the} (need {money:money}).\",\n  cannot_sell_here:\"{nv:char:can't:true} sell {nm:item:the} here.\",\n\n\n  // BACKDROP\n  default_scenery:\"It's just part of the scenery, nothing to worry abot.\",\n\n  // FURNITURE\n  sit_on_successful:\"{nv:char:sit:true} on {nm:item:the}.\",\n  stand_on_successful:\"{nv:char:stand:true} on {nm:item:the}.\",\n  recline_on_successful:\"{nv:char:lie:true} down on {nm:item:the}.\",\n  cannot_stand_on:\"{nv:item:be:true} not something {nv:char:can} stand on.\",\n  cannot_sit_on:\"{nv:item:be:true} not something {nv:char:can} sit on.\",\n  cannot_recline_on:\"{nv:item:be:true} not something {nv:char:can} lie on.\",\n  no_sit_object:\"There is nothing to sit on here.\",\n  no_recline_object:\"There is nothing to lie down on here.\",\n\n\n  // SWITCHABLE\n  switch_on_successful:\"{nv:char:switch:true} {nm:item:the} on.\",\n  switch_off_successful:\"{nv:char:switch:true} {nm:item:the} off.\",\n  cannot_switch_on:\"{nv:char:can't:true} turn {ob:item} on.\",\n  cannot_switch_off:\"{nv:char:can't:true} turn {ob:item} off.\",\n\n\n  // VESSEL\n  fill_successful:\"{nv:char:fill:true} {nm:item:the}.\",\n  empty_into_successful:\"{nv:char:empty:true} {nm:source:the} into {nm:item:the}.\",\n  empty_onto_successful:\"{nv:char:empty:true} {nm:source:the} over {nm:item:the}, and then watch it all run down on to the ground.\",\n  empty_successful:\"{nv:char:empty:true} {nm:source:the} onto the ground, and it soaks away.\",\n  already_empty:\"{nv:source:be:true} already empty.\",\n  cannot_fill:\"{nv:item:be:true} not something {nv:char:can} fill.\",\n  cannot_mix:\"{nv:item:be:true} not something {nv:char:can} mix liquids in.\",\n  not_vessel:\"{pv:item:be:true} not a vessel.\",\n  not_sink:\"Trying to put a liquid (or similar substance) in {nm:item:the} is just going to cause a mess.\",\n  not_source:\"{pv:source:be:true} not something {nv:char:can} get a liquid (or similar substance) out of.\",\n  cannot_get_fluid:\"{nv:char:try:true} to scoop up {show:fluid} but it all slips through {pa:char} fingers. Perhaps {pv:char:need} some kind of vessel.\",\n  no_fluid_here:\"There's no {show:fluid} here.\",\n  no_fluid_here_at_all:\"There's nothing to fill anything with here.\",\n  not_a_fluid_here:\"I don't know of a liquid (or similar substance) called {show:text}.\",\n  already_full:\"{pv:item:be:true} already full of {show:fluid}.\",\n  pour_into_self:\"It is not possible to pour from a vessel into the same vessel!\",\n  no_generic_fluid_here:\"There's nothing to fill {sb:item} with here.\",\n  not_carrying_fluid:\"{nv:char:be:true} not carrying anything with {show:fluid} in it.\",\n\n  // VESSEL (but source is referred to as \"item\" as it is caught by the general item handling)\n  cannot_empty:\"{nv:item:be:true} not something {nv:char:can} empty.\",\n\n\n\n  // CONSTRUCTION\n  component_wrong:\"{nv:char:cannot:true} make {nm:item:a} from {nm:wrong:a}.\",\n  component_missing:\"{nv:char:need:true} {nm:missing:a} to build {nm:item:a}.\",\n  construction_done:\"{nv:char:build:true} {nm:item:a} from {show:list}.\",\n  construction_already:\"{nm:item:the:true} has already been made.\",\n\n\n  // NPC\n  not_npc:\"{nv:char:can:true} tell {nm:item:the} to do anything {pv:char:like}, but there is no way {pv:item:'ll} do it.\",\n  not_npc_for_give:\"Realistically, {nv:item:be} not interested in anything {sb:char} might give {ob:item}.\",\n  not_interested_for_give:\"{nv:npc:be:true} not interested in {nm:item:the}.\",\n  cannot_follow:\"'Follow me,' {nv:char:say} to {nm:npc:the}. Being an inanimate object, {nv:char:be} not too optimistic it will do as it is told.\",\n  cannot_wait:\"'Wait here,' {nv:char:say} to {nm:item:the}. Being an inanimate object, {nv:char:feel} pretty confident it will do as it is told.\",\n  already_following:\"'I'm already following you!'\",\n  already_waiting:\"'I'm already waiting!'\",\n\n  cannot_ask_about:\"{nv:char:can:true} ask {ob:item} about {show:text} all {pv:char:like}, but {pv:item:be} not about to reply.\",\n  cannot_tell_about:\"{nv:char:can:true} tell {ob:item} about {show:text} all {pv:char:like}, but {pv:item:be} not interested.\",\n  cannot_talk_about:\"{nv:char:can:true} talk to {ob:item} about {show:text} all {pv:char:like}, but {pv:item:be} not interested.\",\n  topics_no_ask_tell:\"This character has no ASK/ABOUT or TELL/ABOUT options set up.\",\n  topics_none_found:\"No suggestions for what to ask or tell {nm:item:the} available.\",\n  topics_ask_list:\"Some suggestions for what to ask {nm:item:the} about: {show:list}.\",\n  topics_tell_list:\"Some suggestions for what to tell {nm:item:the} about: {show:list}.\",\n  cannot_talk_to:\"{nv:char:chat:true} to {nm:item:the} for a few moments, before realizing that {pv:item:be} not about to reply.\",\n  no_topics:\"{nv:char:have:true} nothing to talk to {nm:item:the} about.\",\n  not_able_to_hear:\"Doubtful {nv:item:will} be interested in anything {sb:char} has to say.\",\n  npc_no_interest_in:\"{nv:char:have:true} no interest in that subject.\",\n  npc_dead:\"{nv:char:be:true} dead.\",\n\n\n  // BUTTON\n  press_button_successful:\"{nv:char:push:true} {nm:item:the}.\",\n\n  // SHIFTABLE\n  push_exit_successful:\"{nv:char:push:true} {nm:item:the} {show:dir}.\",\n  cannot_push:\"{pv:item:be:true} not something {nv:char:can} move around like that.\",\n  cannot_push_up:\"{pv:char:be:true} not getting {nm:item:the} up there!\",\n  take_not_push:\"Just pick the thing up already!\",\n\n\n  // ROPE\n  rope_examine_attached_both_ends:\" It is {item.attachedVerb} to both {nm:obj1:the} and {nm:obj2:the}.\",\n  rope_examine_attached_one_end:\" It is {item.attachedVerb} to {nm:obj1:the}.\",\n  rope_attach_verb:'tie',\n  rope_attached_verb:'tied',\n  rope_detach_verb:'untie',\n  rope_one_end:'One end',\n  rope_other_end:'The other end',\n  rope_examine_end_attached:'is {item.attachedVerb} to {nm:obj:the}.',\n  rope_examine_end_held:'is held by {nm:holder:the}.',\n  rope_examine_end_headed:'heads into {nm:loc:the}.',\n  rope_no_attachable_here:\"There is nothing here {nv:char:can} attach {nm:item:the} to.\",\n  rope_not_attachable_to:\"That is not something {nv:char:can} attach {nm:item:the} to.\",\n  rope_not_detachable:\"{nv:char:cannot:true} attach that to - or detach it from - anything.\",\n  rope_tied_both_ends_already:\"{pv:item:be:true} already attached to {nm:obj1:the} and {nm:obj12:the}.\",\n  rope_not_attachable:\"{nv:char:cannot:true} attach that to anything.\",\n  rope_not_attached:\"{nv:item:be:true} not {item.attachedVerb} to anything.\",\n  rope_detach_end_ambig:\"Which end of {nm:item:the} do you want to detach?\",\n  rope_not_attached_to:\"{nv:item:be:true} not attached to {nm:obj:the}.\",\n  rope_tethered:\"{nv:char:can:true} not detach {nm:item:the} from {nm:obj:the}.\",\n  rope_attach_success:\"{nv:char:attach:true} {nm:item:the} to {nm:obj:the}.\",\n  rope_detach_success:\"{nv:char:detach:true} {nm:item:the} from {nm:obj:the}.\",\n  rope_cannot_move:\"{nv:item:be:true} not long enough, {nv:char:cannot} go any further.\",\n  rope_wind:\"{nv:char:wind:true} in {nm:item:the}.\",\n  rope_unwind:\"{nv:item:unwind:true} behind {nm:char:the}.\",\n  rope_tied_both_end:\"It is tied to something.\",\n  rope_tied_one_end:\"It is tied up at this end.\",\n  rope_no_end:\"{nv:char:cannot:true} see either end of {nm:item:the}.\",\n\n\n  // TRANSIT\n  transit_already_here:\"{nv:char:press:true} the button; nothing happens.\",\n  transit_go_to_dest:\"{nv:char:press:true} the button; the door closes...\",\n\n  // Movement\n  go_successful:\"{nv:char:head:true} {show:dir}.\",\n  not_that_way:\"{nv:char:can't:true} go {show:dir}.\",\n  no_look_that_way:\"{nv:char:can't:true} see anything of interest {show:dir}.\",\n  default_look_exit:\"{nv:char:look:true} {show:dir}; definitely an exit that way.\",\n  can_go:\"{nv:char:think:true} {pv:char:can} go {exits}.\",\n  cannot_go_in:\"{pv:item:be:true} not something {nv:char:can} get inside.\",\n  cannot_go_out:\"{pv:item:be:true} not something from which {nv:char:can} go out.\",\n  cannot_go_up:\"{pv:item:be:true} not something {nv:char:can} go up.\",\n  cannot_go_down:\"{pv:item:be:true} not something {nv:char:can} go down.\",\n  cannot_go_through:\"{pv:item:be:true} not something {nv:char:can} get through.\",\n\n\n  // General cannot Messages\n  cannot_read:\"Nothing worth reading there.\",\n  cannot_use:\"No obvious way to use {ob:item}.\",\n  cannot_smash:\"{nv:item:be:true} not something {nv:char:can} break.\",\n  cannot_turn:\"{nv:item:be:true} not something {nv:char:can} turn.\",\n  cannot_look_out:\"Not something {nv:char:can} look out of.\",\n  cannot_smell:\"{nv:item:have:true} no smell.\",\n  cannot_listen:\"{nv:item:be:true} not making any noise.\",\n\n\n  // General command messages\n  not_known_msg:\"I don't even know where to begin with that.\",\n  disambig_msg:\"Which do you mean?\",\n  no_multiples_msg:\"You cannot use multiple objects with that command.\",\n  nothing_msg:\"Nothing there to do that with.\",\n  general_obj_error:\"So I kind of get what you want to do, but not what you want to do it with.\",\n  done_msg:\"{multi}Done.\",\n  nothing_for_sale:\"Nothing for sale here.\",\n  wait_msg:\"Time passes...\",\n  no_map:\"Sorry, no map available.\",\n  inventory_prefix:\"{nv:char:be:true} carrying\",\n  no_receiver:\"There's no one here to give things to.\",\n\n\n  // General command fails\n  no_smell:\"{pv:char:can't:true} smell anything here.\",\n  no_listen:\"{pv:char:can't:true} hear anything of note here.\",\n  nothing_there:\"{nv:char:be:true} sure there's nothing there.\",\n  nothing_inside:\"There's nothing to see inside.\",\n  not_open:\"You have to open it first.\",\n  it_is_empty:\"{pv:container:be:true} empty.\",\n  not_here:\"{pv:item:be:true} not here.\",\n  char_has_it:\"{multi}{nv:holder:have:true} {ob:item}.\",\n  none_here:\"There's no {nm:item} here.\",\n  none_held:\"{nv:char:have:true} no {nm:item}.\",\n  //none_here_countable:\"There's no {nm:item} here.\",\n  //none_held_countable:\"{nv:char:have:true} no {nm:item}.\",\n  nothing_useful:\"That's not going to do anything useful.\",\n  already:\"{sb:item:true} already {cj:item:be}.\",\n  default_examine:\"{pv:item:be:true} just your typical, every day {nm:item}.\",\n  not_enough:\"There {ifMoreThan:count:1:are:is} only {show:count} {nm:item}.\",\n  it_is_dark:\"It is dark.\",\n  abort_cmds:\"Abandoning later commands\",\n\n  error:\"Oh dear, I seem to have hit an error trying to handle that (F12 for more details).\",\n\n\n\n\n  //----------------------------------------------------------------------------------------------\n  // Complex responses (requiring functions)\n\n  // Used deep in the parser, so prefer to use function, rather than string\n  object_unknown_msg:function(name) {\n    return \"There doesn't seem to be anything you might call '\" + name + \"' here.\";\n  },\n\n\n  // For furniture\n  stop_posture:function(char) {\n    if (!char.posture) return \"\"\n    if (!char.postureFurniture && char.posture === \"standing\") return \"\"\n    const options = {char:char}\n    if (w[char.postureFurniture]) options.item = w[char.postureFurniture]\n    char.posture = false\n    char.postureFurniture = false\n    return processText(options.item ? \"{nv:char:get:true} off {nm:item:the}.\" : \"{nv:char:stand:true} up.\", options)\n  },\n\n\n\n  // use (or potentially use) different verbs in the responses, so not simple strings\n  say_no_one_here:\"{nv:char:say:true}, '{show:text},' but no one notices.\",\n  say_no_response: \"No one seems interested in what {nv:char:say}.\",\n  say_no_response_full: \"{nv:char:say:true}, '{show:text},' but no one seem interested.\",\n  say_something:\"{nv:char:say:true}, '{show:text}.'\",\n\n  // If the player does SPEAK TO MARY and Mary has some topics, this will be the menu title.\n  speak_to_menu_title:function(char) {\n    return \"Talk to \" + lang.getName(char, {article:DEFINITE}) + \" about:\";\n  },\n  // If the player does TELL MARY ABOUT HOUSE this will appear before the response.\n  tell_about_intro:function(char, text1, text2) {\n    return \"{nv:char:tell:true} \" + lang.getName(char, {article:DEFINITE}) + \" \" + text2 + \" \" + text1 + \".\";\n  },\n  // If the player does ASK MARY ABOUT HOUSE this will appear before the response.\n  ask_about_intro:function(char, text1, text2) {\n    return \"{nv:char:ask:true} \" + lang.getName(char, {article:DEFINITE}) + \" \" + text2 + \" \" + text1 + \".\";\n  },\n  // If the player does TALK TO MARY ABOUT HOUSE this will appear before the response.\n  talk_about_intro:function(char, text1, text2) {\n    return \"{nv:char:talk:true} to \" + lang.getName(char, {article:DEFINITE}) + \" \" + text2 + \" \" + text1 + \".\";\n  },\n\n\n\n\n  // Use when the NPC leaves a room; will give a message if the player can observe it\n  npc_leaving_msg:function(npc, exit) {\n    let flag = npc.inSight(exit.origin)\n    if (!flag) return\n    if (exit.npcLeaveMsg) { return exit.npcLeaveMsg(npc) }\n    let s = typeof flag === 'string' ? flag + \" {nv:npc:leave}\" : \"{nv:npc:leave:true}\"\n    s += \" {nm:room:the}, heading {show:dir}.\"\n    msg(s, {room:exit.origin, npc:npc, dir:exit.dir})\n  },\n\n  // the NPC has already been moved, so npc.loc is the destination\n  npc_entering_msg:function(npc, exit) {\n    let flag = npc.inSight(w[exit.name])\n    if (!flag) return\n    if (exit.npcEnterMsg) { return exit.npcEnterMsg(npc) }\n    let s = typeof flag === 'string' ? flag + \" {nv:npc:enter}\" : \"{nv:npc:enter:true}\"\n    s += \" {nm:room:the} from {show:dir}.\"\n    msg(s, {room:w[exit.name], npc:npc, dir:exit.reverseNice()})\n  },\n\n  //----------------------------------------------------------------------------------------------\n  // Meta-command responses\n\n\n  // Save/load messages\n\n  sl_dir_headings:['Filename', 'Game', 'Ver', 'Timestamp', 'Comment'],\n  sl_dir_msg:\"Ver is the version of the game that was being played when saved. Loading a save game from a different version may or may not work. You can delete a file with the DEL command. Type SAVE for general instructions on saving and loading.\",\n  sl_no_filename:\"Trying to save with no filename.\",\n  sl_saved:\"Saved file \\\"{filename}\\\" {if:toFile:to file:to LocalStorage}.\",\n  sl_already_exists:\"File already exists. To overwrite an existing file, use SAVE [filename] OVERWRITE or SAVE [filename] OW.\",\n  sl_file_not_found:\"Load failed: File not found.\",\n  sl_deleted:\"Deleted.\",\n  sl_file_loaded:\"Loaded file \\\"{filename}\\\"\",\n  sl_bad_format:\"Improperly formatted file. Looks like this might be for a game called \\\"{show:title}\\\"?\",\n\n\n  // Achievements\n\n  ach_none_yet:\"No achievements yet!\",\n  ach_list_intro:\"You got {if:count:1:this single, solitary achievement:these achievements}!\",\n  ach_list_item:\"{show:text} ({date:date})\",\n  ach_got_one:\"You got an achievement!|{show:text}\",\n\n\n  spoken_on:\"Game mode is now 'spoken'. Type INTRO to hear the introductory text.\",\n  spoken_off:\"Game mode is now 'unspoken'.\",\n  mode_brief:\"Game mode is now 'brief'; no room descriptions (except with LOOK).\",\n  mode_terse:\"Game mode is now 'terse'; room descriptions only shown on first entering and with LOOK.\",\n  mode_verbose:\"Game mode is now 'verbose'; room descriptions shown every time you enter a room.\",\n  mode_silent_on:\"Game is now in silent mode.\",\n  mode_silent_off:\"Silent mode off.\",\n  transcript_on:\"Transcript is now on.\",\n  transcript_off:\"Transcript is now off.\",\n  transcript_cleared:\"Transcript cleared.\",\n  transcript_none:\"Cannot show transcript, nothing has been recorded.\",\n  transcript_already_on:\"Transcript is already turned on.\",\n  transcript_already_off:\"Transcript is already turned off.\",\n  transcript_finish:\"To see the transcript, click {cmd:SCRIPT SHOW:here}.\",\n  finish_options:\"You might like to {cmd:UNFINISH THEN UNDO:UNDO} your last action, or {cmd:UNFINISH THEN RESTART:RESTART} (and perhaps load a saved game).\",\n  new_tab_failed:\"I am unable to create a new tab. This is probably because your browser is blocking me! There may be a banner across the top of the screen where you can give permission. You will need to do the command again.\",\n  undo_disabled:\"Sorry, UNDO is not enabled in this game.\",\n  undo_not_available:\"There are no saved game-states to UNDO back to.\",\n  undo_done:\"Undoing...\",\n  again_not_available:\"There are no previous commands to repeat.\",\n  scores_not_implemented:'Scores are not a part of this game.',\n  restart_are_you_sure:'Do you really want to restart the game? {b:[Y/N]}',\n  restart_no:'Restart cancelled',\n  yes_regex:/^(y|yes)$/i,\n\n\n\n\n  helloScript:function() {\n    metamsg(\"Hi!\")\n    metamsg(\"If you are wondering what to do, typing HELP will give you a quick guide at how to get going. In fact, we can do that now...\")\n    metamsg(\">HELP\")\n    wait()\n    return lang.helpScript()\n  },\n\n  helpScript:function() {\n    if (settings.textInput) {\n      metamsg(\"Type commands at the prompt to interact with the world.\");\n      metamsg(\"{b:Movement:} To move, use the eight compass directions (or just {class:help-eg:N}, {class:help-eg:NE}, etc.). When \\\"Num Lock\\\" is on, you can use the number pad for all eight compass directions. Also try - and + for {class:help-eg:UP} and {class:help-eg:DOWN}, / and * for {class:help-eg:IN} and {class:help-eg:OUT}.\");\n      metamsg(\"{b:Other commands:} You can also {class:help-eg:LOOK} (or just {class:help-eg:L} or 5 on the number pad), {class:help-eg:HELP} (or {class:help-eg:?}) or {class:help-eg:WAIT} (or {class:help-eg:Z} or the dot on the number pad). Other commands are generally of the form {class:help-eg:GET HAT} or {class:help-eg:PUT THE BLUE TEAPOT IN THE ANCIENT CHEST}. Experiment and see what you can do!\");\n      metamsg(\"{b:Using items: }You can use {class:help-eg:ALL} and {class:help-eg:ALL BUT} with some commands, for example {class:help-eg:TAKE ALL}, and {class:help-eg:PUT ALL BUT SWORD IN SACK}. You can also use pronouns, so {class:help-eg:LOOK AT MARY}, then {class:help-eg:TALK TO HER}. The pronoun will refer to the last subject in the last successful command, so after {class:help-eg:PUT HAT AND FUNNY STICK IN THE DRAWER}, '{class:help-eg:IT}' will refer to the funny stick (the hat and the stick are subjects of the sentence, the drawer was the object).\");\n      metamsg(\"{b:Characters: }If you come across another character, you can ask him or her to do something. Try things like {class:help-eg:MARY,PUT THE HAT IN THE BOX}, or {class:help-eg:TELL MARY TO GET ALL BUT THE KNIFE}. Depending on the game you may be able to {class:help-eg:TALK TO} a character, to {class:help-eg:ASK} or {class:help-eg:TELL} a character {class:help-eg:ABOUT} a topic, or just {class:help-eg:SAY} something and they will respond..\");\n      metamsg(\"{b:Meta-commands:} Type {class:help-eg:ABOUT} to find out about the author, {class:help-eg:SCRIPT} to learn about transcripts or {class:help-eg:SAVE} to learn about saving games. Use {class:help-eg:WARNINGS} to see any applicable sex, violence or trigger warnings.\")\n      let s = \"You can also use {class:help-eg:BRIEF/TERSE/VERBOSE} to control room descriptions. Use {class:help-eg:SILENT} to toggle sounds and music (if implemented).\"\n      if (typeof map !== \"undefined\") s += \" Use {class:help-eg:MAP} to toggle/show the map.\"\n      if (typeof imagePane !== \"undefined\") s += \" Use {class:help-eg:IMAGES} to toggle/show the image pane.\"\n      metamsg(s)\n      metamsg(\"{b:Accessibility:} Type {class:help-eg:DARK} to toggle dark mode or {class:help-eg:SPOKEN} to toggle the text being read out. Use {class:help-eg:FONT} to toggle replacing all the fonts the author carefully chose to a standard sans-serif font. Use {class:help-eg:SCROLL} to toggle whether the text automatically scrolling.\")\n      metamsg(\"{b:Mobile:} If you are on a mobile phone, type {class:help-eg:NARROW} to reduce the width of the text. Type it again to reduce it even more, and a third time to go back to standard width.\")\n      metamsg(\"{b:Shortcuts:} You can often just type the first few characters of an item's name and Quest will guess what you mean.  If fact, if you are in a room with Brian, who is holding a ball, and a box, Quest should be able to work out that {class:help-eg:B,PUT B IN B} mean you want Brian to put the ball in the box.\")\n      metamsg(\"You can use the up and down arrows to scroll back though your previous typed commands - especially useful if you realise you spelled something wrong. If you do not have arrow keys, use {class:help-eg:OOPS} to retrieve the last typed command so you can edit it. Use {class:help-eg:AGAIN} or just {class:help-eg:G} to repeat the last typed command.\")\n      metamsg(\"See also {link:here:https://github.com/ThePix/QuestJS/wiki/How-To-Play} for more details, which will open in a new tab.\")\n    }\n    if (settings.panes !== \"none\") {\n      if (settings.inventoryPane) {\n        metamsg(\"{b:User Interface:} To interact with an object, click on its name in the side pane, and a set of possible actions will appear under it. Click on the appropriate action.\")\n      }\n      if (settings.compassPane) {\n        if (settings.symbolsForCompass) {\n          metamsg(\"You can also use the compass rose at the top to move around. Click the eye symbol, &#128065;, to look at you current location, the clock symbol to wait or &#128712; for help.\")\n        }\n        else {\n          metamsg(\"You can also use the compass rose at the top to move around. Click 'Lk' to look at you current location, 'Z' to wait or '?' for help.\")\n        }\n      }\n      if (settings.collapsibleSidePanes) {\n        metamsg(\"You can click on the eye symbol by the pane titles to toggle them being visible. This may be useful if there is a lot there, and entries are disappearing off the bottom of your screen, though you may miss that something is here if you are not careful!\")\n      }\n    }\n    if (settings.additionalHelp !== undefined) {\n      for (const s of settings.additionalHelp) metamsg(s)\n    }\n    return world.SUCCESS_NO_TURNSCRIPTS\n  },\n\n  hintScript:function() {\n    metamsg(\"Sorry, no hints available.\")\n    return world.SUCCESS_NO_TURNSCRIPTS\n  },\n\n  aboutScript:function() {\n    metamsg(\"{i:{show:settings:title} version {show:settings:version}} was written by {show:settings:author} using QuestJS (Quest 6) version {show:settings:questVersion}.\", {settings:settings})\n    if (settings.ifdb) metamsg(\"IFDB number: \" + settings.ifdb)\n    if (settings.thanks && settings.thanks.length > 0) {\n      metamsg(\"{i:Thanks to:} \" + formatList(settings.thanks, {lastSep:lang.list_and}) + \".\")\n    }\n    if (settings.additionalAbout !== undefined) {\n      for (const key in settings.additionalAbout) metamsg('{i:' + key + ':} ' + settings.additionalAbout[key])\n    }\n    if (settings.ifid) metamsg(\"{i:IFDB number:} \" + settings.ifid)\n    return world.SUCCESS_NO_TURNSCRIPTS\n  },\n\n  warningsScript:function() {\n    switch (typeof settings.warnings) {\n      case 'undefined' : metamsg('No warning have been set for this game.'); break;\n      case 'string' : metamsg(settings.warnings); break;\n      default: for (const el of settings.warnings) metamsg(el)\n    }\n    return world.SUCCESS_NO_TURNSCRIPTS;\n  },\n\n  saveLoadScript:function() {\n    if (!settings.localStorageDisabled) {\n      metamsg(\"QuestJS offers players two ways to save your progress - to LocalStorage or to file.\")\n\n      metamsg(\"{b:Saving To LocalStorage}\")\n      metamsg(\"LocalStorage is a part of your computer the browser has set aside; this is the easier way to save.\")\n      metamsg(\"Note, however, that if you clear your browsing data (or have your browser set to do so automatically when the browser is closed) you will lose your saved games. There is also a limit to how much can be saved to LocalStorage, and if this is a big game, you may not be allowed to save to LocalStorage.\")\n      metamsg(\"To save your progress to LocalStorage, type {class:help-eg:SAVE [filename]}. By default, if you have already saved the game, you will not be permitted to save with the same filename, to prevent you accidentally saving when you meant to load. However, you can overwrite a file with the same name by using {class:help-eg:SAVE [filename] OVERWRITE} or just {class:help-eg:SAVE [filename] OW}.\");\n      metamsg(\"To load your game, refresh/reload this page in your browser, then type {class:help-eg:LOAD [filename]}.\");\n      metamsg(\"To see a list of all your QuestJS save games, type {class:help-eg:DIR} or {class:help-eg:LS}. You can delete a saved file with {class:help-eg:DELETE [filename]} or {class:help-eg:DEL [filename]}.\")\n\n      metamsg(\"{b:Saving To File}\")\n      metamsg(\"Alternatively you can save the game as a file on your computer. It is a little more hassle, but probably more reliable.\")\n    }\n    metamsg(\"To save your progress to file, type {class:help-eg:FSAVE [filename]}. The file will be saved to wherever downloaded files get saved on your computer. If there is already a file with that name, the browser will probably append a number to the name.\");\n    metamsg(\"To load your game, refresh/reload this page in your browser, then type {class:help-eg:FLOAD}. A dialog will open up, allowing you to navigate to the downloads folder and select your file.\")\n    metamsg(\"There is no built-in facility to list or delete games saved as files, though you can delete through your normal file manager.\")\n\n    return world.SUCCESS_NO_TURNSCRIPTS;\n  },\n\n\n  hintSheet:'Hint Sheet',\n  hintSheetIntro:\"To use this hint sheet, start to read through the list of questions to see if there is one dealing with the place where you're stuck in the game. To decode a hint, substitute the numbers in the hint for the numbered words in the 'dictionary' at the bottom of the hint sheet. <i>To get back to your game, just go to its tab.</i>\",\n  // linkHintInvisiClues:\"Hints can be found on {link:this page:\" + folder + \"/hints.html}, in the form of InvisiClues, so you can avoid seeing spoilers you do want to see. The page will open in a new tab, so will not affect your playing of the game.\",\n\n\n  transcriptScript:function() {\n    metamsg(\"The TRANSCRIPT or SCRIPT commands can be used to handle recording the input and output. This can be very useful when testing a game, as the author can go back through it and see exactly what happened, and how the user got there.\")\n    metamsg(\"Use SCRIPT ON to turn on recording and SCRIPT OFF to turn it off. To clear the stored data, use SCRIPT CLEAR. To clear the old data and turn recording on in one step, use SCRIPT START.\")\n    metamsg(\"Use SCRIPT SHOW to display it - it will appear in a new tab; you will not lose your place in the game. Some browsers (Firefox especially) may block the new tab, but will probably give the option to allow it in a banner at the top. You will probably need to do the command again.\")\n    metamsg(\"You can add a comment to the transcript by starting your text with an asterisk, {code:*}, or semi-colon, {code:;}, - Quest will record it, but otherwise just ignore it.\")\n    metamsg(\"Everything gets saved to \\\"LocalStorage\\\", so will be saved between sessions. If you complete the game the text input will disappear, however if you have a transcript recording, a link will be available to access it.\");\n    metamsg(\"Transcript is currently: \" + (io.transcript ? 'on' : 'off'))\n    return world.SUCCESS_NO_TURNSCRIPTS;\n  },\n\n  transcriptTitle:function() {\n    let html = ''\n    html += '<h2>QuestJS Transcript for \"'\n    html += settings.title + '\" (version ' + settings.version\n    html += ')</h2>'\n    html += '<p><a onclick=\"document.download()\" style=\"cursor:pointer;border:black solid 1px;border-radius:5px;background:silver;line-height:1em\">Click here</a> to save this file to your downloads folder as \"transcript.html\".</p>'\n    html += '<hr/>'\n    return html\n  },\n  transcriptStart:function() {\n    const now = new Date()\n    return '<p><i>Transcript started at ' + now.toLocaleTimeString() + ' on ' + now.toDateString() + '</i></p>'\n  },\n  transcriptEnd:function() {\n    const now = new Date()\n    return '<p><i>Transcript ended at ' + now.toLocaleTimeString() + ' on ' + now.toDateString() + '</i></p>'\n  },\n\n\n  topicsScript:function() {\n    metamsg(\"Use TOPICS FOR [name] to see a list of topic suggestions to ask a character about (if implemented in this game).\");\n    return world.SUCCESS_NO_TURNSCRIPTS;\n  },\n\n  betaTestIntro:function() {\n    metamsg(\"This version is for beta-testing (\" + settings.version + \"); the browser reports that it is running on: \" + navigator.userAgent)\n    if (settings.textInput) {\n      metamsg(\"A transcript will be automatically recorded. When you finish, do Ctrl-Enter or type SCRIPT SHOW to open the transcript in a new tab, or click the link if you reach the end of the game; it can then be saved (you should see a save button at the top) and attached to an e-mail. Alternatively, copy-and-pasted into an e-mail.\")\n      metamsg(\"You can add your own comments to the transcript by starting a command with *.\")\n    }\n    else {\n      metamsg(\"A transcript will be automatically recorded. As this game has no text input, you will need to access the transcript through the developer tools. Press F12 to show the tools, and click on the \\\"Console\\\" tab. Type <code>io.scriptShow()</code> and press return. the transcript should appear in a new tab.\")\n    }\n    metamsg(\"If you have not already done so, I recommend checking to ensure you can see the transcript before progressing too far though the game.\")\n    metamsg(\"PLEASE NOTE: Transcripts and save games are saved in LocalStorage; if you have this set to be deleted when you close your browser, you will lose all progress!\")\n    saveLoad.transcriptStart()\n  },\n\n  game_over_html:'<p>G<br/>A<br/>M<br/>E<br/>/<br/>O<br/>V<br/>E<br/>R</p>',\n\n\n\n\n  //----------------------------------------------------------------------------------------------\n  //  Language Data\n\n  // Misc\n\n  list_and:\"and\",\n  list_nothing:\"nothing\",\n  list_or:\"or\",\n  list_nowhere:\"nowhere\",\n  never_mind:\"Never mind.\",\n  default_description:\"It's just scenery.\",\n  click_to_continue:\"Click to continue...\",\n  buy:\"Buy\", // used in the command link in the purchase table\n  buy_headings:[\"Item\", \"Cost\", \"\"],\n  current_money:\"Current money\",\n  inside:\"inside\",\n  on_top:\"on top\",\n  carrying:\"carrying\",\n\n\n  command_split_regex:/\\.| then |, then |,then |, and then |,and then /i,  // case insenstive as used early\n  article_filter_regex:/^(?:the |an |a )?(.+)$/,\n  joiner_regex:/\\band\\b|\\, ?and\\b|\\,/,\n  all_regex:/^(all|everything)$/,\n  all_exclude_regex:/^((all|everything) (but|bar|except)\\b)/,\n  go_pre_regex:\"go to |goto |go |head |\",\n\n  yesNo:['Yes', 'No'],\n  tp_false:'false',\n  tp_true:'true',\n\n\n  // Use this to stop commands getting saved to the walkthrough - note the space at the end\n  noWalkthroughRegex:/^(script|transcript) /,\n\n\n  //----------------------------------------------------------------------------------------------\n  // Language constructs\n\n  pronouns:{\n    thirdperson:{subjective:\"it\", objective:\"it\", possessive: \"its\", possAdj: \"its\", reflexive:\"itself\"},\n    massnoun:{subjective:\"it\", objective:\"it\", possessive: \"its\", possAdj: \"its\", reflexive:\"itself\"},\n    male:{subjective:\"he\", objective:\"him\", possessive: \"his\", possAdj: \"his\", reflexive:\"himself\"},\n    female:{subjective:\"she\", objective:\"her\", possessive: \"hers\", possAdj: \"her\", reflexive:\"herself\"},\n    nonbinary:{subjective:\"they\", objective:\"them\", possessive: \"theirs\", possAdj: \"their\", reflexive:\"themselves\"},\n    plural:{subjective:\"they\", objective:\"them\", possessive: \"theirs\", possAdj: \"their\", reflexive:\"themselves\"},\n    firstperson:{subjective:\"I\", objective:\"me\", possessive: \"mine\", possAdj: \"my\", reflexive:\"myself\"},\n    secondperson:{subjective:\"you\", objective:\"you\", possessive: \"yours\", possAdj: \"your\", reflexive:\"yourself\"},\n  },\n\n\n  // Display verbs used in the side panel\n  verbs:{\n    examine:\"Examine\",\n    use:\"Use\",\n    take:\"Take\",\n    drop:\"Drop\",\n    open:\"Open\",\n    close:\"Close\",\n    switchon:\"Switch on\",\n    switchoff:\"Switch off\",\n    wear:\"Wear\",\n    remove:\"Remove\",\n    lookat:\"Look at\",\n    talkto:\"Talk to\",\n    eat:\"Eat\",\n    drink:\"Drink\",\n    read:\"Read\",\n    push:\"Push\",\n    equip:\"Equip\",\n    unequip:\"Unequip\",\n    attack:\"Attack\",\n    sitOn:\"Sit on\",\n    standOn:\"Stand on\",\n    reclineOn:\"Lie on\",\n    getOff:\"Get off\",\n    fill:\"Fill\",\n    empty:\"Empty\",\n    turn:\"Turn\",\n  },\n\n  // Flag the state of an item in a list\n  invModifiers:{\n    worn:\"worn\",\n    open:\"open\",\n    equipped:\"equipped\",\n    dead:\"dead\",\n  },\n\n\n  // Change the abbrev values to suit your game (or language)\n  // You may want to do that in settings, which is loaded first\n  exit_list:[\n    {name:'northwest', abbrev:'NW', niceDir:\"the northwest\", type:'compass', key:103, x:-1 ,y:1, z:0, opp:'southeast', symbol:'fa-arrow-left', rotate:45},\n    {name:'north', abbrev:'N', niceDir:\"the north\", type:'compass', key:104, x:0 ,y:1, z:0, opp:'south', symbol:'fa-arrow-up'},\n    {name:'northeast', abbrev:'NE', niceDir:\"the northeast\", type:'compass', key:105, x:1 ,y:1, z:0, opp:'southwest', symbol:'fa-arrow-up', rotate:45},\n    {name:'in', abbrev:'In', alt:'enter', niceDir:\"inside\", type:'inout', key:111, opp:'out', symbol:'fa-sign-in-alt'},\n    {name:'up', abbrev:'U', niceDir:\"above\", type:'vertical', key:109, x:0 ,y:0, z:1, opp:'down', symbol:'fa-arrow-up'},\n\n    {name:'west', abbrev:'W', niceDir:\"the west\", type:'compass', key:100, x:-1 ,y:0, z:0, opp:'east', symbol:'fa-arrow-left'},\n    {name:'Look', abbrev:'L', type:'nocmd', key:101, symbol:'fa-eye'},\n    {name:'east', abbrev:'E', niceDir:\"the east\", type:'compass', key:102, x:1 ,y:0, z:0, opp:'west', symbol:'fa-arrow-right'},\n    {name:'out', abbrev:'Out', alt:'exit|o|leave', niceDir:\"outside\", type:'inout', key:106,opp:'in', symbol:'fa-sign-out-alt'},\n    {name:'down', abbrev:'Dn', alt:'d', niceDir:\"below\", type:'vertical', key:107, x:0 ,y:0, z:-1, opp:'up', symbol:'fa-arrow-down'},\n\n    {name:'southwest', abbrev:'SW', niceDir:\"the southwest\", type:'compass', key:97, x:-1 ,y:-1, z:0, opp:'northeast', symbol:'fa-arrow-down', rotate:45},\n    {name:'south', abbrev:'S', niceDir:\"the south\", type:'compass', key:98, x:0 ,y:-1, z:0, opp:'north', symbol:'fa-arrow-down'},\n    {name:'southeast', abbrev:'SE', niceDir:\"the southeast\", type:'compass', key:99, x:1 ,y:-1, z:0, opp:'northwest', symbol:'fa-arrow-right', rotate:45},\n    {name:'Wait', abbrev:'Z', type:'nocmd', key:110, symbol:'fa-clock'},\n    {name:'Help', abbrev:'?', type:'nocmd', symbol:'fa-info'},\n  ],\n\n  numberUnits:\"zero;one;two;three;four;five;six;seven;eight;nine;ten;eleven;twelve;thirteen;fourteen;fifteen;sixteen;seventeen;eighteen;nineteen;twenty\".split(\";\"),\n  numberTens:\"twenty;thirty;forty;fifty;sixty;seventy;eighty;ninety\".split(\";\"),\n\n  ordinalReplacements:[\n    {regex:/one$/, replace:\"first\"},\n    {regex:/two$/, replace:\"second\"},\n    {regex:/three$/, replace:\"third\"},\n    {regex:/five$/, replace:\"fifth\"},\n    {regex:/eight$/, replace:\"eighth\"},\n    {regex:/nine$/, replace:\"ninth\"},\n    {regex:/twelve$/, replace:\"twelfth\"},\n    {regex:/y$/, replace:\"ieth\"},\n  ],\n\n\n\n  conjugations:{\n    i:[\n      { name:\"be\", value:\"am\"},\n      { name:\"'be\", value:\"'m\"},\n      { name:\"were\", value:\"was\"},  // Used in present tense for, eg \"I was going to do that\"\n    ],\n    you:[\n      { name:\"be\", value:\"are\"},\n      { name:\"'be\", value:\"'re\"},\n    ],\n    we:[\n      { name:\"be\", value:\"are\"},\n      { name:\"'be\", value:\"'re\"},\n    ],\n    they:[\n      { name:\"be\", value:\"are\"},\n      { name:\"'be\", value:\"'re\"},\n    ],\n    it:[\n      { name:\"be\", value:\"is\"},\n      { name:\"were\", value:\"was\"},\n      { name:\"have\", value:\"has\"},\n      { name:\"can\", value:\"can\"},\n      { name:\"will\", value:\"will\"},\n      { name:\"mould\", value:\"moulds\"},\n      { name:\"*ould\", value:\"ould\"},\n      { name:\"must\", value:\"must\"},\n      { name:\"don't\", value:\"doesn't\"},\n      { name:\"can't\", value:\"can't\"},\n      { name:\"won't\", value:\"won't\"},\n      { name:\"cannot\", value:\"cannot\"},\n      { name:\"@n't\", value:\"n't\"},\n      { name:\"'ve\", value:\"'s\"},\n      { name:\"'be\", value:\"'s\"},\n      { name:\"'ll\", value:\"'ll\"},\n      { name:\"*ay\", value:\"ays\"},\n      { name:\"*uy\", value:\"uys\"},\n      { name:\"*oy\", value:\"oys\"},\n      { name:\"*ey\", value:\"eys\"},\n      { name:\"*y\", value:\"ies\"},\n      { name:\"*ss\", value:\"sses\"},\n      { name:\"*s\", value:\"sses\"},\n      { name:\"*sh\", value:\"shes\"},\n      { name:\"*ch\", value:\"ches\"},\n      { name:\"*o\", value:\"oes\"},\n      { name:\"*x\", value:\"xes\"},\n      { name:\"*z\", value:\"zes\"},\n      { name:\"*\", value:\"s\"},\n    ],\n  },\n\n  contentsForData:{\n    surface:{prefix:'with ', suffix:' on it'},\n    container:{prefix:'containing ', suffix:''},\n  },\n\n\n  //----------------------------------------------------------------------------------------------\n  //                                   LANGUAGE FUNCTIONS\n\n//@DOC\n// ## Language Functions\n//@UNDOC\n\n\n  //@DOC\n  // Returns \"the \" if appropriate for this item.\n  // If the item has 'defArticle' it returns that; if it has a proper name, returns an empty string.\n  addDefiniteArticle:function(item, options) {\n    return lang.addArticle(item, DEFINITE, options)\n  },\n\n  //@DOC\n  // Returns \"a \" or \"an \" if appropriate for this item.\n  // If the item has 'indefArticle' it returns that; if it has a proper name, returns an empty string.\n  // If it starts with a vowel, it returns \"an \", otherwise \"a \".\n  addIndefiniteArticle:function(item, options) {\n    return lang.addArticle(item, INDEFINITE, options)\n  },\n\n  addArticle:function(item, type, options = {}){\n    if (type === 'the') type = DEFINITE\n    if (type === 'a') type = INDEFINITE\n    if (!type || (type !== DEFINITE && type !== INDEFINITE)) return\n\n    // owned, so handle differently\n    // test if player exists yet in case this is used during item creation\n    if (player() && item.owner === player().name) return player().pronouns.possAdj + \" \"\n    if (typeof options.possAdj === 'string') {\n      if (!w[options.possAdj]) {\n        throw \"Oh dear... I am looking to create a possessive in lang.addArticle (probably from lang.getName or formatList), and I cannot find \" + options.possAdj + \". This will not end well.\"\n      }\n      options.possAdj = w[options.possAdj]\n    }\n    if (options.possAdj === true) {\n      options.possAdj = item.owner ? w[item.owner] : undefined\n    }\n    if (item.owner && options.possAdj && options.possAdj === w[item.owner]) {\n      return options.possAdj.pronouns.possAdj + \" \"\n    }\n    // If ignorePossessive is true, just skip this\n    // If it is 'noLink',\n    if (item.owner && options.ignorePossessive !== true) {\n      const suboptions = {\n        possessive:true,\n        noLink:options.ignorePossessive === 'noLink'\n      }\n      return lang.getName(w[item.owner], suboptions) + \" \"\n    }\n\n    // handle \"the\"\n    if (type === DEFINITE) {\n      if (item.defArticle) return item.defArticle + \" \"\n      return item.properNoun ? \"\" : \"the \"\n    }\n\n    // handle \"a\"\n    if (item.indefArticle) return item.indefArticle + \" \"\n    if (item.properNoun) return \"\"\n    if (item.pronouns === lang.pronouns.plural) return \"some \"\n    if (item.pronouns === lang.pronouns.massnoun) return \"some \"\n    if (/^[aeiou]/i.test(item.alias)) return \"an \"\n    return \"a \"\n  },\n\n  getName:function(item, options) {\n    if (!options) options = {}\n    if (!item.alias) item.alias = item.name\n    let s = ''\n    // The count needs to be an item specific attribute because there could be several items in a list\n    // and we need to be clear which item the count belongs to\n    let count = options[item.name + '_count'] ? options[item.name + '_count'] : false\n    // Or we can set count_this to an attribute, and use that to get the number\n    // processText(\"Mandy watches as {nv:item:grow:false:count_this}.\", {item:w.grown_tamarind_tree, count_this:'seedsPlanted'})\n    if (options.count_this) count = item[options.count_this]\n    // Or use suppressCount if we do not want the number, but do want it plural when it should\n    if (!count && options.suppressCount) count = item[options.suppressCount]\n\n    // Or if this is a countable, and loc is set, get the count from that location\n    if (!count && options.loc && item.countable) count = item.countAtLoc(options.loc)\n\n    if (item.getDisplayName) {\n      options.count = count\n      s = item.getDisplayName(options)\n    }\n\n    else if (item.pronouns === lang.pronouns.firstperson || item.pronouns === lang.pronouns.secondperson) {\n      s = options.possessive ? item.pronouns.possAdj : item.pronouns.subjective;\n    }\n\n    else {\n      if (count === 'infinity') {\n        s += item.infinity ? item.infinity + ' ' : 'a lot of '\n      }\n      else if (options.article === DEFINITE && options.suppressCount) {\n        s += lang.addDefiniteArticle(item)\n      }\n      else if (!options.suppressCount && count && count > 1) {\n        s += lang.toWords(count) + ' '\n      }\n      else if (options.article === DEFINITE) {\n        s += lang.addDefiniteArticle(item)\n      }\n      else if (options.article === INDEFINITE) {\n        s += lang.addIndefiniteArticle(item, options)\n      }\n      else if (options.article === COUNT) {\n        s += 'one '\n      }\n      if (item.getAdjective) {\n        s += item.getAdjective()\n      }\n      if (!count || count === 1) {\n        s += (options.enhanced && item.enhancedAlias ? item.enhancedAlias : item.alias)\n      }\n      else {\n        s += item.pluralAlias\n      }\n      if (options.possessive) {\n        if (s.endsWith('s')) {\n          s += \"'\"\n        }\n        else {\n          s += \"'s\"\n        }\n      }\n    }\n    if (options.capital) s = sentenceCase(s)\n    if (settings.nameTransformer) s = settings.nameTransformer(s, item, options)\n    s += util.getNameModifiers(item, options)\n    return s\n  },\n\n\n  //@DOC\n  // Returns the given number in words, so 19 would be returned as 'nineteen'.\n  // Numbers uner -2000 and over 2000 are returned as a string of digits,\n  // so 2001 is returned as '2001'.\n  toWordsMax:10000,\n  toWordsMillions:['', ' thousand', ' million', ' billion', ' trillion', ' quadrillion', ' quintillion', ' sextillion', 's eptillion', ' octillion', ' nonillion', ' decillion', ' undecillion', ' duodecillion'],\n\n  toWords:function(number, noun) {\n    if (typeof number !== \"number\") return errormsg (\"toWords can only handle numbers\")\n    number = Math.round(number)\n    //if (number < -lang.toWordsMax || number > lang.toWordsMax) return number.toString()\n\n    let negative = false\n    if (number === 0) return noun ? 'zero ' + lang.getPlural(noun) : 'zero'\n    if (number < 0) {\n      negative = true\n      number = -number;\n    }\n\n    const parts = rChunkString(number, 3)\n    let count = 0\n    //let commaFlag = false\n    const result = []\n\n    while (parts.length) {\n      const bit = lang._toWords1000(parts.pop())\n      if (bit !== 'zero') {\n        result.unshift(bit + lang.toWordsMillions[count])\n      }\n      count++\n    }\n    let s = formatList(result, {lastJoiner:'and', doNotSort:true})\n    const md = s.match(/ and /g)\n    if (md && md.length > 1) {\n      const pos = s.lastIndexOf(' and ')\n      s = s.substring(0, pos) + ',' + s.substring(pos)\n    }\n\n\n    if (negative) s = 'minus ' + s\n    if (!noun) return s\n    return s + ' ' + (number === 1 ? noun : lang.getPlural(noun))\n  },\n\n  // For internal use, handles integers from 1 to 999 only\n  _toWords1000:function(number) {\n    let s = ''\n    let hundreds = Math.floor(number / 100);\n    number = number % 100;\n    if (hundreds > 0) {\n      s = s + lang.numberUnits[hundreds] + \" hundred\";\n      if (number > 0) {\n        s = s + \" and \";\n      }\n    }\n\n    if (number < 20) {\n      if (number !== 0 || s === \"\") {\n        s = s + lang.numberUnits[number];\n      }\n    }\n    else {\n      let units = number % 10;\n      let tens = Math.floor(number / 10) % 10;\n      s = s + lang.numberTens[tens - 2];\n      if (units !== 0) {\n        s = s + '-' + lang.numberUnits[units];\n      }\n    }\n    return (s);\n  },\n\n  //@DOC\n  // Returns the given number in words, as is conventionally said for a year,\n  // so 1924 with return \"nineteen twenty-three\".\n  // Throws an error if not a number and rounds to the nearest whole number.\n  // Does not properly handle zero - there was no year zero\n  toYear:function(number) {\n    if (typeof number !== \"number\") {\n      errormsg (\"toYear can only handle numbers\");\n      return number;\n    }\n    number = Math.round(number)\n    let s = \"\"\n    let negative = false\n    if (number < 0) {\n      negative = true\n      number = -number;\n    }\n    if (number < 10000) {\n      let hundreds = Math.floor(number / 100);\n      log(hundreds)\n      number = number % 100;\n      if (hundreds > 0) {\n        s += lang.numberUnits[hundreds]\n        if (number > 0) {\n          s += \" \"\n        }\n      }\n      log(s)\n\n      if (number < 20) {\n        if (number !== 0 || s === \"\") {\n          s = s + lang.numberUnits[number];\n        }\n      }\n      else {\n        let units = number % 10;\n        let tens = Math.floor(number / 10) % 10;\n        s = s + lang.numberTens[tens - 2];\n        if (units !== 0) {\n          s = s + '-' + lang.numberUnits[units];\n        }\n      }\n    }\n    else {\n      s = number.toString();\n    }\n    if (negative) s+= ' BCE'\n    return (s);\n  },\n\n\n\n  //@DOC\n  // Returns the given number in words as the ordinal, so 19 would be returned as 'nineteenth'.\n  // Numbers uner -2000 and over 2000 are returned as a string of digits with 'th' appended,\n  // so 2001 is returned as '2001th'.\n  toOrdinal:function(number) {\n    if (typeof number !== \"number\") {\n      errormsg (\"toOrdinal can only handle numbers\");\n      return number;\n    }\n\n    let s = lang.toWords(number);\n    for (let or of lang.ordinalReplacements) {\n      if (or.regex.test(s)) {\n        return s.replace(or.regex, or.replace);\n      }\n    }\n    return (s + \"th\");\n  },\n\n  convertNumbers:function(s) {\n    for (let i = 0; i < lang.numberUnits.length; i++) {\n      let regex = new RegExp(\"\\\\b\" + lang.numberUnits[i] + \"\\\\b\");\n      if (regex.test(s)) s = s.replace(regex, \"\" + i);\n    }\n    return s;\n  },\n\n  getPlural:function(s) {\n    if (s.match(/o$/)) return s + 'es'\n    if (s.match(/on$/)) return s + 'a'\n    if (s.match(/us$/)) return s.replace(/us$/, 'i')\n    if (s.match(/um$/)) return s.replace(/um$/, 'a')\n    if (s.match(/[aeiou]y$/)) return s + 's'\n    if (s.match(/y$/)) return s.replace(/y$/, 'ies')\n    if (s.match(/sis$/)) return s.replace(/sis$/, 'ses')\n    if (s.match(/(s|ss|sh|ch|z|x)$/)) return s + 'es'\n    return s + 's'\n  },\n\n\n\n\n\n\n\n\n\n\n\n\n\n  // Conjugating\n\n\n\n\n  //@DOC\n  // Returns the verb properly conjugated for the item, so \"go\" with a ball would return\n  // \"goes\", but \"go\" with the player (if using second person pronouns).\n  conjugate:function(item, verb, options = {}) {\n    let gender = item.pronouns.subjective;\n    if (gender === \"he\" || gender === \"she\") { gender = \"it\"; }\n    const arr = lang.conjugations[gender.toLowerCase()];\n\n    if (!arr) {\n      errormsg(\"No conjugations found: conjugations_\" + gender.toLowerCase());\n      return verb;\n    }\n    for (let conj of arr) {\n      if (conj.name === verb) {\n        return conj.value;\n      }\n    }\n\n    for (let conj of arr) {\n      const name = conj.name;\n      const value = conj.value;\n      if (name.startsWith(\"@\") && verb.endsWith(name.substring(1))) {\n        return lang.conjugate (item, verb.substring(0, verb.length - name.length + 1)) + value;\n      }\n      else if (name.startsWith(\"*\") && verb.endsWith(name.substring(1))) {\n          // #todo - Why this comma expression in return?\n        // noinspection CommaExpressionJS\n          return item, verb.substring(0, verb.length - name.length + 1) + value;\n      }\n    }\n    return options.capitalise ? sentenceCase(verb) : verb\n  },\n\n\n\n  //@DOC\n  // Returns the pronoun for the item, followed by the conjugated verb,\n  // so \"go\" with a ball would return \"it goes\", but \"go\" with the player (if using second person pronouns)\n  // would return \"you go\".\n  // The first letter is capitalised if 'capitalise' is true.\n  pronounVerb:function(item, verb, options) {\n    let s = item.pronouns.subjective + \" \" + lang.conjugate (item, verb);\n    s = s.replace(/ +\\'/, \"'\");  // yes this is a hack!\n    return options.capitalise ? sentenceCase(s) : s;\n  },\n\n  pronounVerbForGroup:function(item, verb, options) {\n    let s = item.groupPronouns().subjective + \" \" + lang.conjugate (item.group(), verb);\n    s = s.replace(/ +\\'/, \"'\");  // yes this is a hack!\n    return options.capitalise ? sentenceCase(s) : s;\n  },\n\n  verbPronoun:function(item, verb, options) {\n    let s = lang.conjugate (item, verb) + \" \" + item.pronouns.subjective;\n    s = s.replace(/ +\\'/, \"'\");  // yes this is a hack!\n    return options.capitalise ? sentenceCase(s) : s;\n  },\n\n  //@DOC\n  // Returns the name for the item, followed by the conjugated verb,\n  // so \"go\" with a ball would return \"the ball goes\", but \"go\" with\n  // a some bees would return \"the bees go\". For the player, (if using second person pronouns)\n  // would return the pronoun \"you go\".\n  // The first letter is capitalised if 'capitalise' is true.\n  nounVerb:function(item, verb, options) {\n    if (item === player() && !player().useproperNoun) {\n      return lang.pronounVerb(item, verb, options);\n    }\n    if (options.article === undefined) options.article = DEFINITE\n    let s = lang.getName(item, options) + \" \" + lang.conjugate (item, verb);\n    s = s.replace(/ +\\'/, \"'\");  // yes this is a hack!\n    return options.capitalise ? sentenceCase(s) : s;\n  },\n\n  verbNoun:function(item, verb, options) {\n    if (item === player()) {\n      return lang.pronounVerb(item, verb, options);\n    }\n    if (options.article === undefined) options.article = DEFINITE\n    let s = lang.conjugate (item, verb) + \" \" + lang.getName(item, options);\n    s = s.replace(/ +\\'/, \"'\");  // yes this is a hack!\n    return options.capitalise ? sentenceCase(s) : s;\n  },\n\n}\n\nlang.createVerb = function(name, options = {}) {\n  if (options.words === undefined) options.words = name.toLowerCase()\n  if (options.ing === undefined) options.ing = name + 'ing'\n  if (options.defmsg === undefined) options.defmsg = options.ing + \" {nm:item:the} is not going to achieve much.\"\n  if (options.defmsg === true) options.defmsg = \"{pv:item:'be:true} not something you can do that with.\"\n  new Cmd(name, {\n    regex:new RegExp(\"^(?:\" + options.words + \") (.+)$\"),\n    objects:[\n      {scope:options.held ? parser.isHeld : parser.isHere},\n    ],\n    npcCmd:true,\n    defmsg:options.defmsg\n  })\n}\n\nlang.createVerbWith = function(name, options = {}) {\n  if (options.words === undefined) options.words = name.toLowerCase()\n  if (options.ing === undefined) options.ing = name + 'ing'\n  if (options.defmsg === undefined) options.defmsg = options.ing + \" {nm:item:the} is not going to achieve much.\"\n  if (options.defmsg === true) options.defmsg = \"{pv:item:'be:true} not something you can do that with.\"\n  new Cmd(name + \"With\", {\n    regexes:[\n      new RegExp(\"^(?:\" + options.words + \") (.+) (?:using|with) (.+)$\"),\n      { regex:new RegExp(\"^(?:use|with|using) (.+) to (?:\" + options.words + \") (.+)$\"), mod:{reverse:true}},\n      { regex:new RegExp(\"^(?:use|with|using) (.+) (?:\" + options.words + \") (.+)$\"), mod:{reverse:true}},\n    ],\n    objects:[\n      {scope:options.held ? parser.isHeld : parser.isHere},\n      {scope:parser.isHeld},\n    ],\n    attName:name.toLowerCase(),\n    npcCmd:true,\n    withScript:true,\n    defmsg:options.defmsg\n  })\n}\n\nlang.questions = [\n  { q:'who am i', script:function() { parser.parse('look me'); return world.SUCCESS_NO_TURNSCRIPTS }},\n  { q:'who are (?:u|you)', script:function() { metamsg('Me? I am the parser. I am going to try to understand your commands, and then hopefully the protagonist will act on them in the game world.'); return world.SUCCESS_NO_TURNSCRIPTS }},\n  { q:'who is (?:|the )(?:player|protagonist)', script:function() { metamsg('The protagonist is a character in the game world, but a special one - one that you control directly. He or she is your proxy, acting on your behalf, so if you want to know what he or she is like, try WHO AM I?.'); return world.SUCCESS_NO_TURNSCRIPTS }},\n  { q:'what am i', script:function() { parser.parse('look me'); return world.SUCCESS_NO_TURNSCRIPTS }},\n  { q:'what (?:(?:have i got|do i have)(?:| on me| with me)|am i (?:carry|hold)ing)', script:function() { parser.parse('inv'); return world.SUCCESS_NO_TURNSCRIPTS }},\n  { q:'where am i', script:function() { parser.parse('look'); return world.SUCCESS_NO_TURNSCRIPTS }},\n  { q:'what do i do', script:function() { parser.parse('help'); return world.SUCCESS_NO_TURNSCRIPTS }},\n  { q:'(?:what do i do now|where do i go)', script:function() { parser.parse('hint'); return world.SUCCESS_NO_TURNSCRIPTS }},\n]\n","// noinspection JSDeprecatedSymbols,RegExpSimplifiable\n\n/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nconst _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  let xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  let xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    let evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nconst isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nexport const saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    let URL = _global.URL || _global.webkitURL\n    let a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        let a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      // noinspection JSUnresolvedFunction\n        navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    let force = blob.type === 'application/octet-stream'\n    // noinspection JSCheckFunctionSignatures\n                  let isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    let isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      let reader = new FileReader()\n      reader.onloadend = function () {\n        let url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) { // noinspection JSPrimitiveTypeWrapperUsage\n            popup.location.href = url\n        }\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      let URL = _global.URL || _global.webkitURL\n      let url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs;\n","// noinspection JSDeprecatedSymbols\n\n\"use strict\";\n\nimport {\n    _msg, metamsg, clearScreen, cloneObject, endTurnUI, errormsg, Exit,\n    game, io, lang, saveAs, settings, tp, util, world\n} from '../index.js';\n\n// Should all be language neutral\n\n\n/*\n\nThe game state is saved as a name-value pair.\n\nThe value is the game state, with each segment separated by an exclamation mark. The first four segments are the header, the rest are the body. The header consists of the title, version, comment and timestamp. Each segment of the body is an object in the game.\n\nAn object is saved as its name followed by an equals sign followed by either \"Object\" or by \"Clone:\" and the name of the clone's prototype, followed by an equals sign, and then the data. Each datam is separated by a semi-colon. Each datum consists of the name, the type and the value, separated by colons.\n\nIf a datum is an object, and has a name attribute, the name is saved as type qobject.\n\nIf the datam is an array and the first element is a string, it is assumed that all the elements are strings, and it is saved as an array. Other arrays are not saved.\n\nIf the datam is a number, a string or true it is saved as such.\n\nAny other objects or values will not be saved.\n\n\n*/\n\n\nexport const saveLoad = {\n\n  getName:function(filename) {\n    return \"QJS:\" + settings.title + \":\" + filename\n  },\n\n  saveGame:function(filename, overwrite) {\n    if (filename === undefined) {\n      errormsg(lang.sl_no_filename);\n      return false;\n    }\n\n    if (localStorage.getItem(this.getName(filename)) && !overwrite) {\n      metamsg(lang.sl_already_exists)\n      return\n    }\n    const comment = settings.saveComment ? settings.saveComment() : \"-\"\n    const s = saveLoad.saveTheWorld(comment)\n    //console.log(s)\n    localStorage.setItem(this.getName(filename), s)\n    metamsg(lang.sl_saved, {filename:filename, toFile:false})\n    if (settings.afterSave) settings.afterSave(filename)\n    return true;\n  },\n\n  saveGameAsFile:function(filename) {\n    const comment = settings.saveComment ? settings.saveComment() : \"-\"\n    const s = saveLoad.saveTheWorld(comment)\n    const myFile = new File([s], filename+\".q6save\", {type: \"text/plain;charset=utf-8\"})\n    saveAs(myFile)\n    metamsg(lang.sl_saved, {filename:filename, toFile:true})\n    if (settings.afterSave) settings.afterSave(filename, true)\n    return true\n  },\n\n  saveTheWorld:function(comment) {\n    return saveLoad.getSaveHeader(comment) + saveLoad.getSaveBody();\n  },\n\n  getHeader:function(s) {\n    const arr = s.split(\"!\");\n    return { title:saveLoad.decodeString(arr[0]), version:saveLoad.decodeString(arr[1]), comment:saveLoad.decodeString(arr[2]), timestamp:arr[3] };\n  },\n\n  getSaveHeader:function(comment) {\n    const currentdate = new Date();\n    let s = saveLoad.encodeString(settings.title) + \"!\";\n    s += saveLoad.encodeString(settings.version) + \"!\";\n    s += saveLoad.encodeString(comment) + \"!\";\n    s += currentdate.toLocaleString() + \"!\";\n    return s;\n  },\n\n  getSaveBody:function() {\n    const l = [tp.getSaveString(), game.getSaveString(), util.getChangeListenersSaveString()]\n    for (let key in w) {\n      l.push(key + \"=\" + w[key].getSaveString())\n    }\n    return l.join(\"!\")\n  },\n\n\n\n\n\n  // LOAD\n\n  // This function will be attached to #fileDialog as its \"onchange\" event\n  loadGameAsFile:function() {\n\t\tconst fileInput = document.querySelector(\"#fileDialog\")\n\t\tconst fileIn = fileInput.files\n\n\t\tconst reader = new FileReader()\n\t\treader.readAsText(fileIn[0])\n\t\treader.onload = function(){\n\t\t\tsaveLoad.loadGame(fileIn[0].name, reader.result)\n\t\t\tconst el = document.querySelector(\"#fileDialogForm\")\n\t\t\tel.reset()\n\t\t}\n\t\treader.onerror = function(){\n\t\t\tlog(reader.error)\n\t\t}\n  },\n\n  loadGameFromLS:function(filename) {\n    //log(\">\" + filename + \"<\")\n    const contents = localStorage.getItem(this.getName(filename));\n    this.loadGame(filename, contents)\n  },\n\n  loadGame:function(filename, contents) {\n    if (!contents) {\n      metamsg(lang.sl_file_not_found);\n    }\n    else if (!contents.startsWith(settings.title + '!')) {\n      const encodedTitle = contents.substr(0, contents.indexOf('!'));\n      metamsg(lang.sl_bad_format, {title:saveLoad.decodeString(encodedTitle)})\n    }\n    else {\n      saveLoad.loadTheWorld(contents, 4)\n      clearScreen()\n      metamsg(lang.sl_file_loaded, {filename:filename})\n      if (settings.afterLoad) settings.afterLoad(filename)\n      loc().description()\n    }\n  },\n\n\n\n  loadTheWorld:function(s, removeHeader) {\n    const arr = s.split(\"!\");\n    if (removeHeader !== undefined) {\n      arr.splice(0, removeHeader);\n    }\n\n    // Eliminate all clones\n    for (let key in w) {\n      if (w[key].clonePrototype) delete w[key]\n    }\n\n    tp.setLoadString(arr.shift())\n    game.setLoadString(arr.shift())\n    util.setChangeListenersLoadString(arr.shift())\n    for (let el of arr) {\n      this.setLoadString(el);\n    }\n    world.update()\n    endTurnUI(true)\n  },\n\n\n\n  setLoadString:function(s) {\n    const parts = s.split(\"=\");\n    if (parts.length !== 3) {\n      errormsg(\"Bad format in saved data (\" + s + \")\");\n      return;\n    }\n    const name = parts[0];\n    const saveType = parts[1]\n    const arr = parts[2].split(\";\");\n\n    if (saveType.startsWith(\"Clone\")) {\n      const clonePrototype = saveType.split(\":\")[1];\n      if (!w[clonePrototype]) {\n        errormsg(\"Cannot find prototype '\" + clonePrototype + \"'\");\n        return;\n      }\n      const obj = cloneObject(w[clonePrototype]);\n      this.setFromArray(obj, arr);\n      w[obj.name] = obj;\n      obj.afterLoadForTemplate();\n      return\n    }\n\n    if (saveType === \"Object\") {\n      if (!w[name]) {\n        errormsg(\"Cannot find object '\" + name + \"'\");\n        return;\n      }\n      const obj = w[name];\n      this.setFromArray(obj, arr);\n      obj.afterLoadForTemplate();\n      return\n    }\n\n    // todo - wtf hash??\n    errormsg(\"Unknown save type for object '\" + name + \"' (\" + hash.saveType + \")\");\n  },\n\n\n\n\n\n  // UTILs\n\n  decode:function(hash, str) {\n    if (str.length === 0) return false\n    const parts = str.split(\":\")\n    const key = parts[0]\n    const attType = parts[1]\n    const s = parts[2]\n\n    if (attType === \"boolean\") {\n      hash[key] = (s === \"true\")\n    }\n\n    else if (attType === \"number\") {\n      hash[key] = parseFloat(s)\n    }\n\n    else if (attType === \"string\") {\n      hash[key] = saveLoad.decodeString(s)\n    }\n\n    else if (attType === \"array\") {\n      hash[key] = saveLoad.decodeArray(s)\n    }\n\n    else if (attType === \"numberarray\") {\n      hash[key] = saveLoad.decodeNumberArray(s)\n    }\n\n    else if (attType === \"emptyarray\") {\n      hash[key] = []\n    }\n\n    else if (attType === \"emptystring\") {\n      hash[key] = ''\n    }\n\n    else if (attType === \"qobject\") {\n      // this will cause an issue if it points to a clone that has not been done yet !!!\n      hash[key] = w[s]\n    }\n\n    return key\n  },\n\n  encode:function(key, value) {\n    if (value === 0) return key + \":number:0;\"\n    if (value === false) return key + \":boolean:false;\"\n    if (value === '') return key + \":emptystring;\"\n    if (!value) return ''\n    let attType = typeof value;\n    if (Array.isArray(value)) {\n      try {\n        if (value.length === 0) return key + \":emptyarray;\";\n        if (typeof value[0] === 'string') return key + \":array:\" + saveLoad.encodeArray(value) + \";\";\n        if (typeof value[0] === 'number') return key + \":numberarray:\" + saveLoad.encodeNumberArray(value) + \";\";\n        return '';\n      } catch (error) {\n        // Add the name of the attribute to the error message\n        //console.trace()\n        log(value)\n        throw \"Error encountered with attribute \\\"\" + key + \"\\\": \" + error + \". More here: https://github.com/ThePix/QuestJS/wiki/Save-Load#save-errors\"\n      }\n    }\n    if (value instanceof Exit) {\n      return '';\n    }\n    if (attType === \"object\") {\n      if (value.name) return key + \":qobject:\" + value.name + \";\";\n      return '';\n    }\n    if (attType === \"string\") {\n      return key + \":string:\" + saveLoad.encodeString(value) + \";\";\n    }\n    return key + \":\" + attType + \":\" + value + \";\";\n  },\n\n\n  replacements:[\n    { unescaped:':', escaped:'cln'},\n    { unescaped:';', escaped:'scln'},\n    { unescaped:'!', escaped:'exm'},\n    { unescaped:'=', escaped:'eqs'},\n    { unescaped:'~', escaped:'tld'},\n  ],\n\n\n  encodeString:function(s) {\n    for (let d of saveLoad.replacements) {\n      if (typeof s !== 'string') throw \"Found type \\\"\" + (typeof s) + \"\\\" in array - should be only strings.\"\n      s = s.replace(new RegExp(d.unescaped, \"g\"), \"@@@\" + d.escaped + \"@@@\");\n    }\n    return s;\n  },\n\n  decodeString:function(s) {\n    //if (typeof s !== 'string') {\n    //  console.log(\"Expecting a string there, but found this instead (did you add an object to a list rather than its name?):\")\n    //  console.log(s)\n    ///}\n    for (let d of saveLoad.replacements) {\n      s = s.replace(new RegExp(\"@@@\" + d.escaped + \"@@@\", \"g\"), d.unescaped);\n    }\n    return s;\n  },\n\n  encodeArray:function(ary) {\n    return ary.map(el => saveLoad.encodeString(el)).join('~');\n  },\n\n  decodeArray:function(s) {\n    return s.split('~').map(el => saveLoad.decodeString(el));\n  },\n\n  encodeNumberArray:function(ary) {\n    return ary.map(el => {\n      if (typeof el !== 'number') throw \"Found type \\\"\" + (typeof el) + \"\\\" in array - should be only numbers.\"\n      return el.toString()\n    }).join('~');\n  },\n\n  decodeNumberArray:function(s) {\n    return s.split('~').map(el => parseFloat(el));\n  },\n\n  decodeExit:function(s) {\n    return s.split('~').map(el => saveLoad.decodeString(el));\n  },\n\n\n  lsTest:function() {\n    const test = 'test';\n    try {\n        localStorage.setItem(test, test);\n        localStorage.removeItem(test);\n        return true;\n    } catch(e) {\n        return false;\n    }\n  },\n\n\n\n\n  // Other functions\n\n  deleteGame:function(filename) {\n    localStorage.removeItem(this.getName(filename));\n    metamsg(lang.sl_deleted);\n  },\n\n  dirGame:function() {\n    const arr0 = lang.sl_dir_headings.map(el => '<th>' + el + '</th>')\n    if (!settings.saveComment) arr0.pop()\n    let s = arr0.join('')\n    for (let key in localStorage) {\n      if (!key.startsWith('QJS:')) continue\n      const arr1 = key.split(':')\n      const arr2 = localStorage[key].split('!')\n      log(arr2.slice(1, 4))\n      s += \"<tr>\"\n      s += \"<td>\" + arr1[2] + \"</td>\"\n      s += \"<td>\" + arr1[1] + \"</td>\"\n      s += \"<td>\" + arr2[1] + \"</td>\"\n      s += \"<td>\" + arr2[3] + \"</td>\"\n      if (settings.saveComment) s += \"<td>\" + arr2[2] + \"</td>\"\n      s += \"</tr>\"\n    }\n    _msg(s, {}, {cssClass:\"meta\", tag:'table'})\n    metamsg(lang.sl_dir_msg)\n  },\n\n  testExistsGame:function(filename) {\n    const data = localStorage[this.getName(filename)]\n    return data !== undefined\n  },\n\n  getSummary:function(filename) {\n    const data = localStorage[this.getName(filename)]\n    if (!data) return null\n    const arr = data.split('!')\n    return arr.slice(1, 4)\n  },\n\n  setFromArray:function(obj, arr) {\n    const keys = Object.keys(obj).filter(e => !obj.saveLoadExclude(e))\n    for (let el of keys) delete obj[el]\n    for (let el of arr) saveLoad.decode(obj, el)\n  },\n\n\n\n  // ------------------------------------------------------------------------------------------\n  //    TRANSCRIPTS\n  //\n  // Here because it uses localStorage. That said, there are two independant systems, the second\n  // records commands to create a walk-through, and is saved in an array, this.transcriptWalkthrough\n  // because only the author should ever use it.\n\n  transcript:false,  // Set to true when recording\n  transcriptName:\"QJST:\" + settings.title + \":transcript\",\n\n  transcriptStart:function() {\n    this.transcript = true\n    this.transcriptWalkthrough = []\n    metamsg(lang.transcript_on)\n    this.transcriptWrite(lang.transcriptStart())\n  },\n\n  transcriptEnd:function() {\n    this.transcriptWrite(lang.transcriptEnd())\n    this.transcript = false\n    metamsg(lang.transcript_off)\n  },\n\n  transcriptAppend:function(data) {\n    if (!this.transcript) return\n    if (data.cssClass === 'menu') {\n      let previous = this.transcriptWalkthrough.pop()\n      if (previous) {\n        previous = previous.replace(/\\,$/, '').trim()\n        this.transcriptWalkthrough.push('    {cmd:' + previous + ', menu:' + data.n + '},')\n      }\n    }\n    this.transcriptWrite('<p class=\"' + data.cssClass + '\">' + data.text + '</p>')\n  },\n\n  // Used internally to write to the file, appending it to the existing text.\n  transcriptWrite:function(html) {\n    let s = localStorage.getItem(this.transcriptName)\n    if (!s) s = ''\n    s += '\\n\\n' + html\n    localStorage.setItem(this.transcriptName, s)\n  },\n\n  transcriptClear:function(data) {\n    localStorage.removeItem(this.transcriptName)\n    metamsg(lang.transcript_cleared)\n  },\n\n  // Is there a transcript saved?\n  transcriptExists:function(data) {\n    return localStorage.getItem(this.transcriptName) !== undefined\n  },\n\n  transcriptShow:function() {\n    const s = localStorage.getItem(this.transcriptName)\n    if (!s) {\n      metamsg(lang.transcript_none)\n      return false\n    }\n\n    let html = ''\n    html += '<div id=\"main\"><div id=\"inner\"><div id=\"output\">'\n    html += lang.transcriptTitle()\n    html += s\n    html += '</div></div></div>'\n    io.showInTab(html, 'QuestJS Transcript: ' + settings.title)\n    metamsg(lang.done_msg)\n  },\n\n  transcriptWalk:function() {\n    let html = ''\n    html += '<div id=\"main\"><div id=\"inner\"><div id=\"output\">'\n    html += '<br/><h2>Generated QuestJS Walk-through</h2><br/><br/>'\n    html += '<p>Copy-and-paste the code below into code.js. You can quickly run the walk-though with [Ctrl][Enter].</p>'\n    html += '<p>If you already have a walk-through, you will need to just copy-and-paste the right bit - probably all but the first and last lines, and insert just before the curly brace at the end. You may need to rename it too.</p>'\n    html += '<pre>\\n\\n\\nconst walkthroughs = {\\n  c:[\\n'\n    html += this.transcriptWalkthrough.join('\\n')\n    html += '\\n  ],\\n}</pre>'\n    html += '</div></div></div>'\n    io.showInTab(html, 'QuestJS Transcript: ' + settings.title)\n  },\n\n  achievementsKey:'__achievement__list__for__this__game__',\n\n  setAchievement(s) {\n    const achievementsJSON = localStorage.getItem(this.achievementsKey)\n    const achievements = achievementsJSON ? JSON.parse(achievementsJSON) : {}\n\n    if (achievements[s]) return\n\n    achievements[s] = Date.now()\n    _msg(lang.ach_got_one, {text:s, date:achievements[s]}, {cssClass:\"meta achieve\", tag:'p'})\n    localStorage.setItem(this.achievementsKey, JSON.stringify(achievements))\n  },\n\n  listAchievements() {\n    const achievementsJSON = localStorage.getItem(this.achievementsKey)\n    const achievements = achievementsJSON ? JSON.parse(achievementsJSON) : {}\n\n    if (Object.keys(achievements).length === 0) {\n      _msg(lang.ach_none_yet, {}, {cssClass:\"meta achieve\", tag:'p'})\n      return\n    }\n    _msg(lang.ach_list_intro, {count:Object.keys(achievements).length}, {cssClass:\"meta achieve\", tag:'p'})\n    for (const key in achievements) {\n      _msg(lang.ach_list_item, {text:key, date:achievements[key]}, {cssClass:\"meta achieve\", tag:'p'})\n    }\n  },\n\n\n\n  resetAchievements() {\n    localStorage.removeItem(this.achievementsKey)\n  },\n\n}\n","// noinspection UnnecessaryLabelJS\n\n\"use strict\";\n\nimport {\n    INDEFINITE,\n    io,\n    lang,\n    saveLoad,\n    world,\n    w,\n    errormsg,\n    formatList,\n    scopeHereListed,\n    player,\n    loc,\n    settings,\n    sentenceCase,\n    sentenceCaseForHTML,\n    titleCaseForHTML,\n    random,\n    array,\n    displayMoney,\n    util,\n    scopeHereParser, DEFINITE, COUNT\n} from '../index.js';\n\n//@DOC\n// ## The Text Processor Function\n//@UNDOC\n\n//@DOC\n// Returns a string in which all the text processor directives have been resolved, using the optionasl parameters.\n// More details [here(https://github.com/ThePix/QuestJS/wiki/The-Text-Processor).\nexport function processText(str, params) {\n  if (params === undefined) {\n    params = {tpNoParamsPassed:true};\n  }\n  if (typeof str !== \"string\") {\n    str = \"\" + str;\n  }\n  params.tpOriginalString = str;\n  if (params.count) params.item_count = params.count\n  //log(params)\n  if (tp.usedStrings.includes(str)) {\n    params.tpFirstTime = false;\n  }\n  else {\n    tp.usedStrings.push(str);\n    params.tpFirstTime = true;\n  }\n    return tp.processText(str, params);\n}\n\n// Most of the text processors are set up in text.js; these are the language specific ones.\nexport const tp = {\n  text_processors:{},\n  setLoadString:function(s) {\n    const parts = s.split(\"=\");\n    if (parts.length !== 2) return errormsg(\"Bad format in saved data (\" + s + \")\")\n    if (parts[0] !== \"TPUsedStrings\") return errormsg(\"Expected TP to be first\")\n    tp.usedStrings = saveLoad.decodeArray(parts[1])\n  },\n  getSaveString:function() {\n      return \"TPUsedStrings=\" + saveLoad.encodeArray(tp.usedStrings);\n  },\n}\n\ntp.usedStrings = [];\n\ntp.colours = ['#e6194b', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4', '#46f0f0', '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff', '#9a6324', '#fffac8', '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#808080', '#ffffff', '#000000']\n\n// Use this to add you custom text processor\n// Should take a string array as a parameter (the input text,\n// excluding the curly braces, name and colon),\n// and return a string.\ntp.addDirective = function(name, fn) {\n  tp.text_processors[name] = fn;\n};\n\ntp.comparisons = {\n  '=':'if',\n  '==':'if',\n  '!=':'ifNot',\n  '!==':'ifNot',\n  '<>':'ifNot',\n  '<':'ifLessThan',\n  '>':'ifMoreThan',\n  '<=':'ifLessThanOrEqual',\n  '>=':'ifMoreThanOrEqual',\n}\n\ntp.processText = function(str, params) {\n  const s = tp.findFirstToken(str);\n  if (s) {\n    let arr = s.split(\":\");\n    let left = arr.shift();\n    if (typeof tp.text_processors[left] !== \"function\") {\n      if (left.startsWith('if ')) {\n        const data = /if (not |)(\\w+)\\.(\\w+) *([<>=!]{0,3}) *(.*)/.exec(left)\n        if (data[4] === '') {\n          arr.unshift(data[3])\n          arr.unshift(data[2])\n          left = data[1] === 'not ' ? 'ifNot' : 'if'\n        }\n        else {\n          arr.unshift(data[5])\n          arr.unshift(data[3])\n          arr.unshift(data[2])\n          left = tp.comparisons[data[4]]\n        }\n      }\n      else if (left.match(/^(not)?here /)) {\n        const ary = left.split(' ')\n        ary.shift()\n        left = left.startsWith('here') ? 'ifHere' : 'ifNotHere'\n        for (const el of ary.reverse()) arr.unshift(el)\n      }\n      else if (left === \"player\") {\n        arr.unshift(player().name);\n        left = \"show\";\n      }\n      else if (left === \"currentLocation\") {\n        arr.unshift(loc().name);\n        left = \"show\";\n      }\n      else if (w[left]) {\n        arr.unshift(left);\n        left = \"show\";\n      }\n      else if (arr.length === 0) {\n        arr = left.split(\".\");\n        left = \"show\";\n      }\n      else {\n        errormsg(\"Attempting to use unknown text processor directive '\" + left + \"' (\" + params.tpOriginalString + \")\");\n        return str;\n      }\n    }\n    str = str.replace(\"{\" + s + \"}\", tp.text_processors[left](arr, params));\n    str = tp.processText(str, params);\n  }\n  return str\n};\n\n// Find the first token. This is the first to end, so\n// we get nested.\ntp.findFirstToken = function (s) {\n  const end = s.indexOf(\"}\");\n  if (end === -1) { return false; }\n  const start = s.lastIndexOf(\"{\", end);\n  if (start === -1) {\n    errormsg(\"Failed to find starting curly brace in text processor (<i>\" + s + \"</i>)\");\n    return false;\n  }\n  return s.substring(start + 1, end);\n};\n\ntp.text_processors.i = function(arr, params) { return \"<i>\" + arr.join(\":\") + \"</i>\"; };\ntp.text_processors.b = function(arr, params) { return \"<b>\" + arr.join(\":\") + \"</b>\"; };\ntp.text_processors.u = function(arr, params) { return \"<u>\" + arr.join(\":\") + \"</u>\"; };\ntp.text_processors.s = function(arr, params) { return \"<strike>\" + arr.join(\":\") + \"</strike>\"; };\ntp.text_processors.code = function(arr, params) { return \"<code>\" + arr.join(\":\") + \"</code>\"; };\ntp.text_processors.sup = function(arr, params) { return \"<sup>\" + arr.join(\":\") + \"</sup>\"; };\ntp.text_processors.sub = function(arr, params) { return \"<sub>\" + arr.join(\":\") + \"</sub>\"; };\ntp.text_processors.huge = function(arr, params) { return '<span style=\"font-size:2em\">' + arr.join(\":\") + '</span>'; };\ntp.text_processors.big = function(arr, params) { return '<span style=\"font-size:1.5em\">' + arr.join(\":\") + '</span>'; };\ntp.text_processors.small = function(arr, params) { return '<span style=\"font-size:0.8em\">' + arr.join(\":\") + '</span>'; };\ntp.text_processors.tiny = function(arr, params) { return '<span style=\"font-size:0.6em\">' + arr.join(\":\") + '</span>'; };\ntp.text_processors.smallcaps = function(arr, params) { return '<span style=\"font-variant:small-caps\">' + arr.join(\":\") + '</span>'; };\ntp.text_processors.cap = function(arr, params) {\n  return sentenceCaseForHTML(arr.join(\":\"))\n}\ntp.text_processors.title = function(arr, params) {\n  return titleCaseForHTML(arr.join(\":\"))\n}\ntp.text_processors.upper = function(arr, params) {\n  return arr.join(\":\").toUpperCase()\n}\ntp.text_processors.lower = function(arr, params) {\n  return arr.join(\":\").toLowerCase()\n}\n\ntp.text_processors.rainbow = function(arr, params) {\n  const s = arr.pop()\n  const colours = arr.length === 0 ? tp.colours : arr\n  let result = ''\n  for (let i = 0; i < s.length; i++) {\n    result += '<span style=\"color:' + random.fromArray(colours) + '\">' + s.charAt(i) + '</span>'\n  }\n  return result\n};\n\ntp._charSwap = function(c, upper, lower) {\n  if (c.match(/[A-Z]/)) return String.fromCharCode(c.charCodeAt(0) - 'A'.charCodeAt(0) + upper)\n  if (c.match(/[a-z]/)) return String.fromCharCode(c.charCodeAt(0) - 'a'.charCodeAt(0) + lower)\n  return c\n}\n\n// Try 391:3AC for Greek, 402:431 for Cyrillic, 904:904 for Devanagari\ntp.text_processors.encode = function(arr, params) {\n  const upper = parseInt(arr.shift(), 16)\n  const lower = parseInt(arr.shift(), 16)\n  const s = arr.shift()\n  let result = ''\n  for (let i = 0; i < s.length; i++) {\n    result += tp._charSwap(s.charAt(i), upper, lower)\n  }\n  return result\n};\n\ntp.text_processors.blur = function(arr, params) {\n  const n = arr.shift();\n  return '<span style=\"color:transparent;text-shadow: 0 0 ' + n + 'px rgba(0,0,0,1);\">' + arr.join(\":\") + \"</span>\";\n};\n\ntp.text_processors.font = function(arr, params) {\n  const f = arr.shift();\n  return '<span style=\"font-family:' + f + '\">' + arr.join(\":\") + \"</span>\";\n};\n\ntp.text_processors.class = function(arr, params) {\n  const c = arr.shift()\n  return '<span class=\"' + c + '\">' + arr.join(\":\") + '</span>'\n}\n\ntp.text_processors.colour = function(arr, params) {\n  const c = arr.shift();\n  return '<span style=\"color:' + c + '\">' + arr.join(\":\") + \"</span>\";\n};\n\ntp.text_processors.color = tp.text_processors.colour;\n\ntp.text_processors.back = function(arr, params) {\n  const c = arr.shift();\n  return '<span style=\"background-color:' + c + '\">' + arr.join(\":\") + \"</span>\";\n};\n\ntp.text_processors.dialogue = function(arr, params) {\n  let prefix = \"<span\";\n  const style = arr.shift()\n  if (arr.length < 1) errormsg(\"Failed to find enough parts in text processor 'dialog' (\" + params.tpOriginalString + \")\")\n\n  if (style.startsWith('.')) {\n    prefix += ' class=\"' + style.replace('.', '') + '\"'\n  }\n  else if (params[style]) {\n    prefix += ' style=\"' + params[style].dialogueStyle + '\"'\n  }\n  else {\n    if (arr.length < 2) errormsg(\"Failed to find enough parts in text processor 'dialog' without a class (\" + params.tpOriginalString + \")\")\n    const colour = arr.shift()\n    prefix += ' style=\"'\n    if (style.includes('i')) prefix += \"font-style:italic;\"\n    if (style.includes('b')) prefix += \"font-weight:bold;\"\n    if (style.includes('u')) prefix += \"text-decoration:underline;\"\n    if (colour) {\n      prefix += \"color:\" + colour\n    }\n    prefix += '\"'\n  }\n  prefix += '>'\n  return prefix + settings.openQuotation + arr.join() + settings.closeQuotation + \"</span>\"\n}\n\ntp.text_processors.random = function(arr, params) {\n  return arr[random.int(0, arr.length - 1)];\n};\n\ntp.text_processors.select = function(arr, params) { return tp.select(arr, params, 'none') }\ntp.text_processors.selectNone = function(arr, params) { return tp.select(arr, params, 'none') }\ntp.text_processors.selectWrap = function(arr, params) { return tp.select(arr, params, 'wrap') }\ntp.text_processors.selectStart = function(arr, params) { return tp.select(arr, params, 'start') }\ntp.text_processors.selectEnd = function(arr, params) { return tp.select(arr, params, 'end') }\n\ntp.text_processors.cycle = function(arr, params) { return tp.select(arr, params, 'none', true) }\ntp.text_processors.cycleNone = function(arr, params) { return tp.select(arr, params, 'none', true) }\ntp.text_processors.cycleWrap = function(arr, params) { return tp.select(arr, params, 'wrap', true) }\ntp.text_processors.cycleStart = function(arr, params) { return tp.select(arr, params, 'start', true) }\ntp.text_processors.cycleEnd = function(arr, params) { return tp.select(arr, params, 'end', true) }\n\ntp.select = function(arr, params, opt, cycling) {\n  let name = arr.shift()\n  if (name.match(/\\./)) {\n    const ary = name.split('.')\n    name = ary[0]\n    arr.unshift(ary[1])\n  }\n  const o = tp._findObject(name, params, arr)\n  if (!o) errormsg('Failed to find an object called \"' + name + '\" in text processor select.')\n  const l = o[arr[0]]\n  if (l === undefined && !cycling) errormsg('Failed to find an attribute called \"' + arr[0] + '\" for \"' + name + '\" in text processor \"select\" directive.')\n  if (Array.isArray(l)) {\n    let n = o[arr[1]]\n    if (cycling) {\n      if (typeof n !== 'number') {\n        n = 0\n        o[arr[1]] = 0\n      }\n      o[arr[1]]++\n    }\n    if (!l) errormsg('Failed to find a secondary attribute called \"' + arr[1] + '\" for \"' + name + '\" in text processor \"select\" directive.')\n    return array.value(l, Math.round(n), opt)\n  }\n  if (typeof l === 'number') {\n    if (cycling) o[arr[0]]++\n    arr.shift()\n    return array.value(arr, Math.round(l), opt)\n  }\n  if (l === undefined && cycling) {\n    o[arr[0]] = 1\n    arr.shift()\n    return array.value(arr, 0, opt)\n  }\n  errormsg('Failed to do anything with the attribute called \"' + arr[1] + '\" for \"' + name + '\" in text processor select - neither an array or an integer.')\n};\n\ntp._findObject = function(name, params, arr) {\n  if (params && params[name]) return typeof params[name] === 'string' ? w[params[name]] : params[name]\n  if (name === \"player\") return player()\n  if (name === \"currentLocation\") return loc()\n  if (name === \"settings\") return settings\n  if (name === \"params\") return params\n  if (w[name]) return w[name]\n  const ary = name.split('.')\n  if (ary.length === 1) return undefined\n  if (ary.length > 2) {\n    console.log(\"The text process cannot handle attributes of attributes, so failed to deal with: \" + name)\n    console.log(ary)\n    return undefined\n  }\n  arr.unshift(ary[1])\n  return w[ary[0]]\n}\n\ntp.text_processors.multi = function(arr, params) {\n  if (!params.multiple) return ''\n  return sentenceCase(params.item.alias) + \": \"\n}\n\ntp.text_processors.show = function(arr, params) {\n  let name = arr.shift()\n  return tp.handleShow(arr, name, null, params)\n}\n\ntp.text_processors.showOrNot = function(arr, params) {\n  let name = arr.shift()\n  let def = arr.shift()\n  return tp.handleShow(arr, name, def, params)\n}\n\ntp.handleShow = function(arr, name, def, params) {\n  if (params[name] !== undefined) {\n    if (typeof params[name] === 'object') return tp.getWhatever(params[name][arr[0]], params, params[name], def, arr)\n    return tp.getWhatever(params[name], params, undefined, def, arr)\n  }\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'show' (\" + params.tpOriginalString + \")\")\n  return tp.getWhatever(obj[arr[0]], params, obj, def, arr)\n}\ntp.text_processors.object = tp.text_processors.show\n\ntp.getWhatever = function(val, params, obj, def, arr) {\n  if (val === undefined || val === null) return def ? def : ''\n  if (val === false) return lang.tp_false\n  if (val === true) return lang.tp_true\n  if (val === undefined) return ''\n  if (typeof val === 'string') return val\n  if (typeof val === 'number') return val.toString()\n  if (val && typeof val === 'object') {  // because null is an object!\n    if (!arr[0]) return errormsg(\"Got an object, but no attribute in show for: \" + val.name)\n    if (!val[arr[0]]) return errormsg(\"Got an object, but no attribute valled \" + arr[0] + \" in show for: \" + val.name)\n    return val[arr[0]].toString()\n  }\n  if (typeof val !== 'function') return errormsg(\"Got a value of a type I was not expecting in show: \" + (typeof val))\n  const func = val.bind(obj)\n  arr.shift()  // consume the function name\n  return tp.getWhatever(func(params), params, obj, def, arr)\n}\n\ntp.text_processors.contents = function(arr, params) {\n  let name = arr.shift()\n  const obj = typeof params[name] === 'object' ? params[name] : tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'contents' (\" + params.tpOriginalString + \")\")\n  return formatList(obj.getContents(world.LOOK), {article:INDEFINITE, sep:arr[0], lastSep:arr[1], nothing:arr[2]})\n}\n\ntp.text_processors.rndalt = function(arr, params) {\n  let name = arr.shift()\n  if (params[name]) {\n    if (typeof params[name] === 'string') return params[name]\n    if (typeof params[name] === 'number') return params[name].toString()\n    if (arr.length > 0) return params[name][arr[0]]\n  }\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'show' (\" + params.tpOriginalString + \")\")\n  if (obj.alt) return random.fromArray(obj.alt)\n  return obj.alias\n}\n\ntp.text_processors.number = function(arr, params) {\n  let name = arr.shift()\n  if (name.match(/^\\d+$/)) return lang.toWords(parseInt(name))\n  if (typeof params[name] === 'number') return lang.toWords(params[name], arr[0])\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'number' (\" + params.tpOriginalString + \")\")\n  const att = arr.shift()\n  if (typeof obj[att] === 'number') return lang.toWords(obj[att], arr[0])\n  return errormsg(\"Failed to find a number for object '\" + name + \"' in text processor (\" + params.tpOriginalString + \")\")\n}\n\ntp.text_processors.ordinal = function(arr, params) {\n  let name = arr.shift()\n  if (name.match(/^\\d+$/)) return lang.toOrdinal(parseInt(name))\n  if (typeof params[name] === 'number') return lang.toOrdinal(params[name])\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'number' (\" + params.tpOriginalString + \")\")\n  if (typeof obj[arr[0]] === 'number') return lang.toOrdinal(obj[arr[0]])\n  return errormsg(\"Failed to find a number for object '\" + name + \"' in text processor (\" + params.tpOriginalString + \")\")\n};\n\ntp.text_processors.money = function(arr, params) {\n  let name = arr.shift()\n  if (name.match(/^\\d+$/)) return displayMoney(parseInt(name))\n  if (typeof params[name] === 'number') return displayMoney(params[name])\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'money' (\" + params.tpOriginalString + \")\")\n  if (obj.loc === player().name && obj.getSellingPrice) {\n    return displayMoney(obj.getSellingPrice(player()))\n  }\n  if (obj.loc === player().name && obj.getBuyingPrice) {\n    return displayMoney(obj.getBuyingPrice(player()))\n  }\n  if (obj.getPrice) {\n    return displayMoney(obj.getPrice())\n  }\n  if (obj.price) {\n    return displayMoney(obj.price)\n  }\n  if (obj.money) {\n    return displayMoney(obj.money)\n  }\n  return errormsg(\"Failed to find a price for object '\" + name + \"' in text processor (\" + params.tpOriginalString + \")\")\n};\ntp.text_processors['$'] = tp.text_processors.money\n\ntp.text_processors.dateTime = function(arr, params) {\n  const options = {format:arr[0]}\n  if (!isNaN(arr[1])) options.is = parseInt(arr[1])\n  if (!isNaN(arr[2])) options.add = parseInt(arr[2])\n  return util.getDateTime(options)\n};\n\n// Specifically for use with achievements\ntp.text_processors.date = function(arr, params) {\n  return new Date(params[arr[0]]).toLocaleString()\n}\n\ntp.text_processors.transitDest = function(arr, params) {\n  const transit = arr[0] ? w[arr[0]] : w[player().loc]\n  if (!transit.transitDoorDir) return errormsg(\"Trying to use the 'transitDest' text process directive when the player is not in a transit location (\" + params.tpOriginalString + \").\")\n  if (transit.currentButtonName) {\n    const button = w[transit.currentButtonName]\n    if (button.title) return button.title\n  }\n  const destName = transit[transit.transitDoorDir].name\n  return lang.getName(w[destName], {capital:true})\n};\n\ntp.text_processors.img = function(arr, params) {\n  const src = arr[0].includes('/') ? arr[0] : settings.imagesFolder + arr[0]\n  return '<img src=\"' + src + '\" title=\"' + arr[1] + '\" alt=\"' + arr[2] + '\"/>';\n}\n\ntp.once = function(params, s1, s2) {\n  if (params.tpFirstTime && s1) return s1\n  if (!params.tpFirstTime && s2) return s2\n  return ''\n}\ntp.text_processors.once = function(arr, params) { return tp.once(params, arr[0], arr[1]) }\ntp.text_processors.first = tp.text_processors.once\ntp.text_processors.notOnce = function(arr, params) { return tp.once(params, arr[1], arr[0]) }\ntp.text_processors.notfirst = tp.text_processors.notOnce\n\ntp.text_processors.cmd = function(arr, params) {\n  if (arr.length === 1) {\n    return io.cmdlink(arr[0], arr[0])\n  }\n  else {\n    return io.cmdlink(arr[0], arr[1])\n  }\n}\n\ntp.text_processors.command = function(arr, params) {\n  if (arr.length === 1) {\n    return io.cmdlink(arr[0], arr[0]);\n  }\n  else {\n    return io.cmdlink(arr[0], arr[1]);\n  }\n}\n\ntp.text_processors.exit = tp.text_processors.command\ntp.text_processors.page = tp.text_processors.command\n\ntp.text_processors.hour = function(arr, params) {\n  const hour = util.getDateTimeDict().hour\n  if (hour < arr[0]) return ''\n  if (hour >= arr[1]) return ''\n  return arr[2]\n}\n\ntp.text_processors.link = function(arr, params) {\n  let s1 = arr.shift()\n  let s2 = arr.join(':')\n  return '<a href=\\\"' + s2 + '\\\" target=\"_blank\">' + s1 + '</a>'\n}\n\ntp.text_processors.popup = function(arr, params) {\n  let s1 = arr.shift()\n  let s2 = arr.join(':')\n  let id = s1.replace(/[^a-zA-Z_]/, '') + random.int(0, 999999999)\n  const html = '<div id=\\\"' + id + '\\\" class=\\\"popup\\\" onclick=\\\"io.toggleDisplay(\\'' + id + '\\')\"><p>' + s2 + '</p></div>'\n  document.querySelector('#main').innerHTML += html\n  return '<span class=\\\"popup-link\\\" onclick=\\\"io.toggleDisplay(\\'#' + id + '\\')\">' + s1 + '</span>'\n}\n\ntp.text_processors.roomSet = function(arr, params) {\n  const n = loc().roomSetOrder - 1\n  return n < arr.length ? arr[n] : ''\n}\n\n//-----------  CONDITIONALS  --------------------\n\ntp.text_processors.if = function(arr, params) { return tp.handleIf(arr, params, false) }\ntp.text_processors.ifNot = function(arr, params) { return tp.handleIf(arr, params, true) }\ntp.handleIf = function(arr, params, reverse) {\n  let name = arr.shift(), flag\n\n  if (typeof params[name] === 'boolean') return (params[name] ? arr[0] : (arr[1] ? arr[1] : \"\"))\n\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'if/ifNot' (\" + params.tpOriginalString + \")\")\n  name = arr.shift();\n  let attValue = typeof obj[name] === 'function' ? obj[name](params) : obj[name]\n  if (typeof attValue === 'object') attValue = attValue.name\n  if (attValue === undefined) attValue = false\n  if (typeof attValue === \"boolean\") {\n    flag = attValue\n  }\n  else {\n    let value = arr.shift()\n    if (typeof attValue === \"number\") {\n      if (isNaN(value)) return errormsg(\"Trying to compare a numeric attribute, '\" + name + \"' with a string (\" + params.tpOriginalString + \").\")\n      value = parseInt(value)\n    }\n    flag = (attValue === value)\n  }\n  if (reverse) flag = !flag\n  return (flag ? arr[0] : (arr[1] ? arr[1] : \"\"))\n}\n\ntp.text_processors.ifIs = function(arr, params) { return tp.handleIfIs(arr, params, false) }\ntp.text_processors.ifNotIs = function(arr, params) { return tp.handleIfIs(arr, params, true) }\n\ntp.handleIfIs = function(arr, params, reverse) {\n  let name = arr.shift(), flag;\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'if/ifNot' (\" + params.tpOriginalString + \")\")\n  name = arr.shift();\n  let attValue = typeof obj[name] === 'function' ? obj[name](params) : obj[name]\n  if (typeof attValue === 'object') attValue = attValue.name\n  const value = util.guessMyType(arr.shift())\n  flag = (attValue === value)\n  if (reverse) flag = !flag\n  return (flag ? arr[0] : (arr[1] ? arr[1] : \"\"))\n}\n\ntp.text_processors.ifExists = function(arr, params) { return tp.handleIfExists(arr, params, false) }\ntp.text_processors.ifNotExists = function(arr, params) { return tp.handleIfExists(arr, params, true) }\ntp.handleIfExists = function(arr, params, reverse) {\n  let name = arr.shift(), flag\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'if/ifNotExists' (\" + params.tpOriginalString + \")\")\n  name = arr.shift()\n  flag = obj[name] !== undefined\n  if (reverse) flag = !flag\n  return (flag ? arr[0] : (arr[1] ? arr[1] : \"\"))\n}\n\ntp.text_processors.ifLessThan = function(arr, params) { return tp.handleIfLessMoreThan(arr, params, false, false) }\ntp.text_processors.ifMoreThan = function(arr, params) { return tp.handleIfLessMoreThan(arr, params, true, false) }\ntp.text_processors.ifLessThanOrEqual = function(arr, params) { return tp.handleIfLessMoreThan(arr, params, false, true) }\ntp.text_processors.ifMoreThanOrEqual = function(arr, params) { return tp.handleIfLessMoreThan(arr, params, true, true) }\ntp.handleIfLessMoreThan = function(arr, params, moreThan, orEqual) {\n  let name = arr.shift(), flag\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'ifLessMoreThan' (\" + params.tpOriginalString + \")\")\n  name = arr.shift()\n  let attValue = typeof obj[name] === 'function' ? obj[name](params) : obj[name]\n  if (typeof attValue !== \"number\") return errormsg(\"Trying to use ifLessThan with a non-numeric (or nonexistent) attribute, '\" + name + \"' (\" + params.tpOriginalString + \").\")\n  let value = arr.shift()\n  if (isNaN(value)) return errormsg(\"Trying to compare a numeric attribute, '\" + name + \"' with a string (\" + params.tpOriginalString + \").\")\n  value = parseInt(value)\n  flag = moreThan ? (orEqual ? (attValue >= value) : (attValue > value)) : (orEqual ? (attValue <= value) : (attValue < value))\n  return (flag ? arr[0] : (arr[1] ? arr[1] : \"\"))\n}\n\ntp.text_processors.ifHere = function(arr, params) { return tp.handleIfHere(arr, params, false, 'loc') }\ntp.text_processors.ifNotHere = function(arr, params) { return tp.handleIfHere(arr, params, true, 'loc') }\ntp.text_processors.ifHeld = function(arr, params) { return tp.handleIfHere(arr, params, false, 'name') }\ntp.text_processors.ifNotHeld = function(arr, params) { return tp.handleIfHere(arr, params, true, 'name') }\ntp.handleIfHere = function(arr, params, reverse, locAtt) {\n  const name = arr.shift();\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'ifHere' (\" + params.tpOriginalString + \")\")\n  let flag = obj.isAtLoc(player()[locAtt], world.ALL)\n  if (reverse) flag = !flag\n  return (flag ? arr[0] : (arr[1] ? arr[1] : \"\"))\n}\n\ntp.text_processors.ifPlayer = function(arr, params) { return tp.handleIfPlayer(arr, params, false) }\ntp.text_processors.ifNotPlayer = function(arr, params) { return tp.handleIfPlayer(arr, params, true) }\ntp.handleIfPlayer = function(arr, params, reverse) {\n  let name = arr.shift(), flag\n  const obj = tp._findObject(name, params, arr)\n  if (!obj) return errormsg(\"Failed to find object '\" + name + \"' in text processor 'if/ifNotPlayer' (\" + params.tpOriginalString + \")\")\n  flag = obj === player()\n  if (reverse) flag = !flag\n  return (flag ? arr[0] : (arr[1] ? arr[1] : \"\"))\n}\n\n//---------------  SUPPORT  FOR  ROOM  TEMPLATES  ------------------------------------\n\ntp.text_processors.terse = function(arr, params) {\n  if ((settings.verbosity === world.TERSE && loc().visited === 0) || settings.verbosity === world.VERBOSE || params.fullDescription) {\n    return sentenceCase(arr.join(\":\"))\n  }\n  else {\n    return ''\n  }\n}\n\n// Need to do some hackery here...\n// It is assumed this is only used in the room template, and therefore should be safe\n// The issue is that the text for every room is {hereDesc}, so the \"once\" directive\n// would only work the first time. In the second room, {hereDesc} has already been done, so once fails.\n// The hack then is to pre-process the room text in here\ntp.text_processors.hereDesc = function(arr, params) {\n  let s\n  const attName = settings.getLocationDescriptionAttName()\n  if (typeof loc()[attName] === 'string') {\n    s = loc()[attName]\n  }\n  else if (typeof loc()[attName] === 'function') {\n    s = loc()[attName]()\n    if (s === undefined) {\n      log(\"This location description is not set up properly. It has a '\" + attName +\n          \"' function that does not return a string. The location is \\\"\" + loc().name + \"\\\".\")\n      return \"[Bad description, F12 for details]\"\n    }\n  }\n  else {\n    s = \"This is a location in dire need of a description.\"\n  }\n  for (const el of scopeHereParser()) {\n    if (typeof el.scenery === 'string') s += (settings.sceneryOnNewLine ? '|' : ' ') + el.scenery\n  }\n  delete params.tpFirstTime\n  return processText(s, params)\n}\n\ntp.text_processors.hereName = function(arr, params) {\n  return loc().headingAlias\n};\n\ntp.text_processors.objectsHere = function(arr, params) {\n  const listOfOjects = scopeHereListed();\n  return listOfOjects.length === 0 ? \"\" : arr.join(\":\");\n};\n\ntp.text_processors.exitsHere = function(arr, params) {\n  const list = loc().getExitDirs()\n  return list.length === 0 ? \"\" : arr.join(\":\");\n};\n\ntp.text_processors.objects = function(arr, params) {\n  const listOfOjects = scopeHereListed();\n  return formatList(listOfOjects, {\n      article:INDEFINITE, lastSep:lang.list_and,\n      modified:true, nothing:lang.list_nothing,\n      loc:player().loc\n  });\n}\n\ntp.text_processors.exits = function(arr, params) {\n  const list = loc().getExitDirs()\n  return formatList(list, {lastSep:lang.list_or, nothing:lang.list_nowhere});\n}\n\n//----------------  PARAMS  AND  NEUTRAL  LANGUAGE  SUPPORT  ---------------------------\n// Then {nv:char:try} to get\n\n\n/*\nThe name functions could readily be expanded. You can add further parameters and Quest will then grab those and pass them to lang.getName. Thus, if we have this:\n\nmsg(\"You see {nm:item:the:false:x_count}.\", {item:w.terror_cat, x_count:4})\n\nThen the options passed to lang.getName will include x_count set to 4.\n*/\n\n// {function:character:article:capitalise}\ntp.text_processors.nm = function(arr, params) { return tp.nameFunction(arr, params, false) }\ntp.text_processors.nms = function(arr, params) { return tp.nameFunction(arr, params, true) }\ntp.text_processors.list = function(arr, params) { return tp.nameFunction(arr, params, false, true) }\ntp.nameFunction = function(arr, params, isPossessive, isList) {\n\n  const name = arr.shift()\n  let subject\n  if (isList) {\n    subject = params[name]\n    if (!subject) {\n      errormsg(\"Cannot find parameter for list text processor directive:\" + name)\n      return false\n    }\n    if (!Array.isArray(subject)) {\n      errormsg(\"Parameter for list text processor directive is not a list:\" + name)\n      return false\n    }\n  }\n  else {\n    subject = tp._findObject(name, params, arr)\n    if (!subject) return false;\n  }\n\n  const options = {possessive:isPossessive};\n  if (arr[0] === 'THE') { options.article = DEFINITE; options.ignorePossessive = true }\n  if (arr[0] === 'the') options.article = DEFINITE\n  if (arr[0] === 'the-pa') {options.article = DEFINITE; options.possAdj = true }\n  if (arr[0] === 'A') { options.article = INDEFINITE; options.ignorePossessive = true }\n  if (arr[0] === 'a') options.article = INDEFINITE\n  if (arr[0] === 'a-pa') {options.article = INDEFINITE; options.possAdj = true }\n  if (arr[2] && options.possAdj) {\n    options.possAdj = tp._findObject(arr[2], params, [])\n  }\n  if (arr[0] === 'count') options.article = COUNT\n  if (params[subject.name + '_count']) options[subject.name + '_count'] = params[subject.name + '_count']\n  if (params[name + '_count']) options[subject.name + '_count'] = params[name + '_count']\n  if (params[subject.name + '_count_loc']) options['loc'] = params[subject.name + '_count_loc']\n  let n = 2\n  while (arr[n]) {\n    options[arr[n]] = params[arr[n]]\n    n++\n  }\n  options.lastSep = lang.list_and\n  options.othing = lang.list_nothing\n\n  const s = isList ? formatList(subject, options) :lang.getName(subject, options)\n\n  return arr[1] === 'true' ? sentenceCase(s) : s;\n}\n\n// {function:character:verb:capitalise}\ntp.text_processors.nv = function(arr, params) { return tp.conjugations(lang.nounVerb, arr, params) }\ntp.text_processors.pv = function(arr, params) { return tp.conjugations(lang.pronounVerb, arr, params) }\ntp.text_processors.vn = function(arr, params) { return tp.conjugations(lang.verbNoun, arr, params) }\ntp.text_processors.vp = function(arr, params) { return tp.conjugations(lang.verbPronoun, arr, params) }\ntp.text_processors.cj = function(arr, params) { return tp.conjugations(lang.conjugate, arr, params) }\ntp.conjugations = function(func, arr, params) {\n  const name = arr.shift()\n  const subject = tp._findObject(name, params, arr)\n  if (!subject) return false\n  const options = {capitalise:arr[1] === 'true'}\n  let n = 2\n  while (arr[n]) {\n    options[arr[n]] = params[arr[n]]\n    n++\n  }\n  return func(subject, arr[0], options)\n}\n\n// {function:item:capitalise}\ntp.handlePronouns = function(arr, params, pronoun) {\n  const name = arr.shift()\n  const subject = tp._findObject(name, params, arr)\n  if (!subject) return false;\n  return arr[0] === 'true' ? sentenceCase(subject.pronouns[pronoun]) : subject.pronouns[pronoun];\n};\ntp.text_processors.pa = function(arr, params) {\n  return tp.handlePronouns(arr, params, \"possAdj\");\n};\ntp.text_processors.ob = function(arr, params) {\n  return tp.handlePronouns(arr, params, \"objective\");\n};\ntp.text_processors.sb = function(arr, params) {\n  return tp.handlePronouns(arr, params, \"subjective\");\n};\ntp.text_processors.ps = function(arr, params) {\n  return tp.handlePronouns(arr, params, \"possessive\");\n};\ntp.text_processors.rf = function(arr, params) {\n  return tp.handlePronouns(arr, params, \"reflexive\");\n};\n\n// {pa2:chr1:chr2}\ntp.text_processors.pa2 = function(arr, params) {\n  const name1 = arr.shift()\n  const chr1 = tp._findObject(name1, params, arr)\n  if (!chr1) return false;\n  const name2 = arr.shift()\n  const chr2 = tp._findObject(name2, params, arr)\n  if (!chr2) return false;\n\n  if (chr1.pronouns === chr2.pronouns && chr1 !== chr2) {\n    const opt = {article:DEFINITE, possessive:true};\n    return arr[0] === 'true' ? sentenceCase(lang.getName(chr1, opt)) : lang.getName(chr1, opt)\n  }\n\n  return arr[0] === 'true' ? sentenceCase(chr1.pronouns.possAdj) : chr1.pronouns.possAdj;\n};\n\n// {pa3:chr1:chr2}\ntp.text_processors.pa3 = function(arr, params) {\n  const name1 = arr.shift()\n  const chr1 = tp._findObject(name1, params, arr)\n  if (!chr1) return false;\n  const name2 = arr.shift()\n  const chr2 = tp._findObject(name2, params, arr)\n  if (!chr2) return false;\n\n  // todo - undefined variable 'subject'\n  if (chr1 !== chr2) {\n    const opt = {article:DEFINITE, possessive:true};\n    return arr[0] === 'true' ? sentenceCase(lang.getName(subject, opt)) : lang.getName(subject, opt);\n  }\n\n  return arr[0] === 'true' ? sentenceCase(chr1.pronouns.possAdj) : chr1.pronouns.possAdj;\n};\n","// noinspection JSDeprecatedSymbols\n\n\"use strict\"\nimport {\n    DEFINITE, lang, commands, saveLoad, test, random, settings, w,\n    processText, runCmd, sentenceCase, verbify, player, loc, world, parser\n} from '../index.js';\n\n// This is at the top of the file so authors know to ignore stack trace enties for lines 1 to 15 in _io.js\nexport const printError = function(msg, err, suppressTrace) {\n  console.error(\"ERROR: \" + msg)\n  if (world.isCreated) {\n    io.print({tag:'p', cssClass:\"error\", text: lang.error})\n    saveLoad.transcriptAppend({ cssClass:'error', text:msg, stack:err.stack, })\n    io.reset()  // ensure the interface is still useable!\n  }\n  if (suppressTrace) return false\n  console.log('Look through the trace below to find the offending code. The first entry in the list may be \"errormsg\" in the file \"_io.js\", which is me so can be ignored. The next will the code that detected the error and called the \"errormsg\" message. You may need to look further down to find the root cause, especially for a text process issue.')\n  if (settings.playMode !== 'dev') console.log(\"If this is uploaded, it might be worth doing [Crtl]-[Shft]-R to reload the page. You will lose any progress, but it will clear the browser cache and ensure you are using the latest version of the game files.\")\n  console.log(err)\n  return false;\n}\n\nif (settings.playMode !== 'dev') {\n  window.onbeforeunload = function(event) {\n    event.returnValue = \"Are you sure?\";\n  }\n}\n\nsettings.mediaQuery = window.matchMedia(\"(prefers-reduced-motion: reduce)\")\nsettings.autoscroll = !settings.mediaQuery.matches\n\n// ============  Output  =======================================\n\n//@DOC\n// ##Output functions\n//\n// The idea is that you can have them world. differently - or not at all -\n// so error messages can be world.ed in red, meta-data (help., etc)\n// is grey, and debug messages can be turned on and off as required.\n//\n// Note that not all use the text processor (so if there is an issue with\n// the text processor, we can use the others to report it). Also unit tests\n// capture output with msg and errormsg, but not debugmsg or headings.\n//\n// Should all be language neutral\n//@UNDOC\n\n/*\ntag   required\naction  required\ncssClass\nprintBlank\n*/\n\nexport function _msg(s, params, options) {\n  if (options.tag === undefined) options.tag = 'p'\n  if (options.cssClass === undefined) options.cssClass = 'default-' + options.tag.toLowerCase();\n  let processed = params ? processText(s, params).trim() : s.trim();\n  if (processed === \"\" && !options.printBlank) return;\n\n  for (let line of processed.split('|')) {\n    for (const el in io.escapeCodes) {\n      line = line.replace(RegExp('@@@' + el + '@@@', 'ig'), io.escapeCodes[el])\n    }\n    if (settings.convertDoubleDash && !test.testing) line = line.replace(/ -- /g, ' &mdash; ')\n    const data = {}\n    Object.assign(data, options)  // need to do it this way as options may be same object\n    data.text = line\n    if (!data.action) data.action = 'output'\n\n    if (test.testing) {\n      if (test.ignoreHTML) line = line.replace(/(<([^>]+)>)/gi, '')\n      if (test.fullOutputData) {\n        test.testOutput.push(data)\n      }\n      else {\n        test.testOutput.push(line)\n      }\n    }\n    else {\n      io.addToOutputQueue(data)\n    }\n  }\n}\n\n//@DOC\n// Adds the given string to the print queue.\n// This allows you to add any HTML you want to the output queue.\nexport function rawPrint(s) {\n  _msg(s, false, {})\n}\n\n//@DOC\n// Output a standard message, as an HTML paragraph element (P).\n// The string will first be passed through the text processor.\n// Additional data can be put in the optional params dictionary.\n// You can specify a CSS class to use.\n// During unit testing, messages will be saved and tested\n// If the string starts with a hash and no cssClass is given the line will be printed as a level 4 heading.\n// A vertical bar will be taken as a line break.\nexport function msg(s, params, cssClass) {\n  if (!params) params = {}\n  if (typeof s !== 'string') {\n    console.error(\"Trying to print with \\\"msg\\\", but got this instead of a string:\")\n    console.error(s)\n    const err = new Error();\n    log(err.stack)\n    throw \"Bad string for msg()\"\n  }\n\n  if (/^#/.test(s) && !cssClass) {\n    s = s.replace(/^#/, '')\n    _msg(s, params, {cssClass:'default-h default-h4', tag:'h4'})\n  }\n  else {\n    _msg(s, params, {cssClass:cssClass, tag:'p'})\n  }\n}\n\n//@DOC\n// Output a standard message, as an HTML pre-formaed element (PRE).\n// The string will first be passed through the text processor.\n// Additional data can be put in the optional params dictionary.\n// During unit testing, messages will be saved and tested\nexport function msgPre(s, params, cssClass) {\n  if (!params) params = {}\n  if (typeof s !== 'string') {\n    console.error(\"Trying to print with \\\"msgPre\\\", but got this instead of a string:\")\n    console.error(s)\n    console.trace()\n    throw \"Bad string for msgPre()\"\n  }\n  _msg(s, params, {cssClass:cssClass, tag:'pre'})\n}\n\n//@DOC\n//Output a standard message, but it makes the NEXT message appear on the same line as the current message. Note that the next message will not have its own params or cssClass.\nexport function OutputTextNoBr(s, params, cssClass) {\n    if(s.startsWith(' ')) {\n        s = \"&nbsp;\" + s.substring(1, s.length);\n    }\n    if(s.endsWith(' ')) {\n        s = s.substring(0, (s.length - 1)) + \"&nbsp;\"\n    }\n   msg(\"@@OUTPUTTEXTNOBR@@\" + s, params, cssClass);\n}\nexport function msgBlankLine() {\n  _msg('', false, {tag:'p', printBlank:true})\n}\n\n//@DOC\n// As `msg`, but handles an array of strings. Each string is put in its own HTML paragraph,\n// and the set is put in an HTML division (DIV). The cssClass is applied to the division.\nexport function msgDiv(arr, params, cssClass) {\n  let s = ''\n  for (let item of arr) {\n    s += '  <p>' + item + \"</p>\\n\"\n  }\n  _msg(s, params || {}, {cssClass:cssClass, tag:'div'})\n}\n\n//@DOC\n// As `msg`, but handles an array of strings in a list. Each string is put in its own HTML list item (LI),\n// and the set is put in an HTML order list (OL) or unordered list (UL), depending on the value of `ordered`.\nexport function msgList(arr, ordered, params, cssClass) {\n  let s = ''\n  for (let item of arr) {\n    s += '  <li>' + item + \"</li>\\n\"\n  }\n  _msg(s, params || {}, {cssClass:cssClass, tag:ordered ? 'ol' : 'ul'})\n}\n\n//@DOC\n// As `msg`, but handles an array of arrays of strings in a list. This is laid out in an HTML table.\n// If `headings` is present, this array of strings is used as the column headings.\nexport function msgTable(arr, headings, params, cssClass) {\n  let s = ''\n  if (headings) {\n    s += '  <tr>\\n'\n    for (let item of headings) {\n      s += \"    <th>\" + item + \"</th>\\n\"\n    }\n    s += '  </tr>\\n'\n  }\n  for (let row of arr) {\n    s += '  <tr>\\n'\n    for (let item of row) {\n      s += \"    <td>\" + processText(item, params).trim() + \"</td>\\n\"\n    }\n    s += \"  </tr>\\n\"\n  }\n  _msg(s, params || {}, {cssClass:cssClass, tag:'table'})\n}\n\n//@DOC\n// As `msg`, but the string is presented as an HTML heading (H1 to H6).\n// The level of the heading is determined by `level`, with 1 being the top, and 6 the bottom.\n// Headings are ignored during unit testing.\nexport function msgHeading(s, level, params) {\n  _msg(s, params || {}, {tag:'h' + level, cssClass:'default-h default-h' + level})\n}\n\n//@DOC\n// Output a picture, as an HTML image element (IMG).\n// If width and height are omitted, the size of the image is used.\n// If height is omitted, the height will be proportional to the given width.\n// The file name should include the path. For a local image, that would probably be the images folder,\n// but it could be the web address of an image hosted elsewhere.\nexport function picture(filename, width, height) {\n  const src = filename.includes('/') ? filename : settings.imagesFolder + filename\n  _msg('', {}, {action:'output', width:width, height:height, tag:'img', src:src, printBlank:true})\n}\n\nexport function image(filename, width, height) {\n  const src = filename.includes('/') ? filename : settings.imagesFolder + filename\n  _msg('', {}, {action:'output', width:width, height:height, tag:'img', src:src, cssClass:'centred', printBlank:true, destination:'quest-image'})\n}\n\n//@DOC\n// Plays a sound. The filename must include the extension, and the file should be in the folder specified by audioFolder (defaults to the game folder).\nexport function sound(filename) {\n  //console.log(settings.ssFolder)\n  _msg('Your browser does not support the <code>audio</code> element.', {}, {action:'sound', name:filename})\n}\nexport function ambient(filename, volume) {\n  //console.log(settings.ssFolder)\n  _msg('Your browser does not support the <code>audio</code> element.', {}, {action:'ambient', name:filename, volume:volume})\n}\n\n//@DOC\n// Plays a video. The filename must include the extension, and the file should be in the folder specified by audioFolder (defaults to the game folder).\n// There are some issues about codecs and formats; use at your discretion.\nexport function video(filename) {\n  //console.log(settings.ssFolder)\n  _msg('Your browser does not support the <code>video</code> element.', {}, {action:'output', autoplay:true, tag:'video', src:settings.videoFolder + '/' + filename})\n}\n\n//@DOC\n// Draw an image in the main window, embedded in the text.\n// This uses SVG, which is a standard web drawing system.\n// The first and second parameters are the width and height of the image.\n// The third parameter is an array of strings, each element being an SVG primitive.\n// The image will be added to the output queue in the same way text is.\nexport function draw(width, height, data, options) {\n  if (!options) options = {}\n  //console.log(options)\n  let s = '<svg width=\"' + width + '\" height=\"' + height + '\" viewBox=\"'\n  s += options.x !== undefined ? ('' + options.x + ' ' + options.y) : '0 0'\n  s += ' ' + width + ' ' + height + '\" '\n  if (options.background) s += 'style=\"background:' + options.background + '\" '\n  s += 'xmlns=\"http://www.w3.org/2000/svg\">'\n  s += data.join('') + '</svg>'\n  if (settings.reportAllSvg) console.log(s.replace(/></g, '>\\n<'))\n  if (options.destination) {\n    document.querySelector('#' + options.destination).innerHTML = s\n  }\n  else {\n    rawPrint(s)\n  }\n}\n\n//@DOC\n// Just the same as msg, but adds the \"failed\" CSS class. This allows failed command responses to be differentiated.\n// Returns the value FAILED, allowing commands to give a message and give up\n//     if (notAllowed) return failedmsg(\"That is not allowed.\")\nexport function failedmsg(s, params) {\n  _msg(s, params || {}, {cssClass:\"default-p failed\", tag:'p'});\n  return world.FAILED;\n}\n\n//@DOC\n// Just the same as msg, but adds the \"failed\" CSS class. This allows failed command responses to be differentiated.\n// Returns the value false, allowing commands to give a message and give up\n//     if (notAllowed) return falsemsg(\"That is not allowed.\")\nexport function falsemsg(s, params) {\n  _msg(s, params || {}, {cssClass:\"default-p failed\", tag:'p'});\n  return false;\n}\n\n//@DOC\n// Output a meta-message - a message to inform the player about something outside the game world,\n// such as hints and help messages.\n// The string will first be passed through the text processor.\n// Additional data can be put in the optional params dictionary.\n// During unit testing, messages will be saved and tested\nexport function metamsg(s, params) {\n  _msg(s, params || {}, {cssClass:\"meta\", tag:'p'});\n}\n\n//@DOC\n// Output a message from the parser indicating the input text could not be parsed.\n// During unit testing, messages will be saved and tested.\n// Does not use the text processor.\nexport function parsermsg(s) {\n  _msg(s, false, {cssClass:\"parser\", tag:'p'});\n  return false;\n}\n\n//@DOC\n// Output a message from the user\n// Does not use the text processor.\nexport function commentmsg(s) {\n  _msg(s, false, {cssClass:\"comment\", tag:'p'});\n  return false;\n}\n\n//@DOC\n// Output an error message.\n// Use for when something has gone wrong, but not when the player types something odd -\n// if you see this during play, there is a bug in your game (or my code!), it is not the player\n// to blame.\n//\n// This bypasses the normal output system. It will not wait for other text to be output (for example\n// after wait). During unit testing, error messages will be output to screen as they occur.\n// It does not use the text processor.\nexport function errormsg(s, suppressTrace) {\n  if (test.errorOutput !== undefined) {\n    // This is an expected error in a unit test\n    test.errorOutput.push(s)\n    return false\n  }\n\n  printError(s, new Error('error state caught by QuestJS runtime'), suppressTrace)\n\n}\n\n//@DOC\n// Output a debug message.\n// Debug messages are ignored if DEBUG is false.\n// You should also consider using `console.log` when debugging; it gives a message in the console,\n// and outputs objects and array far better.\n//\n// This bypasses the normal output system. It will not wait for other text to be output (for example\n// after wait). During unit testing, error messages will be output to screen as they occur.\n// It does not use the text processor.\nexport function debugmsg(s) {\n  if (settings.playMode === 'dev' || settings.playMode === 'meta') {\n    io.print({tag:'pre', cssClass:\"debug\", text:s, id:io.nextid})\n    io.nextid++\n  }\n}\n\n//@DOC\n// Adds a blank line to the output.\nexport function blankLine() {\n  rawPrint('&nbsp;')\n}\n\n//@DOC\n// Adds a horizontal rule to the output.\nexport function hr() {\n  rawPrint('<hr/>')\n}\n\n//@DOC\n// Clears the screen.\nexport function clearScreen() {\n  io.addToOutputQueue({action:'clear'})\n}\n\n//@DOC\n// Stops outputting whilst waiting for the player to click.\nexport function wait(delay, text, func) {\n  if (test.testing || settings.walkthroughInProgress) return\n  if (delay === undefined) {\n    io.addToOutputQueue({action:'wait', text:text, cssClass:'continue', func:func})\n  }\n  else {\n    io.addToOutputQueue({action:'delay', delay:delay, text:text, cssClass:'continue', func:func})\n  }\n}\n\n//@DOC\n// Clears the screen.\nexport function trigger(func) {\n  io.addToOutputQueue({action:'func', func:func})\n}\n\n//@DOC\n// Use like this:\n//      showMenu('What is your favourite color?', ['Blue', 'Red', 'Yellow', 'Pink'], function(result) {\n//        msg(\"You picked \" + result + \".\");\n//      });\nexport function showMenu(title, options, fn) {\n  const opts = {article:DEFINITE, capital:true, noLinks:true}\n  io.input(title, options, false, fn, function(options) {\n    for (let i = 0; i < options.length; i++) {\n      let s = '<a class=\"menu-option\" onclick=\"io.menuResponse(' + i + ')\">';\n      s += (typeof options[i] === 'string' ? options[i] : lang.getName(options[i], opts))\n      s += '</a>';\n      msg(s);\n    }\n  })\n}\n\nexport function showMenuNumbersOnly(title, options, fn) {\n  const opts = {article:DEFINITE, capital:true, noLinks:true}\n  parser.overrideWith(function(s) {io.menuResponse(s)})\n  const disableTextFunction = function(disable) {\n    if (disable) {\n      io.disable(3)\n      // add a keypress event handler to capture keypresses directly\n      io.keydownFunctions.push(io.keydownForMenuFunction)\n    }\n    else {\n      io.enable()\n    }\n  }\n  io.input(title, options, disableTextFunction, fn, function(options) {\n    for (let i = 0; i < options.length; i++) {\n      let s = (i + 1) + '. <a class=\"menu-option\" onclick=\"io.menuResponse(' + i + ')\">';\n      s += (typeof options[i] === 'string' ? options[i] : lang.getName(options[i], opts))\n      s += '</a>';\n      msg(s);\n    }\n  })\n}\n\nexport function showMenuWithNumbers(title, options, fn) {\n  const opts = {article:DEFINITE, capital:true, noLinks:true}\n  parser.overrideWith(function(s) {io.menuResponse(s)})\n  const disableTextFunction = function(disable) {\n    if (disable) {\n      io.disable(2)\n    }\n    else {\n      io.enable()\n      io.doNotSaveInput = false\n    }\n  }\n  const failFunction = function(input) {\n    msg(\"I do not understand: \" + input)\n    runCmd(input)\n    io.savedCommands.push(input)\n  }\n  io.doNotSaveInput = true\n  io.input(title, options, disableTextFunction, fn, function(options) {\n    for (let i = 0; i < options.length; i++) {\n      let s = (i + 1) + '. <a class=\"menu-option\" onclick=\"io.menuResponse(' + i + ')\">';\n      s += (typeof options[i] === 'string' ? options[i] : lang.getName(options[i], opts))\n      s += '</a>';\n      msg(s);\n    }\n  }, failFunction)\n}\n\nexport function showDropDown(title, options, fn) {\n  const opts = {article:DEFINITE, capital:true, noLinks:true}\n  io.input(title, options, false, fn, function(options) {\n    let s = '<select id=\"menu-select\" class=\"custom-select\" style=\"width:400px;\" ';\n    s += 'onchange=\\\"io.menuResponse(io.getDropDownText(\\'menu-select\\'))\\\">';\n    s += '<option value=\"-1\">-- Select one --</option>';\n    for (let i = 0; i < options.length; i++) {\n      s += '<option value=\"' + (i+1) + '\">';\n      s += (typeof options[i] === 'string' ? options[i] : lang.getName(options[i], opts))\n      s += '</option>';\n    }\n    msg(s + \"</select>\");\n    //document.querySelector('#menu-select').selectmenu();\n    document.querySelector('#menu-select').focus();\n  })\n}\n\nexport function showMenuDiag(title, options, fn, cssClass) {\n  io.showMenuDiagTitle = title\n  const opts = {article:DEFINITE, capital:true, noLinks:true}\n  const disableTextFunction = function(disable) {\n    if (disable) {\n      io.disable(3)\n    }\n    else {\n      io.enable()\n      if (!test.testing) {\n        const el = document.querySelector('#sidepane-menu')\n        if (el) el.remove() // may not exist in walk-through\n      }\n    }\n  }\n\n  const displayFunction = function(options) {\n    let s = '<div id=\"sidepane-menu\"'\n    if (cssClass) s += ' class=\"' + cssClass + '\"'\n    s += '>'\n    if (typeof io.showMenuDiagTitle === 'string') {\n      s += '<p class=\"sidepane-menu-title\">' + io.showMenuDiagTitle + '</p>'\n    }\n    else {\n      s += '<h4 class=\"sidepane-menu-title\">' + io.showMenuDiagTitle.title + '</h4>'\n      s += '<p class=\"sidepane-menu-title\">' + io.showMenuDiagTitle.text + '</p>'\n    }\n    for (let i = 0; i < options.length; i++) {\n      s += '<p value=\"' + i + '\" onclick=\"io.menuResponse(' + i + ')\" class=\"sidepane-menu-option\">'\n      s += (typeof options[i] === 'string' ? options[i] : lang.getName(options[i], opts))\n      s += '</p>';\n    }\n    s += '</div>'\n    document.querySelector('body').innerHTML += s\n  }\n\n  io.input(false, options, disableTextFunction, fn, displayFunction)\n\n  return world.SUCCESS_NO_TURNSCRIPTS\n}\n\nexport function showYesNoMenu(title, fn) {\n  showMenu(title, lang.yesNo, fn)\n}\n\nexport function showYesNoMenuWithNumbers(title, fn) {\n  showMenuWithNumbers(title, lang.yesNo, fn)\n}\n\nexport function showYesNoDropDown(title, fn) {\n  showDropDown(title, lang.yesNo, fn)\n}\n\nexport function askText(title, fn) {\n  io.menuFns.push(fn)\n  msg(title)\n  io.disable(2)\n  document.querySelector('#input').style.display = 'block'\n\n  parser.overrideWith(function(result) {\n    io.enable()\n    if (!settings.textInput) document.querySelector('#input').style.display = 'none'\n    io.savedCommands.pop()\n    if (io.savedCommandsPos > io.savedCommands.length) io.savedCommandsPos = io.savedCommands.length\n    const fn = io.menuFns.pop()\n    fn(result)\n  })\n}\n\nexport function showDiag(title, text, submitButton) {\n  if (!submitButton) return errormsg(\"Trying to use showDiag with no button\")\n  askDiag({title:title, text:text, width:400, height:'auto'}, null, submitButton)\n}\n\nexport function askDiag(title, fn, submitButton) {\n  io.menuFns.push(fn)\n  io.showMenuDiagTitle = title\n  io.showMenuDiagSubmit = submitButton\n  const disableTextFunction = function(disable) {\n    if (disable) {\n      io.disable(3)\n    }\n    else {\n      io.enable()\n      const el = document.querySelector('#sidepane-text')\n      // el will not exist if walk-through\n      if (el) el.remove()\n    }\n  }\n\n  const displayFunction = function() {\n    let s = '<div id=\"sidepane-menu\"'\n    if (title.width) s += ' style=\"width:' + title.width + 'px;top:100px;\"'\n    s += '>'\n\n    if (typeof title === 'string') {\n      s += '<p class=\"sidepane-menu-title\">' + io.showMenuDiagTitle + '</p>'\n    }\n    else {\n      s += '<h4 class=\"sidepane-menu-title\">' + io.showMenuDiagTitle.title + '</h4>'\n      s += '<p class=\"sidepane-menu-title\">' + io.showMenuDiagTitle.text + '</p>'\n    }\n    if (fn) s += '<input type=\"text\" id=\"text-dialog\" class=\"sidepane-menu-option\">'\n    if (io.showMenuDiagSubmit) {\n      s += '<div id=\"dialog-footer\" style=\"text-align:right\"><hr>'\n      s += '<input type=\"button\" onclick=\"io.textResponse()\" value=\"' + io.showMenuDiagSubmit + '\" class=\"sidepane-menu-button\"></div>'\n    }\n    s += '</div>'\n    document.querySelector('body').innerHTML += s\n\n\n    if (fn) {\n      const el = document.getElementById(\"text-dialog\")\n      el.addEventListener(\"keydown\", function(event) {\n        if (event.keyCode === 13) {\n          event.preventDefault();\n          io.textResponse()\n        }\n      })\n      el.focus()\n      io.menuFns.pop()\n    }\n  }\n\n  io.input(false, [], disableTextFunction, fn, displayFunction)\n\n  return world.SUCCESS_NO_TURNSCRIPTS\n}\n\n// This should be called after each turn to ensure we are at the end of the page and the text box has the focus\nexport function endTurnUI(update) {\n  if (!loc()) return errormsg(\"currentLocation not set (\" + (player() ? 'but player is' : 'nor is player') + \")\")\n  if (settings.panes !== 'none' && update) {\n    // set the lang.exit_list\n    for (let exit of lang.exit_list) {\n      const el = document.querySelector('#exit-' + exit.name)\n      if (!el) continue\n      if (loc().hasExit(exit.name, {excludeScenery:true}) || exit.type === 'nocmd') {\n        el.style.display = 'block'\n      }\n      else {\n        el.style.display = 'none'\n      }\n    }\n    io.updateStatus()\n  }\n  for (let o of io.modulesToUpdate) {\n    o.update(update)\n  }\n  io.updateUIItems()\n  if (settings.updateCustomUI) settings.updateCustomUI()\n\n  io.scrollToEnd()\n  // give focus to command bar\n  if (settings.textInput) { document.querySelector('#textbox').focus(); }\n}\n\nexport function createAdditionalPane(position, title, id, func) {\n  const el = document.querySelector(\"#panes\")\n\n  const div = document.createElement('div');\n  div.id = id + '-outer'\n  div.classList.add(\"pane-div\");\n  div.innerHTML = io.getSidePaneHeadingHTML(title) + '<div id=\"' + id + '\">' + func() + '</div>'\n  el.insertBefore(div, el.children[position])\n  settings.customPaneFunctions[id] = func\n}\n\n// ============  Hidden from creators!  =======================================\n\nexport const io = {\n\n  // Each line that is output is given an id, n plus an id number.\n  nextid:0,\n  // A list of names for items currently world. in the inventory panes\n  currentItemList:[],\n\n  modulesToUpdate:[],\n  modulesToInit:[],\n  modulesToDisable:[],\n  modulesToEnable:[],\n  spoken:false,\n  //False for normal function, true if things should be printed to the same paragraph\n  otnb:false,\n  sameLine:false,\n  slID:\"output\",\n  menuFns:[],\n  keydownFunctions:[],\n\n\n  escapeCodes:{\n    colon:':',\n    lcurly:'{',\n    rcurly:'}',\n    lsquare:'[',\n    rsquare:']',\n    vert:'|',\n    hash:'#',\n  },\n\n  menuFunctions:{\n    showMenu:showMenu,\n    showDropDown:showDropDown,\n    showMenuNumbersOnly:showMenuNumbersOnly,\n    showMenuWithNumbers:showMenuWithNumbers,\n    showMenuDiag:showMenuDiag,\n  },\n\n  showInTab:function(html, title = \"Quest JS Tab\") {\n    const path = location.protocol + '//' + location.pathname.replace('index.html', '')\n    const tab = window.open('about:blank', '_blank')\n    if (!tab) {\n      metamsg(lang.new_tab_failed)\n      return false\n    }\n\n    settings.loadCssFiles(tab.document, path)\n\n    const myScript = tab.document.createElement(\"script\")\n    myScript.setAttribute(\"src\", path + 'lib/_transcript.js')\n    tab.document.head.appendChild(myScript)\n    tab.document.body.innerHTML = html\n    tab.document.title = title\n    tab.document.head.setAttribute('data-favicon', settings.favicon)\n    tab.document.head.setAttribute('data-path', path)\n\n    const link = tab.document.createElement('link')\n    link.id = 'dynamic-favicon'\n    link.rel = 'shortcut icon'\n    link.href = path + settings.favicon\n    tab.document.head.appendChild(link)\n  },\n\n}\n\n// This is used by the various menu functions (not showMenuDiag).\nio.input = function(title, options, disableTextFunction, reactFunction, displayFunction, failFunction) {\n  // Store the values so we can use them later in io.menuResponse\n  io.menuStartId = io.nextid\n  io.menuFns.push(reactFunction)\n  io.menuFailFn = failFunction\n  io.menuOptions = options\n  io.disableTextFunction = disableTextFunction ? disableTextFunction : function(disable) {\n    if (disable) io.disable(3)\n    if (!disable) io.enable()\n  }\n\n  // Skip if unit-testing\n  if (test.testing) {\n    if (test.menuResponseNumber === undefined) {\n      debugmsg(\"Error when testing menu (possibly due to disambiguation?), test.menuResponseNumber = \" + test.menuResponseNumber)\n    }\n    else {\n      let n\n      if (Array.isArray(test.menuResponseNumber)) {\n        n = test.menuResponseNumber.shift()\n        if (test.menuResponseNumber.length === 0) {\n          delete test.menuResponseNumber\n        }\n      }\n      else {\n        n = test.menuResponseNumber\n        delete test.menuResponseNumber\n      }\n      // Sort out the menuResponseNumber before hand in case the response also\n      // uses it - we want it done before that\n      io.menuResponse(n)\n    }\n    return;\n  }\n\n  // Skip if walk-through\n  if (settings.walkthroughMenuResponses.length > 0) {\n    const response = settings.walkthroughMenuResponses.shift()\n    if (typeof response === 'number') {\n      io.menuResponse(response)\n    }\n    else {\n      io.textResponse(response)\n    }\n    return;\n  }\n\n  io.disableTextFunction(true)\n  if (title) msg(title, {}, 'menu-title');\n  displayFunction(options)\n}\n\n// The output system is quite complicated...\n// https://github.com/ThePix/QuestJS/wiki/The-Output-Queue\n\nio.outputQueue = []\nio.outputSuspended = false\n\n// Stops the current pause immediately (no effect if not paused)\nio.unpause = function() {\n  document.querySelector('.continue').remove()\n  io.textBecamesOld()\n  io.outputSuspended = false\n  io.outputFromQueue()\n  if (settings.textInput) document.querySelector('#textbox').focus();\n}\n\nio.addToOutputQueue = function(data) {\n  data.id = io.nextid\n  io.outputQueue.push(data)\n  io.nextid++\n  io.outputFromQueue()\n}\n\nio.forceOutputFromQueue = function() {\n  io.outputSuspended = false\n  io.outputFromQueue()\n}\n\nio.outputFromQueue = function() {\n  if (io.outputSuspended) return\n  if (io.outputQueue.length === 0) {\n    if (!io.disableTextFunction) io.enable()\n    return\n  }\n\n  //if (settings.textInput) document.querySelector('#input').style.display = 'block'\n  const data = io.outputQueue.shift()\n  if (data.action === 'wait' && (!settings.disableWaitInDevMode || settings.playMode !== 'dev')) {\n    io.disable()\n    io.outputSuspended = true\n    //if (settings.textInput) document.querySelector('#input').style.display = 'none'\n    data.tag = 'p'\n    data.onclick=\"io.unpause()\"\n    if (!data.text) data.text = lang.click_to_continue\n    io.print(data)\n  }\n  if (data.action === 'delay' && (!settings.disableWaitInDevMode || settings.playMode !== 'dev')) {\n    log('here')\n    io.disable()\n    io.outputSuspended = true\n    if (data.text) {\n      data.tag = 'p'\n      io.print(data)\n    }\n    setTimeout(io.unpause, data.delay * 1000)\n  }\n  if (data.action === 'output') {\n    const html = io.print(data)\n    io.speak(data.text);\n    saveLoad.transcriptAppend(data);\n    io.outputFromQueue()\n  }\n  if (data.action === 'func') {\n    if (data.func()) io.outputFromQueue()\n  }\n  if (data.action === 'effect') {\n    io.disable()\n    // need a way to handle spoken and transcript here\n    data.effect(data)\n  }\n  if (data.action === 'clear') {\n    document.querySelector('#output').textContent = \"\";\n    io.outputFromQueue()\n  }\n  if (data.action === 'sound') {\n    if (!settings.silent) {\n      const el = document.getElementById(data.name)\n      el.currentTime = 0\n      el.play()\n    }\n  }\n  if (data.action === 'ambient') {\n    for (let el of document.getElementsByTagName('audio')) el.pause()\n    if (!settings.silent && data.name) {\n      const el = document.getElementById(data.name)\n      el.currentTime = 0\n      el.loop = true\n      el.play()\n      if (data.volume) el.volume = data.volume / 10\n    }\n  }\n\n  io.scrollToEnd()\n  if (settings.textInput) document.querySelector('#textbox').focus()\n}\n\nio.allowedHtmlAttrs = ['width', 'height', 'onclick', 'src', 'autoplay' ]\n\nio.print = function(data) {\n  let html\n  let keepSL\n  let slID\n  if (typeof data === 'string') {\n    // noinspection JSUnusedAssignment\n      html = data\n  }\n\n  if (data.html) {\n    html = data.html\n  }\n  else if (!io.sameLine){\n    html = '<' + data.tag + ' id=\"n' + data.id + '\"'\n    if (data.cssClass) html += ' class=\"' + data.cssClass + '\"'\n    for (let s of io.allowedHtmlAttrs) if (data[s]) html += ' ' + s + '=\"' + data[s] + '\"'\n    html += '>' + data.text + \"</\" + data.tag + '>'\n  }\n  else {\n      html = data.text\n  }\n  if (data.destination) {\n    document.querySelector(\"#\" + data.destination).innerHTML = html\n  }\n  else {\n\n      let keepSL = (html.indexOf(\"@@OUTPUTTEXTNOBR@@\") > -1)\n      let slID = \"n\" + (data.id-1)\n      if(keepSL) {\n          html = html.replace(\"@@OUTPUTTEXTNOBR@@\", \"\");\n      }\n      if(io.sameLine) {\n        let last = document.getElementById(slID)\n        last.innerHTML = last.innerHTML + html\n        io.sameLine = false\n      }\n      else {\n        document.querySelector(\"#output\").innerHTML += html\n      }\n      io.sameLine = keepSL;\n\n  }\n\n  return html;\n}\n\nio.typewriterEffect = function(data) {\n  if (!data.position) {\n    document.querySelector(\"#output\").innerHTML += '<' + data.tag + ' id=\"n' + data.id + '\" class=\\\"typewriter\\\"></' + data.tag + '>'\n    data.position = 0\n    data.text = processText(data.text, data.params)\n  }\n  const el = document.querySelector('#n' + data.id)\n  el.innerHTML = data.text.slice(0, data.position) + \"<span class=\\\"typewriter-active\\\">\" + data.text.slice(data.position, data.position + 1) + \"</span>\"\n  data.position++\n  if (data.position <= data.text.length) {\n    io.outputQueue.unshift(data)\n    io.outputSuspended = true\n  }\n  setTimeout(io.forceOutputFromQueue, settings.textEffectDelay)\n}\n\nio.unscrambleEffect = function(data) {\n  // Set up the system\n  if (!data.count) {\n    document.querySelector(\"#output\").innerHTML += '<' + data.tag + ' id=\"n' + data.id + '\" class=\"typewriter\"></' + data.tag + '>'\n    data.count = 0\n    data.text = processText(data.text, data.params)\n    if (!data.pick) data.pick = io.unscamblePick\n    data.mask = ''\n    data.scrambled = ''\n    for (let i = 0; i < data.text.length; i++) {\n      if (data.text.charAt(i) === ' ' && !data.incSpaces) {\n        data.scrambled += ' '\n        data.mask += ' '\n      }\n      else {\n        data.scrambled += data.pick(i)\n        data.mask += 'x'\n        data.count++\n      }\n    }\n  }\n\n  if (data.randomPlacing) {\n    let pos = random.int(0, data.count - 1)\n    let newMask = ''\n    for (let i = 0; i < data.mask.length; i++) {\n      if (data.mask.charAt(i) === ' ') {\n        newMask += ' '\n      }\n      else if (pos === 0) {\n        newMask += ' '\n        pos--\n      }\n      else {\n        newMask += 'x'\n        pos--\n      }\n    }\n    data.mask = newMask\n  }\n  else {\n    data.mask = data.mask.replace('x', ' ')\n  }\n  data.count--\n  document.querySelector(\"#n\" + data.id).innerHTML = io.unscambleScramble(data)\n  if (data.count > 0) {\n    io.outputQueue.unshift(data)\n    io.outputSuspended = true\n  }\n  setTimeout(io.forceOutputFromQueue, settings.textEffectDelay)\n}\n\nio.unscamblePick = function() {\n  let c = String.fromCharCode(random.int(33, 125))\n  return c === '<' ? '~' : c\n}\n\nio.unscambleScramble = function(data) {\n  let s = ''\n  for (let i = 0; i < data.text.length; i++) {\n    s += (data.mask.charAt(i) === ' ' ? data.text.charAt(i) : data.pick(i))\n  }\n  return s\n}\n\nio.cmdlink = function(command, str) {\n  return `<a class=\"cmd-link\" onclick=\"runCmd('${command}')\">${str}</a>`;\n}\n\nio.setTitleAndInit = function(s) {\n  document.title = s\n  for (let o of io.modulesToInit) {\n    o.init()\n  }\n  io.calcMargins()\n}\n\nio.calcMargins = function() {\n  //How much space do we need for images and map?\n  let mapImageWidth = 0\n  if (typeof map !== 'undefined') {\n    if (!settings.hideMap) mapImageWidth = settings.mapWidth\n  }\n  if (typeof imagePane !== 'undefined') {\n    if (!settings.hideImagePane && settings.imageWidth > mapImageWidth) mapImageWidth = settings.imageWidth\n  }\n  document.querySelector('#main').style.marginLeft = '40px'\n  document.querySelector('#main').style.marginRight = '40px'\n\n  // Do we show the side panes?\n  if (settings.panes !== 'none') {\n    const margin = settings.panes === 'left' ? 'margin-left' : 'margin-right'\n    if (io.resizePanesListener.matches) { // If media query matches\n      // hide sidepane\n      document.querySelector('#main').style[margin] = (io.mainGutter) + 'px'\n      document.querySelector('#panes').style.display = 'none'\n    } else {\n      // show sidepane\n      document.querySelector('#main').style[margin] = (io.panesWidth + io.mainGutter) + 'px'\n      document.querySelector('#panes').style.display = 'block'\n    }\n  }\n\n  // Note: As of Jan/22 this takes account of settings.hideMap - but not of whether\n  // the image should be hidden\n  let margin = settings.panes === 'right' ? 'margin-left' : 'margin-right'\n  if (settings.mapImageSide) margin = settings.mapImageSide === 'left' ? 'margin-left' : 'margin-right'\n  if (io.resizeMapImageListener.matches || settings.hideMap) { // If media query matches\n    // hide image\n    document.querySelector('#main').style[margin] = io.mainGutter + 'px'\n    document.querySelector('#quest-image').style.display = 'none'\n    document.querySelector('#quest-map').style.display = 'none'\n  } else {\n    // show image\n    document.querySelector('#main').style[margin] = (mapImageWidth + io.mainGutter) + 'px'\n    document.querySelector('#quest-image').style.display = 'block'\n    document.querySelector('#quest-map').style.display = 'block'\n  }\n}\n\nio.mainGutter = 20\nio.panesWidth = 160\nio.resizePanesListener = window.matchMedia('(max-width: ' + settings.panesCollapseAt + 'px)')\nio.resizeMapImageListener = window.matchMedia('(max-width: ' + settings.mapAndImageCollapseAt + 'px)')\nio.resizePanesListener.addListener(io.calcMargins) // Attach listener function on state changes\nio.resizeMapImageListener.addListener(io.calcMargins) // Attach listener function on state changes\n\n// 0: not disabled at all\n// 1: disable until output is done\n// 2: awaiting special input, eg from menu, including text\n// 3: awaiting special input, eg from menu, excluding text\nio.disableLevel = 0\n\nio.disable = function(level) {\n  if (!level) level = 1\n  if (level <= io.disableLevel) return\n  io.disableLevel = level\n  if (level !== 2) document.querySelector('#input').style.display = 'none'\n  io.setCssByClass('compass-button .dark-body', 'color', '#808080')\n  io.setCssByClass('item', 'color', '#808080')\n  io.setCssByClass('item-action', 'color', '#808080')\n  for (let o of io.modulesToDisable) {\n    o.ioDisable(level)\n  }\n}\n\nio.enable = function() {\n  //log('enable (' + io.disableLevel + ')')\n  if (!io.disableLevel) return\n  io.disableLevel = 0\n  document.querySelector('#input').style.display = 'block'\n  if (settings.panes !== 'none') {\n    io.setCssByClass('compass-button .dark-body', 'color', io.textColour)\n    io.setCssByClass('item', 'color', io.textColour)\n    io.setCssByClass('item-action', 'color', io.textColour)\n  }\n  for (let o of io.modulesToEnable) {\n    o.ioEnable()\n  }\n}\n\n// Call this to reset the interface\n// Used when an input is not recognised and when an error is encountered\n// Ensures input is enabled\nio.reset = function() {\n  io.enable()\n  io.menuFns = []\n  io.keydownFunctions = []\n}\n\nio.startCommand = function() {\n  io.textBecamesOld()\n  // may want to do other stuff here\n}\n\nio.textBecamesOld = function() {\n  io.addClassForClass(\"default-p\", 'old-text')\n  io.addClassForClass(\"default-h\", 'old-text')\n  io.addClassForClass(\"meta\", 'old-text')\n  io.addClassForClass(\"parser\", 'old-text')\n  io.addClassForClass(\"error\", 'old-text')\n}\n\nio.addClassForClass = function(oldClass, newClass) {\n  const collection = document.getElementsByClassName(oldClass)\n  for (const el of collection) el.classList.add(newClass)\n}\n\nio.updateUIItems = function() {\n  if (settings.panes === 'none' || !settings.inventoryPane) { return; }\n\n  for (let inv of settings.inventoryPane) {\n    document.querySelector('#' + inv.alt).textContent = \"\"\n    inv.hasContent = false\n  }\n\n  io.currentItemList = [];\n  for (let key in w) {\n    const item = w[key];\n    for (let inv of settings.inventoryPane) {\n      const loc = inv.getLoc ? inv.getLoc() : null\n      if (inv.test(item) && !item.inventorySkip) {\n        io.appendItem(item, inv.alt, loc, false, inv.highlight ? inv.highlight(item) : 0);\n        inv.hasContent = true\n      }\n    }\n  }\n  if (settings.additionalInv) settings.additionalInv()\n  for (let inv of settings.inventoryPane) {\n    if (!inv.hasContent && inv.noContent) {\n      const s = processText(inv.noContent)\n      document.querySelector('#' + inv.alt).innerHTML = '<div class=\"item-nothing\">' + s + '</div>'\n    }\n  }\n  for (const key in settings.customPaneFunctions) {\n    const el = document.querySelector('#' + key)\n    if (!el) return\n      el.innerHTML = settings.customPaneFunctions[key]()\n  }\n  io.clickItem('')\n};\n\nio.updateStatus = function() {\n  if (settings.panes !== 'none' && settings.statusPane) {\n    //document.querySelector(\"#status-pane\").textContent = \"\"\n    let s = ''\n    for (let st of settings.status) {\n      if (typeof st === \"string\") {\n        if (player()[st] !== undefined) {\n          s += '<tr><td width=\"' + settings.statusWidthLeft + '\">' + sentenceCase(st) + \"</td>\"\n          s += '<td width=\"' + settings.statusWidthRight + '\">' + player()[st] + \"</td></tr>\"\n        }\n        else {\n          s += \"<tr>\" + processText(st) + \"</tr>\"\n        }\n      }\n      else if (typeof st === \"function\") {\n        s += \"<tr>\" + st() + \"</tr>\"\n      }\n    }\n    document.querySelector(\"#status-pane\").innerHTML = s\n  }\n\n  if (settings.toolbar) {\n    io.createToolbar()\n  }\n\n}\n\nio.menuResponse = function(n) {\n  let input = n\n  if (typeof n === 'string' && n.match(/^\\d+$/)) n = parseInt(n) - 1\n  if (typeof n === 'string') {\n    n = io.menuOptions.findIndex(el => typeof el === 'string' ? el.includes(n) : el.alias.includes(n) )\n  }\n\n  // stop disabling input\n  io.disableTextFunction(false)\n  delete io.disableTextFunction\n\n  // stop overriding the parser\n  parser.overrideWith()\n\n  // remove choices from screen\n  for (let i = io.menuStartId; i < io.nextid; i++) document.querySelector('#n' + i).remove()\n\n  // handle bad number\n  if (n === undefined || n >= io.menuOptions[n] || n === -1) {\n    io.menuFailFn(input)\n  }\n\n  // handle good number\n  else {\n    saveLoad.transcriptAppend({cssClass:'menu', text:(io.menuOptions[n].alias ? io.menuOptions[n].alias : io.menuOptions[n]), n:n});\n    const fn = io.menuFns.pop()\n    fn(io.menuOptions[n])\n  }\n  endTurnUI(true);\n  if (settings.textInput) document.querySelector('#textbox').focus()\n};\n\nio.textResponse = function(s) {\n  if (s === undefined) {\n    const el = document.querySelector('#text-dialog')\n    if (el) s = el.value\n  }\n  const el = document.querySelector('#sidepane-menu')\n  // in case walk-through\n  if (el) el.remove()\n\n  // stop disabling input\n  io.enable()\n\n  saveLoad.transcriptAppend({cssClass:'menu', text:s})\n  if (io.menuFns.length) {\n    const fn = io.menuFns.pop()\n    if (fn) fn(s)\n  }\n  endTurnUI(true);\n  if (settings.textInput) document.querySelector('#textbox').focus()\n}\n\n// Used by showMenuNumbersOnly to capture number presses and pass the right menu option to the parser\nio.keydownForMenuFunction = function(e) {\n  const n = parseInt(e.key)\n  if (!isNaN(n) && n <= io.menuOptions.length && n !== 0) {\n    io.menuResponse(n - 1)\n  }\n  // Just ignore other keypresses\n\n  // stopping the typed character appearing in the text field is not easy...\n  // stopPropagation and stopImmediatePropagation did not do it,\n  // even though it seems to happen after this\n  // so just delete it!\n  setTimeout(function() {\n    document.querySelector('#textbox').value = ''\n    document.querySelector('#textbox').focus()\n  }, 10)\n}\n\nio.clickExit = function(dir) {\n  if (io.disableLevel) return\n  let failed = false\n  runCmd(dir)\n}\n\nio.clickItem = function(itemName) {\n  if (io.disableLevel) return\n  if (!itemName) return\n\n  const o = w[itemName]\n  if (o.sidebarButtonVerb) {\n    runCmd(o.sidebarButtonVerb + ' ' + w[itemName].alias)\n    return\n  }\n\n if (io.disableLevel) return;\n  // duplicated items would toggle twice\n  const uniq = [...new Set(io.currentItemList)];\n\n  for (let item of uniq) {\n    for (const el of document.querySelectorAll('.' + item + '-actions')) {\n      if (item === itemName) {\n        el.style.display = el.style.display === 'none' ? 'block' : 'none'\n      }\n      else {\n        el.style.display = 'none'\n      }\n    }\n  }\n};\n\nio.clickItemAction = function(itemName, action) {\n  if (io.disableLevel) return\n  const item = w[itemName];\n  const cmd = action.includes('%') ? action.replace('%', item.alias) : action + ' ' + item.alias\n  runCmd(cmd)\n}\n\n// Add the item to the DIV named htmlDiv\n// The item will be given verbs from its attName attribute\nio.appendItem = function(item, htmlDiv, loc, isSubItem, highlight) {\n  const el = document.querySelector('#' + htmlDiv)\n  io.currentItemList.push(item.name)\n\n  el.innerHTML += io.getItemHtml(item, loc, isSubItem, highlight)\n\n  if (item.container && !item.closed) {\n    if (typeof item.getContents !== 'function') {\n      log(\"WARNING: item flagged as container but no getContents function:\");\n      log(item);\n    }\n    const l = item.getContents(world.SIDE_PANE);\n    for (let el of l) {\n      io.appendItem(el, htmlDiv, item.name, true);\n    }\n  }\n}\n\nio.getItemHtml = function(item, loc, isSubItem, highlight) {\n  if (typeof item.getVerbs !== 'function') return errormsg(\"Item with bad getVerbs: \" + item.name)\n  const verbList = item.getVerbs(loc)\n  if (verbList === undefined) { errormsg(\"No verbs for \" + item.name); console.log(item); }\n\n  let s = '<div id=\"' + item.name + '-item\"><p class=\"item' + (isSubItem ? ' sub-item' : '') + (highlight ? ' highlight-item' + highlight : '') + '\" onclick=\"io.clickItem(\\'' + item.name + '\\')\">' + io.getIcon(item) + item.getListAlias(loc) + \"</p></div>\"\n  for (let verb of verbList) {\n    if (typeof verb === 'string') verb = {name:verb, action:verb}\n    s += '<div class=\"' + item.name + '-actions item-action'\n    if (verb.style) s += ' ' + verb.style\n    s += '\" onclick=\"io.clickItemAction(\\'' + item.name + '\\', \\'' + verb.action + '\\')\" style=\"display: none;\">';\n    s += verb.name;\n    s += '</div>';\n  }\n  return s\n}\n\n// Creates the panes on the left or right\n// Should only be called once, when the page is first built\nio.createPanes = function() {\n  if (!['right', 'left', 'none'].includes(settings.panes)) {\n    console.error('ERROR: Your settings.panes value is \"' + settings.panes + '\". It must be one of \"right\", \"left\" or \"none\" (all lower-case). It is probably set in the file setiings.js.')\n    return\n  }\n\n  document.querySelector('#input').innerHTML = '<span id=\"cursor\">' + settings.cursor + '</span><input type=\"text\" name=\"textbox\" id=\"textbox\" autocomplete=\"off\" />'\n  if (!settings.textInput) document.querySelector('#input').style.display = 'none'\n\n  if (settings.panes === 'none') return\n\n  let html = ''\n\n  if (settings.compassPane) {\n    html += '<div class=\"pane-div\">'\n    html += '<table id=\"compass-table\">'\n    for (let i = 0; i < 3; i++) {\n      html += '<tr>'\n      // noinspection PointlessArithmeticExpressionJS\n      html += io.writeExit(0 + 5 * i)\n      html += io.writeExit(1 + 5 * i)\n      html += io.writeExit(2 + 5 * i)\n      html += '<td></td>'\n      html += io.writeExit(3 + 5 * i);\n      html += io.writeExit(4 + 5 * i);\n      html += '</tr>'\n    }\n    html += '</table>'\n    html += '</div>'\n  }\n\n  if (settings.statusPane) {\n    html += '<div class=\"pane-div\">'\n    html += io.getSidePaneHeadingHTML(settings.statusPane)\n    html += '<table id=\"status-pane\">'\n    html += '</table>'\n    html += '</div>'\n  }\n\n  if (settings.inventoryPane) {\n    for (let inv of settings.inventoryPane) {\n      html += '<div class=\"pane-div\">'\n      html += io.getSidePaneHeadingHTML(inv.name)\n      html += '<div class=\"item-list\" id=\"' + inv.alt + '\">'\n      html += '</div>'\n      html += '</div>'\n    }\n  }\n\n  html += '<div class=\"pane-div-finished\">'\n  html += lang.game_over_html\n  html += '</div>'\n  html += '</div>'\n\n  const el = document.createElement(\"div\")\n  el.innerHTML = html\n  el.setAttribute(\"id\", \"panes\")\n  el.classList.add('side-panes')\n  el.classList.add('side-panes-' + settings.panes)\n  el.classList.add('panes-narrow')\n\n  const referenceNode = document.querySelector('#main')\n  referenceNode.parentNode.insertBefore(el, referenceNode.nextSibling)\n\n\n\n  io.panesWidth = document.querySelector('.side-panes').clientWidth\n\n  if (settings.customUI) settings.customUI();\n};\n\nio.getSidePaneHeadingHTML = function(title) {\n  if (!title) return ''\n  const id = verbify(title) + '-side-pane-heading'\n  let s = '<h4 class=\"side-pane-heading\" id=' + id + '>' + title\n  if (settings.collapsibleSidePanes) {\n    s += ' <i class=\"fas fa-eye\" onclick=\"io._clickSidePaneHeading(\\'' + id + '\\')\"></i>'\n  }\n  s += '</h4>'\n  return s\n}\n\nio._clickSidePaneHeading = function(id) {\n  const el = document.querySelector(\"#\" + id).nextElementSibling\n  if (el.style.display === 'none') {\n    el.style.display = 'block'\n  }\n  else {\n    el.style.display = 'none'\n  }\n\n  //alert('here' + e.target.classList)\n}\n\nio.writeExit = function(n) {\n  let html = '<td class=\"compass-button\" title=\"' + sentenceCase(lang.exit_list[n].name) + '\">'\n  html += '<span class=\"compass-button\" id=\"exit-' + lang.exit_list[n].name\n  html += '\" onclick=\"io.clickExit(\\'' + lang.exit_list[n].name + '\\')\">'\n  html += settings.symbolsForCompass ? io.displayIconsCompass(lang.exit_list[n]) : lang.exit_list[n].abbrev\n  html += '</span></td>'\n  return html\n};\n\n// Gets the command with the given name\nio.getCommand = function(name) {\n    return commands.find(function (el) {\n      return el.name === name;\n  });\n};\n\nio.msgInputText = function(s) {\n  if (saveLoad.transcript && !s.match(lang.noWalkthroughRegex)) saveLoad.transcriptWalkthrough.push('    \"' + s + '\",')\n  if (!settings.cmdEcho || s === '') return\n  document.querySelector(\"#output\").innerHTML += '<p id=\"n' + io.nextid + '\" class=\"input-text\">&gt; ' + s + \"</p>\"\n  io.nextid++\n  io.speak(s, true)\n}\n\nio.savedCommands = ['help'];\nio.savedCommandsPos = 0;\n\n// Called from scriptOnLoad in _settings.js, if there are no more scripts to load\nio.init = function() {\n  settings.performanceLog('Start io.onload')\n  io.createPanes()\n  if (settings.playMode === 'play') window.oncontextmenu = function () { return false }\n  document.querySelector(\"#fileDialog\").onchange = saveLoad.loadGameAsFile\n\n  document.addEventListener('keydown', function(event){\n    if (io.keydownFunctions.length) {\n      const fn = io.keydownFunctions.pop()\n      fn(event)\n      return\n    }\n    const keycode = (event.keyCode ? event.keyCode : event.which)\n    if (keycode === 13){\n      // enter\n      if (event.ctrlKey && (settings.playMode === 'dev' || settings.playMode === 'beta')) {\n        parser.parse(\"script show\")\n      }\n      else {\n        const s = document.querySelector('#textbox').value;\n        io.msgInputText(s);\n        if (s) {\n          if (io.savedCommands[io.savedCommands.length - 1] !== s && !io.doNotSaveInput) {\n            io.savedCommands.push(s)\n          }\n          io.savedCommandsPos = io.savedCommands.length;\n          parser.parse(s);\n          if (io.doNotEraseLastCommand) {\n            io.doNotEraseLastCommand = false\n          }\n          else {\n            document.querySelector('#textbox').value = ''\n          }\n        }\n      }\n    }\n    if (keycode === 38){\n      // up arrow\n      io.savedCommandsPos -= 1;\n      if (io.savedCommandsPos < 0) { io.savedCommandsPos = 0; }\n      document.querySelector('#textbox').value = io.savedCommands[io.savedCommandsPos]\n      // Get cursor to end of text\n      const el = document.querySelector('#textbox')\n      if (el.setSelectionRange) {\n        setTimeout(function() {el.setSelectionRange(9999, 9999); }, 0);\n      }\n      else if (typeof el.selectionStart == \"number\") {\n        el.selectionStart = el.selectionEnd = el.value.length;\n      }\n      else if (typeof el.createTextRange != \"undefined\") {\n        el.focus();\n        let range = el.createTextRange();\n        range.collapse(false);\n        range.select();\n      }\n    }\n    if (keycode === 40){\n      // down arrow\n      io.savedCommandsPos += 1;\n      if (io.savedCommandsPos >= io.savedCommands.length) { io.savedCommandsPos = io.savedCommands.length - 1; }\n      document.querySelector('#textbox').value = io.savedCommands[io.savedCommandsPos]\n    }\n    if (keycode === 27){\n      // ESC\n      document.querySelector('#textbox').value = ''\n    }\n    if (!io.disableLevel) {\n      // disable most special keys - all but the enter key\n      if (settings.customKeyResponses) {\n        if (settings.customKeyResponses(keycode, event)) return false\n      }\n      for (let exit of lang.exit_list) {\n        if (exit.key && exit.key === keycode) {\n          io.msgInputText(exit.name);\n          parser.parse(exit.name);\n          document.querySelector('#textbox').value = ''\n          event.stopPropagation();\n          event.preventDefault();\n          return false;\n        }\n      }\n      if (keycode === 123 && settings.playMode === 'play') return false\n      if (event.ctrlKey && event.shiftKey && keycode === 73 && settings.playMode === 'play') return false\n      if (event.ctrlKey && event.shiftKey && keycode === 74 && settings.playMode === 'play') return false\n\n      if (keycode === 96 && (settings.playMode === 'dev' || settings.playMode === 'beta')){\n        if (event.ctrlKey && event.altKey) {\n          parser.parse(\"wt b\")\n        }\n        else if (event.altKey) {\n          parser.parse(\"wt a\")\n        }\n        else if (event.ctrlKey) {\n          parser.parse(\"wt c\")\n        }\n        else {\n          parser.parse(\"test\")\n        }\n        setTimeout(function() { document.querySelector('#textbox').value = '' }, 1);\n      }\n      if (keycode === 90 && event.ctrlKey) {\n        parser.parse(\"undo\")\n      }\n    }\n  })\n  if (settings.panes !== 'none') io.textColour = document.querySelector(\".side-panes\").style.color\n  /*if (settings.soundFiles) {\n    const main = document.querySelector('#main')\n    for (let el of settings.soundFiles) {\n      main.innerHTML += '<audio id=\"' + el + '\" src=\"' + settings.soundsFolder + el + settings.soundsFileExt + '\"/>'\n    }\n  }*/\n  settings.performanceLog('UI built')\n  endTurnUI(true)\n  settings.performanceLog('endTurnUI completed')\n\n  if (document.querySelector('#loading')) document.querySelector('#loading').remove()\n  if (!settings.suppressTitle) msgHeading(settings.title, 2)\n  if (settings.subtitle) msgHeading(settings.subtitle, 3)\n  io.setTitleAndInit(settings.title)\n  if (settings.playMode === 'beta') lang.betaTestIntro()\n  settings.performanceLog('Title/intro printed')\n\n  if (settings.startingDialogEnabled) {\n    settings.setUpDialog()\n    setTimeout(function() {\n      if (settings.startingDialogInit) settings.startingDialogInit()\n    }, 10)\n  }\n  else {\n    if (settings.startingDialogAlt) settings.startingDialogAlt()\n    settings.delayStart = false\n    world.begin()\n  }\n  settings.performanceLog('End io.onload')\n}\n\nio.synth = window.speechSynthesis;\nio.voice = null;\nio.voice2 = null;\n\nio.speak = function(str, altVoice){\n  if (!io.spoken) return\n  if (!io.voice) {\n    io.voice = io.synth.getVoices().find(function(el) {\n      return /UK/.test(el.name) && /Female/.test(el.name);\n    });\n    if (!io.voice) io.voice = io.synth.getVoices()[0];\n  }\n  if (!io.voice2) {\n    io.voice2 = io.synth.getVoices().find(function(el) {\n      return /UK/.test(el.name) && /Male/.test(el.name);\n    });\n    if (!io.voice2) io.voice2 = io.synth.getVoices()[0];\n  }\n\n  const utterThis = new SpeechSynthesisUtterance(str);\n  utterThis.onend = function (event) {\n    //console.log('SpeechSynthesisUtterance.onend');\n  }\n  utterThis.onerror = function (event) {\n    //console.error('SpeechSynthesisUtterance.onerror: ' + event.name);\n  }\n  utterThis.voice = altVoice ? io.voice2 : io.voice;\n  // I think these can vary from 0 to 2\n  utterThis.pitch = 1;\n  utterThis.rate = 1;\n  io.synth.speak(utterThis);\n};\n\nio.dialogShowing = false;\n//@DOC\n// Appends an HTML DIV, with the given title and content,\n// and shows it as a dialog. Used by the transcript\n// (and really only useful for displaying data).\nio.showHtml = function(title, html) {\n  if (io.dialogShowing) return false;\n  document.querySelector('body').innerHTML += '<div id=\"showHtml\" title=\"' + title + '\">' + html + '</div>'\n  io.dialogShowing = true;\n  document.querySelector(\"#showHtml\").dialog({\n    width: 860,\n    close:function() { document.querySelector(\"#showHtml\").remove(); io.dialogShowing = false; },\n  });\n  return true;\n}\n\nio.finish = function(giveOptions) {\n  settings.finished = {\n    textInput:settings.textInput,\n    inputDisplay:document.querySelector('#input').style.display,\n  }\n  io.finished = true\n  settings.textInput = false\n  document.querySelector('#input').style.display = 'none'\n  if (settings.panes !== 'none') {\n    for (const el of document.querySelectorAll('.pane-div')) {\n      el.style.display = 'none'\n    }\n    document.querySelector('.pane-div-finished').style.display = 'block'\n  }\n  for (const el of settings.afterFinish) el()\n  if (settings.finishMetaComment) metamsg(settings.finishMetaComment)\n  if (saveLoad.transcriptExists()) metamsg(lang.transcript_finish)\n  if (giveOptions) metamsg(lang.finish_options)\n}\n\nio.unfinish = function() {\n  settings.finished = {\n    textInput:settings.textInput,\n    inputDisplay:document.querySelector('#input').style.display,\n  }\n  io.finished = false\n  settings.textInput = settings.finished.textInput\n  document.querySelector('#input').style.display = settings.finished.inputDisplay\n  if (settings.panes !== 'none') {\n    for (const el of document.querySelectorAll('.pane-div')) {\n      el.style.display = 'block'\n    }\n    document.querySelector('.pane-div-finished').style.display = 'none'\n  }\n  settings.finished = false\n}\n\nio.toggleDarkMode = function() {\n  settings.darkModeActive = !settings.darkModeActive\n  if (settings.darkModeActive) {\n    document.querySelector('body').classList.add(\"dark-body\")\n  }\n  else {\n    document.querySelector('body').classList.remove(\"dark-body\")\n  }\n  if (settings.afterDarkToggle) settings.afterDarkToggle()\n  if (settings.panes !== 'none') io.textColour = document.querySelector(\".side-panes\").style.color\n  metamsg(lang.done_msg)\n  return world.SUCCESS_NO_TURNSCRIPTS\n}\n\nio.toggleAutoScrollMode = function() {\n  settings.autoscroll = !settings.autoscroll\n  if (settings.afterAutoScrollToggle) settings.afterAutoScrollToggle()\n  metamsg(lang.done_msg)\n  return world.SUCCESS_NO_TURNSCRIPTS\n}\n\nio.toggleNarrowMode = function() {\n  settings.narrowMode = (settings.narrowMode + 1) % 3\n  document.querySelector('body').classList.remove(\"narrow-body\")\n  document.querySelector('body').classList.remove(\"very-narrow-body\")\n  if (settings.narrowMode === 1) document.querySelector('body').classList.add(\"narrow-body\")\n  if (settings.narrowMode === 2) document.querySelector('body').classList.add(\"very-narrow-body\")\n  if (settings.afterNarrowChange) settings.afterNarrowChange()\n  metamsg(lang.done_msg)\n  return world.SUCCESS_NO_TURNSCRIPTS\n}\n\nio.togglePlainFontMode = function() {\n  settings.plainFontModeActive = !settings.plainFontModeActive\n  if (settings.plainFontModeActive) {\n    document.querySelector('body').classList.add(\"plain-font-body\")\n  }\n  else {\n    document.querySelector('body').classList.remove(\"plain-font-body\")\n  }\n  if (settings.afterPlainFontToggle) settings.afterPlainFontToggle()\n  metamsg(lang.done_msg)\n  return world.SUCCESS_NO_TURNSCRIPTS\n}\n\n// If the element starts off displayed, you will probably needs to explicitly set display to block for it\n// otherwise this will assume it is not\nio.toggleDisplay = function(el) {\n  if (typeof el === 'string') el = document.querySelector(el)\n  el.style.display = el.style.display === 'block' ? 'none' : 'block'\n}\n\nio.copyTextToClipboard = function(text) {\n  // from: https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript\n  const textArea = document.createElement(\"textarea\")\n  // Place in top-left corner of screen regardless of scroll position.\n  textArea.style.position = 'fixed';\n  textArea.style.top = '0';\n  textArea.style.left = '0';\n\n  // Styling just in case it gets displayed to make is as unobstrusive as possible\n  textArea.style.width = '2em';\n  textArea.style.height = '2em';\n  textArea.style.padding = '0';\n  textArea.style.border = 'none';\n  textArea.style.outline = 'none';\n  textArea.style.boxShadow = 'none';\n  textArea.style.background = 'transparent';\n\n  textArea.value = text;\n  document.body.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n\n  try {\n    const successful = document.execCommand('copy');\n    metamsg('Copying text command was ' + (successful ? 'successful' : 'unsuccessful'));\n  } catch (err) {\n    metamsg('Oops, unable to copy');\n  }\n\n  document.body.removeChild(textArea);\n}\n\nio.getIcon = function(item) {\n  if (settings.iconsFolder === false) return ''\n  if (!item.icon) return ''\n  if (item.icon() === '') return ''\n  return '<img src=\"' + settings.iconsFolder + (settings.darkModeActive ? 'l_' : 'd_') + item.icon() + '.png\"  alt=\"Icon\"/>'\n}\n\nio.againOrOops = function(isAgain) {\n  if (io.savedCommands.length === 0) {\n    metamsg(lang.again_not_available)\n    return world.FAILED\n  }\n  io.savedCommands.pop() // do not save AGAIN/OOPS\n  if (isAgain) {\n    parser.parse(io.savedCommands[io.savedCommands.length - 1])\n  }\n  else {\n    document.querySelector('#textbox').value = io.savedCommands[io.savedCommands.length - 1]\n    io.doNotEraseLastCommand = true\n  }\n  return world.SUCCESS_NO_TURNSCRIPTS;\n}\n\nio.setCssByClass = function(name, prop, val) {\n  for (const el of document.querySelectorAll('.' + name)) el.style[prop] = val\n}\n\n// Display Icons for compass\nio.displayIconsCompass = function(exit) {\n  const datatransform = exit.rotate ? ' style=\"transform: rotate(40deg)\"' : ''\n  return '<i class=\"fas ' + exit.symbol + '\"' + datatransform + '></i>';\n}\n\nio.scrollToEnd = function() {\n  if (settings.autoscroll) window.scrollTo(0,document.getElementById('main').scrollHeight);\n}\n\nio.getDropDownText = function(name) {\n  const el = document.querySelector('#' + name)\n  return el.options[el.selectedIndex].text\n}\n\n// Create Toolbar\nio.createToolbar = function() {\n  let el = document.querySelector(\"#toolbar\")\n  if (!el) {\n    const div = document.createElement('div')\n    div.setAttribute(\"id\", \"toolbar\")\n    //div.classList.add('button')\n    div.classList.add('toolbar')\n    document.querySelector(\"body\").insertBefore(div, document.querySelector(\"#main\"))\n    el = document.querySelector(\"#toolbar\")\n    document.querySelector(\"#main\").style.paddingTop = '30px'\n    document.querySelector(\"#panes\").style.top = '36px'\n  }\n\n  let html = \"\";\n  html += '<div class=\"left\">' + io.getToolbarHTML(settings.toolbar[0]) + '</div>'\n  html += '<div class=\"middle\">' + io.getToolbarHTML(settings.toolbar[1]) + '</div>'\n  html += '<div class=\"right\">' + io.getToolbarHTML(settings.toolbar[2]) + '</div>'\n  el.innerHTML = html\n}\n\nio.getToolbarHTML = function(data = {}) {\n  if (data.room) return sentenceCase(lang.getName(w[player().loc], { article:DEFINITE }))\n  if (data.title) return '<b><i>' + settings.title + '</i></b>'\n  if (data.content) return data.content()\n  if (data.buttons) {\n    let s = ''\n    for (let el of data.buttons) {\n      const js = el.cmd ? \"runCmd('\" + el.cmd + \"')\" : el.onclick\n      s += ` <a class=\"link\" onclick=\"if (!io.disableLevel)${js}\"><i class=\"fas ${el.icon}\" title=\"${el.title}\"></i></a>`;\n    }\n    return s\n  }\n  return ''\n}\n\nio.focus = function(el) {\n  if (typeof el === 'string') el = document.querySelector('#' + el)\n  if (el !== document.activeElement) el.focus()\n}\n\nio.showHintSheet = function() {\n  let html = '<div id=\"main\"><div id=\"inner\"><div id=\"output\"><h2 class=\"default-h default-h2\">' + lang.hintSheet + '</h2>'\n  html += \"<p class=\\\"default-p\\\">\" + lang.hintSheetIntro + \"</p>\"\n\n  const words = []\n  for (const el of settings.hintSheetData) words.push(...el.a.split(' '))\n  const uniqueWords = [...new Set(words)].sort()\n\n  for (const el of settings.hintSheetData) {\n    html += \"<p class=\\\"default-p\\\"><i>\" + el.q + '</i>&nbsp;&nbsp;&nbsp; ' + io.encodeWords(el.a, uniqueWords) + \"</p>\"\n  }\n\n  html += \"<hr/><table><tr>\"\n\n  for (let i = 0; i < uniqueWords.length; i++) {\n    html += \"<td>\" + i + \" - \" + uniqueWords[i] + \"</td>\"\n\n    if (i % 6 === 5) html += \"</tr><tr>\"\n  }\n\n  html += '</tr><table></div></div></div>'\n  io.showInTab(html, lang.hintSheet)\n}\n\nio.encodeWords = function(s, words) {\n  const numbers = []\n  for (const word of s.split(' ')) numbers.push(words.indexOf(word))\n  return numbers.map(el => '' + el).join(' ')\n}\n","// noinspection JSUnusedGlobalSymbols\n\n\"use strict\";\n\nimport {\n    errormsg, failedmsg, falsemsg, metamsg, printOrRun,\n    sentenceCase, player, loc,\n    lang, parser, world, w, settings, commands, game\n} from '../index.js';\n\n// Should all be language neutral (except the inspect function, which is just for debugging)\n\nexport class Cmd {\n  constructor(name, hash) {\n    this.name = name\n    this.objects = []\n    this.rules = []\n    for (let key in hash) this[key] = hash[key]\n\n    this.attName = this.attName ? this.attName : this.name.toLowerCase()\n    for (let key in this.objects) {\n      if (!this.objects[key].attName) this.objects[key].attName = this.attName\n    }\n    if (!this.regex && !this.regexes) {\n      this.regexes = Array.isArray(lang.regex[this.name]) ? lang.regex[this.name] : [lang.regex[this.name]]\n    }\n    if (this.withScript) this.script = this.scriptWith\n    commands.push(this)\n  }\n\n\n  default(options) { falsemsg(this.defmsg, options) }\n\n  // Is this command a match at the most basic level (ignoring items, etc)\n  // Also resets the command\n  _test(s) {\n    if (!Array.isArray(this.regexes)) console.log(this)  // it will crash in the next line!\n    for (let regex of this.regexes) {\n      if (regex instanceof RegExp) {\n        if (regex.test(s)) {\n          this.tmp = {regex:regex, mod:{}}\n          return true\n        }\n      }\n      else {\n        if (regex.regex.test(s)) {\n          this.tmp = {regex:regex.regex, mod:regex.mod}\n          return true\n        }\n      }\n    }\n    this.tmp = { score: parser.NO_MATCH }\n    return false\n  }\n\n  // A command can have an array of regexs, \"antiRegexes\" that will stop the command getting matched\n  _testNot(s) {\n    if (!Array.isArray(this.antiRegexes)) return true\n    for (let regex of this.antiRegexes) {\n      if (regex instanceof RegExp) {\n        if (regex.test(s)) {\n          return false\n        }\n      }\n      else {\n        if (regex.regex.test(s)) {\n          return false\n        }\n      }\n    }\n    return true\n  }\n\n\n  // We want to see if this command is a good match to the string\n  // This will involve trying to matching objects, according to the\n  // values in the command\n  //\n  // The results go in an attribute, tmp, that should have alreadsy been set by test,\n  // and is a dictionary containing:\n  //\n  // objectTexts - the matched object names from the player input\n  // objects - the matched objects (lists of lists ready to be disabiguated)\n  // score - a rating of how good the match is\n  // error - a string to report why it failed, if it did!\n  //\n  // objects will be an array for each object role (so PUT HAT IN BOX is two),\n  // of arrays for each object listed (so GET HAT, TEAPOT AND GUN is three),\n  // of possible object matches (so GET HAT is four if there are four hats in the room)\n  //\n  // score is a rating for how well this command matches, based on the score attribute\n  // of the command itself (defaults to 10); if zero or less, this is an error\n  //\n  // If this does give an error, it is only reported if no command is a success\n  //\n  // The parameter mod allows us to change how this is done, eg if the nouns are reversed\n  // and will have been set in test\n  matchItems(s) {\n    if (!this._test(s)) return\n    if (!this._testNot(s)) return\n\n\n    parser.msg(\"---------------------------------------------------------\");\n    parser.msg(\"* Looking at candidate: \" + this.name);\n\n    // this is a temporary set of data used while we parser one input\n    this.tmp.objectTexts = [];\n    this.tmp.objects = [];\n    this.tmp.score = this.score ? this.score : 10\n    this.tmp.error = undefined\n\n    // Array of item positions corresponding to capture groups in the regex\n    let arr = this.tmp.regex.exec(s)\n    arr.shift()  // first element is the whole match, so discard\n    if (this.tmp.mod.reverse) arr = arr.reverse()\n    if (this.tmp.mod.reverseNotFirst) {\n      const first = arr.shift()\n      arr = arr.reverse()\n      arr.unshift(first)\n    }\n    if (this.tmp.mod.func) arr = this.tmp.mod.func(arr)\n\n    parser.msg(\"..Base score: \" + this.tmp.score);\n\n    for (let i = 0; i < arr.length; i++) {\n      const cmdParams = this.objects[i]\n      if (!cmdParams) {\n        errormsg(\"The command \\\"\" + this.name + \"\\\" seems to have an error. It has more capture groups than there are elements in the 'objects' attribute.\", true)\n        return false\n      }\n      if (arr[i] === undefined) {\n        errormsg(\"The command \\\"\" + this.name + \"\\\" seems to have an error. It has captured undefined. This is probably an issue with the command's regular expression.\", true)\n        return false\n      }\n      let score = 0;\n      this.tmp.objectTexts.push(arr[i])\n\n      if (cmdParams.special) {\n        // this capture group has been flagged to be special\n        const specialError = parser.specialText[cmdParams.special].error(arr[i], cmdParams)\n        if (specialError) return this.setError(parser.BAD_SPECIAL, specialError)\n        const special = parser.specialText[cmdParams.special].exec(arr[i], cmdParams)\n        if (special !== false) this.tmp.objects.push(special)\n        score = 1\n        if (special.name) {\n          parser.msg(\"-> special match object found: \" + special.name)\n        }\n        else {\n          parser.msg(\"-> special match found: \" + special)\n        }\n      }\n\n      else if (lang.all_regex.test(arr[i]) || lang.all_exclude_regex.test(arr[i])) {\n        // Handle ALL and ALL BUT\n        this.tmp.all = true\n        if (!cmdParams.multiple) return this.setError(parser.DISALLOWED_MULTIPLE, lang.no_multiples_msg)\n        if (!cmdParams.scope) console.log(\"WARNING: Command without scope - \" + this.name)\n\n        let scope = parser.getScope(cmdParams)\n        let exclude = [player()];\n\n        // anything flagged as scenery should be excluded\n        for (let item of scope) {\n          if (item.scenery || item.excludeFromAll) exclude.push(item)\n        }\n\n        if (lang.all_exclude_regex.test(arr[i])) {\n          // if this is ALL BUT we need to remove some things from the list\n          // excludes must be in isVisible\n          // if it is ambiguous or not recognised it does not get added to the list\n          let s = arr[i].replace(lang.all_exclude_regex, \"\").trim();\n          const objectNames = s.split(lang.joiner_regex).map(function(el){ return el.trim(); });\n          for (let s in objectNames) {\n            const items = parser.findInList(s, world.scope);\n            if (items.length === 1) exclude.push(items[0])\n          }\n        }\n        scope = scope.filter(el => !exclude.includes(el))\n        if (scope.length > 1 && !cmdParams.multiple) return this.setError(parser.DISALLOWED_MULTIPLE, lang.no_multiples_msg)\n        if (scope.length === 0) return this.setError(parser.NONE_FOR_ALL, this.nothingForAll ? this.nothingForAll : lang.nothing_msg)\n        score = 2\n        this.tmp.objects.push(scope.map(el => [el]))\n      }\n\n      else {\n        if (!cmdParams.scope) {\n          console.warn(\"No scope found in command. This may be because the scope specified does not exist; check the spelling. The command in question is:\")\n          log(this)\n          parser.msg(\"ERROR: No scope\")\n          return null\n        }\n        const scope = parser.getScopes(cmdParams)\n        parser.matchToNames(arr[i], scope, cmdParams, this.tmp)\n        if (this.tmp.score === parser.NO_OBJECT) {\n          this.tmp.error = this.noobjecterror(this.tmp.error_s, i)\n          if (this.objects.length > 1) this.tmp.score += 10\n          parser.msg(\"Result score is (no object): \" + this.tmp.score)\n          return\n        }\n      }\n      parser.msg(\"...Adding to the score: \" + score)\n      parser.msg(\"Result score is: \" + this.tmp.score)\n      this.tmp.score += score\n    }\n  }\n\n\n  // If this has multiple parts the error probably takes priority\n  // GET STUFF -> assume item\n  // FILL JUG WITH WATER -> assume fluid\n  setError(score, msg) {\n    this.tmp.error = msg\n    this.tmp.score = score\n    if (this.objects.length > 1) this.tmp.score += 10\n    parser.msg(\"Match failed: \" + this.tmp.score + \" (\" + msg + \")\")\n  }\n\n\n\n  // This is the default script for commands\n  // Assumes objects is:\n  // optionally the verb, a string\n  // an array of objects - each object will have the attribute indicated by attName called\n  // optionally an array of one object\n  script(objects) {\n    let success = false;\n    let suppressEndturn = false\n    let verb\n    if (typeof objects[0] === 'string') verb = objects.shift()\n    let secondItem\n    if (objects.length > 1) secondItem = objects[1][0]\n    const multiple = objects[0] && (objects[0].length > 1 || parser.currentCommand.all)\n    if (objects[0].length === 0) {\n      metamsg(lang.nothing_msg)\n      return world.FAILED;\n    }\n    for (let i = 0; i < objects[0].length; i++) {\n      const options = {multiple:multiple, verb:verb, char:player(), item:objects[0][i], secondItem:secondItem}\n      const obj = objects[0][i]\n      if (!obj[this.attName + '_count']) obj[this.attName + '_count'] = 0\n      if (!obj[this.attName]) {\n        this.default(options)\n      }\n      else {\n        let result = this.processCommand(options);\n        if (result === world.SUCCESS_NO_TURNSCRIPTS) {\n          suppressEndturn = true;\n          result = true;\n        }\n        if (result) obj[this.attName + '_count']++\n        success = result || success;\n      }\n    }\n    if (success) {\n      return (this.noTurnscripts || suppressEndturn ? world.SUCCESS_NO_TURNSCRIPTS : world.SUCCESS);\n    }\n    else {\n      return world.FAILED;\n    }\n  }\n\n\n  // This is the second script for commands\n  // Assumes a verb and two objects; the verb may or may not be the first object\n  scriptWith(objects) {\n    let success = false;\n    let suppressEndturn = false\n    let verb\n    if (objects.length > 2) verb = objects.shift()\n    const multiple = objects[0] && (objects[0].length > 1 || parser.currentCommand.all)\n    if (objects[0].length === 0) {\n      metamsg(lang.nothing_msg)\n      return world.FAILED;\n    }\n    for (let i = 0; i < objects[0].length; i++) {\n      const options = {multiple:multiple, verb:verb, char:player(), item:objects[0][i], with:objects[1][0]}\n      if (!objects[0][i][this.attName]) {\n        this.default(options)\n      }\n      else {\n        let result = this.processCommand(options);\n        if (result === world.SUCCESS_NO_TURNSCRIPTS) {\n          suppressEndturn = true;\n          result = true;\n        }\n        success = result || success;\n      }\n    }\n    if (success) {\n      return (this.noTurnscripts || suppressEndturn ? world.SUCCESS_NO_TURNSCRIPTS : world.SUCCESS);\n    }\n    else {\n      return world.FAILED;\n    }\n  }\n\n  processCommand(options) {\n    for (let rule of this.rules) {\n      if (typeof rule !== \"function\") {\n        errormsg(\"Failed to process command '\" + this.name + \"' as one of its rules is not a function.\")\n        console.log (this)\n        console.log (rule)\n      }\n      if (!rule(this, options)) return false\n    }\n    let result = printOrRun(options.char, options.item, this.attName, options);\n    if (typeof result !== \"boolean\" && result !== world.SUCCESS_NO_TURNSCRIPTS) {\n      // Assume the author wants to return true from the verb\n      result = true;\n    }\n    return result;\n  };\n\n  noobjecterror(s) {\n    return lang.object_unknown_msg(s)\n  }\n\n\n}\n\n// Use only for NPC commands that you are not giving your\n// own custom script attribute. Commands must be an order to a single\n// NPC in the form verb-object.\nexport class NpcCmd extends Cmd {\n  constructor(name, hash) {\n    super(name, hash)\n    if (!this.cmdCategory) this.cmdCategory = name\n  }\n\n  script(objects) {\n    const npc = objects[0][0];\n    if (!npc.npc) {\n      failedmsg(lang.not_npc, {char:player(), item:npc})\n      return world.FAILED\n    }\n    let success = false, handled;\n    if (objects.length !== 2) {\n      errormsg(\"The command \" + name + \" is trying to use a facility for NPCs to do it, but there is no object list; this facility is only for commands in the form verb-object.\")\n      return world.FAILED\n    }\n    const multiple = (objects[1].length > 1 || parser.currentCommand.all)\n    for (let obj of objects[1]) {\n      const options = {multiple:multiple, char:npc, item:obj}\n      if (!npc.getAgreement(this.cmdCategory, {item:obj, cmd:this})) continue\n      if (!obj[this.attName]) {\n        this.default(options)\n      }\n      else {\n        let result = this.processCommand({multiple:multiple, char:npc, item:obj})\n        if (result === world.SUCCESS_NO_TURNSCRIPTS) {\n          result = true;\n        }\n        success = result || success\n      }\n    }\n    if (success) {\n      npc.pause()\n      return (this.noTurnscripts ? world.SUCCESS_NO_TURNSCRIPTS : world.SUCCESS)\n    }\n    else {\n      return world.FAILED\n    }\n  }\n}\n\nexport class ExitCmd extends Cmd {\n  constructor(name, dir, hash) {\n    super(name, hash)\n    this.exitCmd = true\n    this.dir = dir\n    this.objects = [{special:'ignore'}, {special:'ignore'}, ]\n  }\n\n  script(objects) {\n    if (!loc().hasExit(this.dir)) {\n      const exitObj = lang.exit_list.find(el => el.name === this.dir )\n      if (exitObj.not_that_way) return failedmsg(exitObj.not_that_way, {char:player(), dir:this.dir})\n      if (settings.customNoExitMsg) return failedmsg(settings.customNoExitMsg(player(), this.dir))\n      return failedmsg(lang.not_that_way, {char:player(), dir:this.dir})\n    }\n    else {\n      const ex = loc().getExit(this.dir);\n      if (typeof ex === \"object\"){\n        if (!player().testMove(ex)) {\n          return world.FAILED\n        }\n        if (typeof ex.use !== 'function') {\n          errormsg(\"Exit's 'use' attribute is not a function (or does not exist).\")\n          console.log(\"Bad exit:\")\n          console.log(ex)\n          return world.FAILED\n        }\n        const flag = ex.use(player(), ex)\n        if (typeof flag !== \"boolean\") {\n          console.warn(\"Exit on \" + loc().name + \" failed to return a Boolean value, indicating success or failure; assuming success\")\n          return world.SUCCESS\n        }\n        if (flag && ex.extraTime) game.elapsedTime += ex.extraTime\n        return flag ? world.SUCCESS : world.FAILED\n      }\n      else {\n        errormsg(\"Unsupported type for direction\")\n        return world.FAILED\n      }\n    }\n  }\n}\n\nexport class NpcExitCmd extends Cmd {\n  constructor(name, dir, hash) {\n    super(name, hash)\n    this.exitCmd = true\n    this.dir = dir\n    this.objects = [{scope:parser.isHere, attName:\"npc\"}, {special:'ignore'}, {special:'ignore'}, ]\n  }\n\n  script(objects) {\n    const npc = objects[0][0]\n    if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n    if (!loc().hasExit(this.dir)) {\n      const exitObj = lang.exit_list.find(el => el.name === this.dir )\n      if (exitObj.not_that_way) return failedmsg(exitObj.not_that_way, {char:npc, dir:this.dir})\n      return failedmsg(lang.not_that_way, {char:npc, dir:this.dir})\n    }\n\n    const ex = loc().getExit(this.dir)\n    if (typeof ex !== \"object\"){\n      errormsg(\"Unsupported type for direction\")\n      return world.FAILED\n    }\n\n    if (npc.testMove && !npc.testMove(ex)) return world.FAILED\n    if (!npc.getAgreement(\"Go\", {exit:ex})) return world.FAILED\n\n    const flag = ex.use(npc, ex)\n    if (flag) npc.pause()\n    return flag ? world.SUCCESS : world.FAILED;\n  }\n}\n\n  // Should be called during the initialisation process\nexport function initCommands() {\n    // #todo - clarify why contents of collection newCmds are updated, but never queried\n  // noinspection JSMismatchedCollectionQueryUpdate\n    const newCmds = [];\n  for (let el of commands) {\n    if (!el.regexes) {\n      el.regexes = [el.regex]\n    }\n    if (el.npcCmd) {\n      if (!Array.isArray(el.regexes)) console.log(el)\n      //console.log(\"creating NPC command for \" + el.name)\n      const regexAsStr = el.regexes[0].source.substr(1);  // lose the ^ at the start, as we will prepend to it\n      const objects = el.objects.slice();\n      objects.unshift({scope:parser.isHere, attName:\"npc\"});\n\n      const data = {\n        objects:objects,\n        attName:el.attName,\n        default:el.default,\n        defmsg:el.defmsg,\n        rules:el.rules,\n        score:el.score,\n        cmdCategory:el.cmdCategory ? el.cmdCategory : el.name,\n        forNpc:true,\n      };\n\n      const cmd = new NpcCmd(\"Npc\" + el.name, data)\n      cmd.regexes = []\n      for (let key in lang.tell_to_prefixes) {\n        cmd.regexes.push(new RegExp(\"^\" + lang.tell_to_prefixes[key] + regexAsStr))\n      }\n      if (el.useThisScriptForNpcs) cmd.script = el.script\n      cmd.scope = []\n      for (let el2 of el.objects) {\n        cmd.scope.push(el2 === parser.isHeld ? parser.isHeldByNpc : el2)\n        cmd.scope.push(el2 === parser.isWorn ? parser.isWornByNpc : el2)\n      }\n      newCmds.push(cmd)\n    }\n  }\n\n  //commands.push.apply(commands, newCmds); ?????\n\n  for (let el of lang.exit_list) {\n    if (el.type !== 'nocmd') {\n      let regex = \"(\" + lang.go_pre_regex + \")(\" + el.name + \"|\" + el.abbrev.toLowerCase()\n      if (el.alt) { regex += \"|\" + el.alt; }\n      regex += \")$\";\n      new ExitCmd(\"Go\" + sentenceCase(el.name), el.name, { regexes:[new RegExp(\"^\" + regex)] })\n\n      const regexes = []\n      for (let key in lang.tell_to_prefixes) {\n        regexes.push(new RegExp(\"^\" + lang.tell_to_prefixes[key] + regex))\n      }\n      new NpcExitCmd(\"NpcGo\" + sentenceCase(el.name) + \"2\", el.name, { regexes:regexes })\n    }\n  }\n}\n\n// Useful in a command's script when handling NPCs as well as the player\nexport function extractChar(cmd, objects) {\n  let char;\n  if (cmd.forNpc) {\n    char = objects[0][0];\n    if (!char.npc) {\n      failedmsg(lang.not_npc, {char:player(), item:char});\n      return world.FAILED;\n    }\n    objects.shift();\n  }\n  else {\n    char = player();\n  }\n  return char\n}\n\nexport function findCmd(name) {\n  return commands.find(el => el.name === name)\n}\n\nexport function testCmd(name, s) {\n  const cmd = findCmd(name)\n  cmd.matchItems(s)\n  log(cmd.tmp)\n  metamsg(\"See results in console (F12)\")\n}\n\nexport const cmdRules = {};\n\n// Item's location is the char and it is not worn\ncmdRules.isHeldNotWorn = function(cmd, options) {\n  if (!options.item.getWorn() && options.item.isAtLoc(options.char.name, world.PARSER)) return true\n\n  if (options.item.isAtLoc(options.char.name, world.PARSER)) return falsemsg(lang.already_wearing, options)\n\n  if (options.item.loc) {\n    options.holder = w[options.item.loc]\n    if (options.holder.npc || options.holder.player) return falsemsg(lang.char_has_it, options)\n  }\n\n  return falsemsg(lang.not_carrying, options)\n}\n\n// Item's location is the char and it is worn\ncmdRules.isWorn = function(cmd, options) {\n  if (options.item.getWorn() && options.item.isAtLoc(options.char.name, world.PARSER)) return true\n\n  if (options.item.isAtLoc(options.char.name, world.PARSER)) return falsemsg(lang.not_wearing, options)\n\n  if (options.item.loc) {\n    options.holder = w[options.item.loc];\n    if (options.holder.npc || options.holder.player) return falsemsg(lang.char_has_it, options)\n  }\n\n  return falsemsg(lang.not_carrying, options)\n}\n\n// Item's location is the char\ncmdRules.isHeld = function(cmd, options) {\n  if (options.item.isAtLoc(options.char.name, world.PARSER)) return true\n\n  if (options.item.loc) {\n    options.holder = w[options.item.loc]\n    if (options.holder.npc || options.holder.player) return falsemsg(lang.char_has_it, options)\n  }\n\n  return falsemsg(lang.not_carrying, options)\n}\n\n// Item's location is the char's location or the char\n// or item is reachable, but not held by someone else\ncmdRules.isPresent = function(cmd, options) {\n  if (options.item.isAtLoc(options.char.loc, world.PARSER)) return true\n  if (options.item.isAtLoc(options.char.name, world.PARSER)) return true\n\n  if (options.item.loc) {\n    options.holder = w[options.item.loc]\n    // Has a specific location and held by someone\n    if (options.holder.npc || options.holder.player) return falsemsg(lang.char_has_it, options)\n  }\n\n  if (options.item.scopeStatus.canReach) return true\n\n  return falsemsg(lang.not_here, options)\n}\n\n// Item's location is the char's location or the char\n// or item is reachable, but not held by someone else\ncmdRules.isHere = function(cmd, options) {\n  if (options.item.isAtLoc(options.char.loc, world.PARSER)) return true\n\n  if (options.item.loc) {\n    options.holder = w[options.item.loc]\n    if (options.already && options.holder === options.char) return falsemsg(lang.already_have, options)\n    if (options.holder.npc || options.holder.player) return falsemsg(lang.char_has_it, options)\n  }\n\n  if (options.item.scopeStatus.canReach || options.item.multiLoc) return true\n  return falsemsg(lang.not_here, options)\n}\n\n// Used by take to note if player already holding\ncmdRules.isHereAlready = function(cmd, options) {\n  options.already = true\n  return cmdRules.isHere(cmd, options)\n}\n\n// In this location or held by this char, or in a container (used by eg TAKE)\ncmdRules.isPresentOrContained = function(cmd, options) {\n  // use parser functions here as we do not want messages at this point\n\n  if (!options.item.isAtLoc) log(options.item.name)\n  if (!options.char) log(cmd.name)\n\n  if (options.item.isAtLoc(options.char.name, world.PARSER)) return true;\n  if (parser.isHere(options.item)) return true;\n\n  if (options.item.loc) {\n    options.holder = w[options.item.loc]\n    if (options.holder && (options.holder.npc || options.holder.player)) return falsemsg(lang.char_has_it, options)\n  }\n  if (parser.isContained(options.item)) return true;\n  return falsemsg(lang.not_here, options)\n}\n\ncmdRules.testManipulate = function(cmd, options) {\n  return options.char.testManipulate(options.item, cmd.name);\n\n}\n\ncmdRules.canTalkTo = function(cmd, options) {\n  if (!options.char.testTalk(options.item)) return false\n  if (!options.item.npc && !options.item.talker && !options.item.player) return falsemsg(lang.not_able_to_hear, options)\n  return true\n}\n\ncmdRules.testPosture = function(cmd, options) {\n  return options.char.testPosture(cmd.name);\n\n}\n","// noinspection JSUnusedGlobalSymbols\n\n\"use strict\";\n\n// Should all be language neutral\n\nimport {\n    array, w, lang, random, saveLoad, util, world, settings,\n    errormsg, failedmsg, msg, NULL_FUNC, sentenceCase, player, Exit, game, parser\n} from \"../index.js\";\n\nexport const DEFAULT_OBJECT = {\n  pronouns: lang.pronouns.thirdperson,\n\n  isLocatedAt:function(loc) { return loc === this.loc },\n\n  isApparentTo:function(situation) {\n    if (settings.defaultIsApparentTo) return settings.defaultIsApparentTo(situation)\n\n    if (situation === world.LOOK && this.scenery) return false\n    if (situation === world.SIDE_PANE && this.scenery && !settings.showSceneryInSidePanes) return false\n    return !(situation === world.SIDE_PANE && this.player);\n\n  },\n\n  isAtLoc:function(loc, situation) {\n    if (typeof loc !== \"string\") loc = loc.name\n    if (!w[loc] && !settings.placeholderLocations.includes(loc)) {\n      errormsg(\"The location name `\" + loc + \"`, does not match anything in the game.\")\n    }\n    if (!this.isLocatedAt(loc, situation)) return false\n    return this.isApparentTo(situation)\n  },\n\n  isHere:function() {\n    return this.isAtLoc(player().loc);\n  },\n\n  isHeld:function() {\n    return this.isAtLoc(player().name);\n  },\n\n  isHeldBy:function(char) {\n    return this.isAtLoc(char.name);\n  },\n\n  isUltimatelyHeldBy:function(obj) {\n    let o = this\n    while (o.loc) {\n      if (o.loc === obj.name) return true\n      if (!o.loc) return errormsg(\"isUltimatelyHeldBy has found that the object \\\"\" + o.name + \"\\\" has no loc attribute (or it is set to undefined/false/null/0), and so has failed. If this is a takeable item you may need to give it a custom isUltimatelyHeldBy function. If this is a takeable container or surface, it needs a loc attribute set.\")\n      if (!w[o.loc] && !settings.placeholderLocations.includes(o.loc)) {\n        return errormsg(\"isUltimatelyHeldBy has found that the object \\\"\" + o.name + \"\\\" has its \\\"loc\\\" attribute set to \\\"\" + o.loc + \"\\\"), which does not exist, and so has failed.\")\n      }\n      o = w[o.loc]\n    }\n    return false\n  },\n\n  isHereOrHeld:function() {\n    return this.isHere() || this.isHeld();\n  },\n\n  isHereOrHeldBy:function(char) {\n    return this.isHere() || this.isHeldBy(char);\n  },\n\n  countAtLoc:function(loc) {\n    if (typeof loc !== \"string\") loc = loc.name;\n    return this.isAtLoc(loc) ? 1 : 0;\n  },\n\n  scopeSnapshot:function(mode) {\n    if (this.scopeStatus['done' + mode]) return  // already done this one\n\n    if (Object.keys(this.scopeStatus).length === 0) world.scope.push(this)\n\n    this.scopeStatus['can' + mode] = true  // set the value\n    this.scopeStatus['done' + mode] = true\n\n    if (!this.getContents && !this.componentHolder) return // no lower levels so done\n\n    let l\n    if (this.getContents) {\n      // this is a container, so get the contents\n\n      // cannot see or reach contents and not flagged is a visible room, and not the player, so abort\n      if (!this['can' + mode + 'ThroughThis']() && !this.scopeStatus['room' + mode] && this !== player()) return\n      l = this.getContents(world.PARSER)\n    }\n    else {\n      // this has components, so get them\n      l = []\n      for (let key in w) {\n        if (w[key].loc === this.name) l.push(w[key]);\n      }\n    }\n    for (let el of l) {\n      // go through them\n      el.scopeSnapshot(mode)\n    }\n  },\n\n  canReachThroughThis:() => false,\n  canSeeThroughThis:() => false,\n  afterTakeOut:NULL_FUNC,\n  afterDropIn:NULL_FUNC,\n  testTalkPlayer:() => false,\n  getExits:function() { return []; },\n  hasExit:dir => false,\n  getWorn:() => false,\n  saveLoadExcludedAtts:[],\n\n\n  moveToFrom:function(options, toLoc, fromLoc) {\n    util.setToFrom(options, toLoc, fromLoc)\n    if (options.fromLoc === undefined) options.fromLoc = this.loc\n    if (options.fromLoc === options.toLoc) return\n\n    if (!w[options.fromLoc] && !settings.placeholderLocations.includes(options.fromLoc)) {\n      errormsg(\"The location name `\" + options.fromLoc + \"`, does not match anything in the game.\")\n    }\n    if (!w[options.toLoc] && !settings.placeholderLocations.includes(options.toLoc)) {\n      errormsg(\"The location name `\" + options.toLoc + \"`, does not match anything in the game.\")\n    }\n\n    this.loc = options.toLoc\n    options.item = this\n    if (!settings.placeholderLocations.includes(options.fromLoc)) w[options.fromLoc].afterTakeOut(options)\n    if (!settings.placeholderLocations.includes(options.toLoc)) w[options.toLoc].afterDropIn(options)\n    if (this.afterMove !== undefined) this.afterMove(options)\n    if (options.toLoc === player().name && this.afterTake !== undefined) this.afterTake(options)\n  },\n\n  afterLoad:NULL_FUNC,\n\n  afterLoadForTemplate:function() {\n    this.afterLoad();\n  },\n\n  beforeSave:NULL_FUNC,\n\n  beforeSaveForTemplate:function() {\n    this.beforeSave();\n  },\n\n  getSaveString:function() {\n    this.beforeSaveForTemplate()\n    let s = this.getSaveStringPreamble()\n    for (let key in this) {\n      if (typeof this[key] !== \"function\") {\n        if (!this.saveLoadExclude(key)) {\n          s += saveLoad.encode(key, this[key]);\n        }\n      }\n    }\n    return s\n  },\n\n  getSaveStringPreamble:function(item) {\n    return \"Object=\"\n  },\n\n  saveLoadExclude:function(att) {\n    if (typeof this[att] === 'function') return true\n    if (typeof this[att] === 'object' && !Array.isArray(this[att])) return true\n    if (this[att] instanceof Exit) return true\n    if (array.hasMatch(settings.saveLoadExcludedAtts, att)) return true\n    return array.hasMatch(this.saveLoadExcludedAtts, att);\n\n  },\n\n\n  setAlias:function(alias, options = {}) {\n    if (this.synonyms && this.alias) this.synonyms.push(this.alias)\n    this.alias = alias\n    this.listAlias = options.listAlias ? options.listAlias : sentenceCase(alias)\n    this.properNoun = options.properNoun === undefined ? /^[A-Z]/.test(this.alias) : options.properNoun\n    if (this.room) this.headingAlias = options.headingAlias ? options.headingAlias : settings.getDefaultRoomHeading(this)\n    this.parserOptionsSet = false\n    this.pluralAlias = options.pluralAlias ? options.pluralAlias : lang.getPlural(alias)\n    this.properNoun = options.properNoun === undefined ? /^[A-Z]/.test(this.alias) : options.properNoun\n  },\n\n\n  eventActive:false,\n  eventCountdown:0,\n  eventIsActive:function() { return this.eventActive},\n  endTurn:function(turn) { this.doEvent(turn) },\n  doEvent:function(turn) {\n    //console.log(\"this=\" + this.name);\n    // Not active, so stop\n    if (!this.eventIsActive()) return;\n    // Countdown running, so stop\n    if (this.eventCountdown > 1) {\n      this.eventCountdown--;\n      return;\n    }\n    // If there is a condition and it is not met, stop\n    //console.log(\"this=\" + this.name);\n    if (this.eventCondition && !this.eventCondition(turn)) return;\n    if (typeof this.eventScript !== 'function') log(\"About to call eventScrip on the object '\" + this.name + \"', but it will throw an exception because there is no such function!\")\n    this.eventScript(turn);\n    if (typeof this.eventPeriod === \"number\") {\n      this.eventCountdown = this.eventPeriod;\n    }\n    else {\n      this.eventActive = false;\n    }\n  },\n};\n\nexport const DEFAULT_ROOM = {\n  room:true,\n  beforeEnter:NULL_FUNC,\n  beforeFirstEnter:NULL_FUNC,\n  afterEnter:NULL_FUNC,\n  afterEnterIf:{},\n  afterEnterIfFlags:'',\n  afterFirstEnter:NULL_FUNC,\n  afterExit:NULL_FUNC,\n  visited:0,\n\n  lightSource:() => world.LIGHT_FULL,\n\n  isAtLoc:function(loc, situation) { return situation === world.PARSER && loc === this.name },\n\n  description:function() {\n    for (let line of settings.roomTemplate) {\n      msg(line);\n    }\n    return true;\n  },\n\n  examine:function() {\n    msg('{hereDesc}')\n    return true\n  },\n\n  darkDesc:() => msg(lang.it_is_dark),\n\n  getContents: util.getContents,\n\n  getExit:function(dir) {\n    return this[dir]\n  },\n\n  hasExit:function(dir, options) {\n    if (options === undefined) options = {}\n    if (!this[dir]) return false\n    if (options.excludeAlsoDir && this[dir].isAlsoDir) return false\n    if (options.excludeLocked && this[dir].isLocked()) return false\n    if (options.excludeScenery && this[dir].scenery) return false\n    if (game.dark && !this[dir].illuminated) return false\n    return !this[dir].isHidden()\n  },\n\n  getExitObjs:function(options) {\n    if (options === undefined) options = {};\n    const list = []\n    if (options.excludeAlsoDir === undefined) options.excludeAlsoDir = true\n    for (let exit of lang.exit_list) {\n      if (this.hasExit(exit.name, options)) {\n        list.push(exit)\n      }\n    }\n    return list\n  },\n\n  getExits:function(options) {\n    return this.getExitObjs(options).map(el => this.getExit(el.name))\n  },\n\n  getExitDirs:function(options) {\n    return this.getExits(options).map(el => el.dir)\n  },\n\n  // returns null if there are no exits\n  getRandomExit:function(options) { return random.fromArray(this.getExits(options)) },\n\n  findExit:function(dest, options) {\n    if (typeof dest === \"object\") dest = dest.name;\n    for (let exit of lang.exit_list) {\n      if (this.hasExit(exit.name, options) && this[exit.name].name === dest) {\n        return this.getExit(exit.name)\n      }\n    }\n    return null;\n  },\n\n  // Lock or unlock the exit indicated\n  // Returns false if the exit does not exist or is not an Exit object\n  // Returns true if successful\n  setExitLock:function(dir, locked) {\n    if (!this[dir]) return false\n    this['exit_locked_' + dir] = locked\n    return true\n  },\n\n  isExitLocked:function(dir) {\n    return this['exit_locked_' + dir]\n  },\n\n  // Hide or unhide the exit indicated\n  // Returns false if the exit does not exist or is not an Exit object\n  // Returns true if successful\n  setExitHide:function(dir, hidden) {\n    if (!this[dir]) return false\n    this['exit_hidden_' + dir] = hidden\n    return true\n  },\n\n  isExitHidden:function(dir) {\n    return this['exit_hidden_' + dir]\n  },\n\n  // Returns an exit going TO this room. If sent \"west\", it will return the exit from the room to the west, to this room\n  // which will probably be east, but may not\n  getReverseExit:function(dir) {\n    const dest = this[dir]\n    return dest.findExit(this)\n  },\n\n  // Used for GO IN HOUSE, CLIMB UP TREE, GO THROUGH PORTAL, etc.\n  // dir should be one of 'In', 'Out', 'Up', 'Down', Through' - case sensitive\n  goItem:function(obj, dir, char) {\n    const att = 'go' + dir + 'Direction'\n    if (!char) char = player()\n    if (!obj[att]) return failedmsg(lang['cannot_go_' + dir.toLowerCase()], {item:obj, char:char})\n    if (!this[obj[att]]) return errormsg(\"Trying to 'go \" + dir.toLowerCase() + \"' using unknown exit '\" + obj[att] + \"' for \" + this.name)\n    return this[obj[att]].use(char) ? world.SUCCESS : world.FAILED\n  }\n\n//\n\n\n};\n\nexport const DEFAULT_ITEM = {\n  lightSource:() => world.LIGHT_NONE,\n  icon:() => \"\",\n  testKeys:(char, toLock) => false,\n  getListAlias:function(loc) { return this.listAlias },\n\n  getVerbs:function() {\n    const verbList = []\n    //console.log('verbs for ' + this.name)\n    //console.log('count ' + this.verbFunctions.length)\n    //console.log(verbList)\n    for (let f of this.verbFunctions) f(this, verbList)\n\n    //console.log(verbList)\n    if (player() && !this.isAtLoc(player().name)) {\n      if (this.hereVerbs) {\n        for (let s of this.hereVerbs) verbList.push(s)\n      }\n    }\n    else if (this.getWorn()) {\n      if (this.wornVerbs) {\n        for (let s of this.wornVerbs) verbList.push(s)\n      }\n    }\n    else {\n      if (this.heldVerbs) {\n        for (let s of this.heldVerbs) verbList.push(s)\n      }\n    }\n    if (this.verbFunction) this.verbFunction(verbList)\n    return verbList;\n  },\n\n  transform:function(item) {\n    item.loc = this.loc\n    delete this.loc\n    for (const key in w) {\n      if (w[key].loc === this.name) w[key].loc = item.name\n    }\n    for (const key in parser.pronouns) {\n      if (parser.pronouns[key] === this) parser.pronouns[key] = item\n    }\n  },\n};\n","var x=String;\nvar create=function() {return {isColorSupported:false,reset:x,bold:x,dim:x,italic:x,underline:x,inverse:x,hidden:x,strikethrough:x,black:x,red:x,green:x,yellow:x,blue:x,magenta:x,cyan:x,white:x,gray:x,bgBlack:x,bgRed:x,bgGreen:x,bgYellow:x,bgBlue:x,bgMagenta:x,bgCyan:x,bgWhite:x}};\nmodule.exports=create();\nmodule.exports.createColors = create;\n","export default {}","'use strict'\n\nlet pico = require('picocolors')\n\nlet terminalHighlight = require('./terminal-highlight')\n\nclass CssSyntaxError extends Error {\n  constructor(message, line, column, source, file, plugin) {\n    super(message)\n    this.name = 'CssSyntaxError'\n    this.reason = message\n\n    if (file) {\n      this.file = file\n    }\n    if (source) {\n      this.source = source\n    }\n    if (plugin) {\n      this.plugin = plugin\n    }\n    if (typeof line !== 'undefined' && typeof column !== 'undefined') {\n      if (typeof line === 'number') {\n        this.line = line\n        this.column = column\n      } else {\n        this.line = line.line\n        this.column = line.column\n        this.endLine = column.line\n        this.endColumn = column.column\n      }\n    }\n\n    this.setMessage()\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, CssSyntaxError)\n    }\n  }\n\n  setMessage() {\n    this.message = this.plugin ? this.plugin + ': ' : ''\n    this.message += this.file ? this.file : '<css input>'\n    if (typeof this.line !== 'undefined') {\n      this.message += ':' + this.line + ':' + this.column\n    }\n    this.message += ': ' + this.reason\n  }\n\n  showSourceCode(color) {\n    if (!this.source) return ''\n\n    let css = this.source\n    if (color == null) color = pico.isColorSupported\n    if (terminalHighlight) {\n      if (color) css = terminalHighlight(css)\n    }\n\n    let lines = css.split(/\\r?\\n/)\n    let start = Math.max(this.line - 3, 0)\n    let end = Math.min(this.line + 2, lines.length)\n\n    let maxWidth = String(end).length\n\n    let mark, aside\n    if (color) {\n      let { bold, red, gray } = pico.createColors(true)\n      mark = text => bold(red(text))\n      aside = text => gray(text)\n    } else {\n      mark = aside = str => str\n    }\n\n    return lines\n      .slice(start, end)\n      .map((line, index) => {\n        let number = start + 1 + index\n        let gutter = ' ' + (' ' + number).slice(-maxWidth) + ' | '\n        if (number === this.line) {\n          let spacing =\n            aside(gutter.replace(/\\d/g, ' ')) +\n            line.slice(0, this.column - 1).replace(/[^\\t]/g, ' ')\n          return mark('>') + aside(gutter) + line + '\\n ' + spacing + mark('^')\n        }\n        return ' ' + aside(gutter) + line\n      })\n      .join('\\n')\n  }\n\n  toString() {\n    let code = this.showSourceCode()\n    if (code) {\n      code = '\\n\\n' + code + '\\n'\n    }\n    return this.name + ': ' + this.message + code\n  }\n}\n\nmodule.exports = CssSyntaxError\nCssSyntaxError.default = CssSyntaxError\n","'use strict'\n\nmodule.exports.isClean = Symbol('isClean')\n\nmodule.exports.my = Symbol('my')\n","'use strict'\n\nconst DEFAULT_RAW = {\n  colon: ': ',\n  indent: '    ',\n  beforeDecl: '\\n',\n  beforeRule: '\\n',\n  beforeOpen: ' ',\n  beforeClose: '\\n',\n  beforeComment: '\\n',\n  after: '\\n',\n  emptyBody: '',\n  commentLeft: ' ',\n  commentRight: ' ',\n  semicolon: false\n}\n\nfunction capitalize(str) {\n  return str[0].toUpperCase() + str.slice(1)\n}\n\nclass Stringifier {\n  constructor(builder) {\n    this.builder = builder\n  }\n\n  stringify(node, semicolon) {\n    /* c8 ignore start */\n    if (!this[node.type]) {\n      throw new Error(\n        'Unknown AST node type ' +\n          node.type +\n          '. ' +\n          'Maybe you need to change PostCSS stringifier.'\n      )\n    }\n    /* c8 ignore stop */\n    this[node.type](node, semicolon)\n  }\n\n  document(node) {\n    this.body(node)\n  }\n\n  root(node) {\n    this.body(node)\n    if (node.raws.after) this.builder(node.raws.after)\n  }\n\n  comment(node) {\n    let left = this.raw(node, 'left', 'commentLeft')\n    let right = this.raw(node, 'right', 'commentRight')\n    this.builder('/*' + left + node.text + right + '*/', node)\n  }\n\n  decl(node, semicolon) {\n    let between = this.raw(node, 'between', 'colon')\n    let string = node.prop + between + this.rawValue(node, 'value')\n\n    if (node.important) {\n      string += node.raws.important || ' !important'\n    }\n\n    if (semicolon) string += ';'\n    this.builder(string, node)\n  }\n\n  rule(node) {\n    this.block(node, this.rawValue(node, 'selector'))\n    if (node.raws.ownSemicolon) {\n      this.builder(node.raws.ownSemicolon, node, 'end')\n    }\n  }\n\n  atrule(node, semicolon) {\n    let name = '@' + node.name\n    let params = node.params ? this.rawValue(node, 'params') : ''\n\n    if (typeof node.raws.afterName !== 'undefined') {\n      name += node.raws.afterName\n    } else if (params) {\n      name += ' '\n    }\n\n    if (node.nodes) {\n      this.block(node, name + params)\n    } else {\n      let end = (node.raws.between || '') + (semicolon ? ';' : '')\n      this.builder(name + params + end, node)\n    }\n  }\n\n  body(node) {\n    let last = node.nodes.length - 1\n    while (last > 0) {\n      if (node.nodes[last].type !== 'comment') break\n      last -= 1\n    }\n\n    let semicolon = this.raw(node, 'semicolon')\n    for (let i = 0; i < node.nodes.length; i++) {\n      let child = node.nodes[i]\n      let before = this.raw(child, 'before')\n      if (before) this.builder(before)\n      this.stringify(child, last !== i || semicolon)\n    }\n  }\n\n  block(node, start) {\n    let between = this.raw(node, 'between', 'beforeOpen')\n    this.builder(start + between + '{', node, 'start')\n\n    let after\n    if (node.nodes && node.nodes.length) {\n      this.body(node)\n      after = this.raw(node, 'after')\n    } else {\n      after = this.raw(node, 'after', 'emptyBody')\n    }\n\n    if (after) this.builder(after)\n    this.builder('}', node, 'end')\n  }\n\n  raw(node, own, detect) {\n    let value\n    if (!detect) detect = own\n\n    // Already had\n    if (own) {\n      value = node.raws[own]\n      if (typeof value !== 'undefined') return value\n    }\n\n    let parent = node.parent\n\n    if (detect === 'before') {\n      // Hack for first rule in CSS\n      if (!parent || (parent.type === 'root' && parent.first === node)) {\n        return ''\n      }\n\n      // `root` nodes in `document` should use only their own raws\n      if (parent && parent.type === 'document') {\n        return ''\n      }\n    }\n\n    // Floating child without parent\n    if (!parent) return DEFAULT_RAW[detect]\n\n    // Detect style by other nodes\n    let root = node.root()\n    if (!root.rawCache) root.rawCache = {}\n    if (typeof root.rawCache[detect] !== 'undefined') {\n      return root.rawCache[detect]\n    }\n\n    if (detect === 'before' || detect === 'after') {\n      return this.beforeAfter(node, detect)\n    } else {\n      let method = 'raw' + capitalize(detect)\n      if (this[method]) {\n        value = this[method](root, node)\n      } else {\n        root.walk(i => {\n          value = i.raws[own]\n          if (typeof value !== 'undefined') return false\n        })\n      }\n    }\n\n    if (typeof value === 'undefined') value = DEFAULT_RAW[detect]\n\n    root.rawCache[detect] = value\n    return value\n  }\n\n  rawSemicolon(root) {\n    let value\n    root.walk(i => {\n      if (i.nodes && i.nodes.length && i.last.type === 'decl') {\n        value = i.raws.semicolon\n        if (typeof value !== 'undefined') return false\n      }\n    })\n    return value\n  }\n\n  rawEmptyBody(root) {\n    let value\n    root.walk(i => {\n      if (i.nodes && i.nodes.length === 0) {\n        value = i.raws.after\n        if (typeof value !== 'undefined') return false\n      }\n    })\n    return value\n  }\n\n  rawIndent(root) {\n    if (root.raws.indent) return root.raws.indent\n    let value\n    root.walk(i => {\n      let p = i.parent\n      if (p && p !== root && p.parent && p.parent === root) {\n        if (typeof i.raws.before !== 'undefined') {\n          let parts = i.raws.before.split('\\n')\n          value = parts[parts.length - 1]\n          value = value.replace(/\\S/g, '')\n          return false\n        }\n      }\n    })\n    return value\n  }\n\n  rawBeforeComment(root, node) {\n    let value\n    root.walkComments(i => {\n      if (typeof i.raws.before !== 'undefined') {\n        value = i.raws.before\n        if (value.includes('\\n')) {\n          value = value.replace(/[^\\n]+$/, '')\n        }\n        return false\n      }\n    })\n    if (typeof value === 'undefined') {\n      value = this.raw(node, null, 'beforeDecl')\n    } else if (value) {\n      value = value.replace(/\\S/g, '')\n    }\n    return value\n  }\n\n  rawBeforeDecl(root, node) {\n    let value\n    root.walkDecls(i => {\n      if (typeof i.raws.before !== 'undefined') {\n        value = i.raws.before\n        if (value.includes('\\n')) {\n          value = value.replace(/[^\\n]+$/, '')\n        }\n        return false\n      }\n    })\n    if (typeof value === 'undefined') {\n      value = this.raw(node, null, 'beforeRule')\n    } else if (value) {\n      value = value.replace(/\\S/g, '')\n    }\n    return value\n  }\n\n  rawBeforeRule(root) {\n    let value\n    root.walk(i => {\n      if (i.nodes && (i.parent !== root || root.first !== i)) {\n        if (typeof i.raws.before !== 'undefined') {\n          value = i.raws.before\n          if (value.includes('\\n')) {\n            value = value.replace(/[^\\n]+$/, '')\n          }\n          return false\n        }\n      }\n    })\n    if (value) value = value.replace(/\\S/g, '')\n    return value\n  }\n\n  rawBeforeClose(root) {\n    let value\n    root.walk(i => {\n      if (i.nodes && i.nodes.length > 0) {\n        if (typeof i.raws.after !== 'undefined') {\n          value = i.raws.after\n          if (value.includes('\\n')) {\n            value = value.replace(/[^\\n]+$/, '')\n          }\n          return false\n        }\n      }\n    })\n    if (value) value = value.replace(/\\S/g, '')\n    return value\n  }\n\n  rawBeforeOpen(root) {\n    let value\n    root.walk(i => {\n      if (i.type !== 'decl') {\n        value = i.raws.between\n        if (typeof value !== 'undefined') return false\n      }\n    })\n    return value\n  }\n\n  rawColon(root) {\n    let value\n    root.walkDecls(i => {\n      if (typeof i.raws.between !== 'undefined') {\n        value = i.raws.between.replace(/[^\\s:]/g, '')\n        return false\n      }\n    })\n    return value\n  }\n\n  beforeAfter(node, detect) {\n    let value\n    if (node.type === 'decl') {\n      value = this.raw(node, null, 'beforeDecl')\n    } else if (node.type === 'comment') {\n      value = this.raw(node, null, 'beforeComment')\n    } else if (detect === 'before') {\n      value = this.raw(node, null, 'beforeRule')\n    } else {\n      value = this.raw(node, null, 'beforeClose')\n    }\n\n    let buf = node.parent\n    let depth = 0\n    while (buf && buf.type !== 'root') {\n      depth += 1\n      buf = buf.parent\n    }\n\n    if (value.includes('\\n')) {\n      let indent = this.raw(node, null, 'indent')\n      if (indent.length) {\n        for (let step = 0; step < depth; step++) value += indent\n      }\n    }\n\n    return value\n  }\n\n  rawValue(node, prop) {\n    let value = node[prop]\n    let raw = node.raws[prop]\n    if (raw && raw.value === value) {\n      return raw.raw\n    }\n\n    return value\n  }\n}\n\nmodule.exports = Stringifier\nStringifier.default = Stringifier\n","'use strict'\n\nlet Stringifier = require('./stringifier')\n\nfunction stringify(node, builder) {\n  let str = new Stringifier(builder)\n  str.stringify(node)\n}\n\nmodule.exports = stringify\nstringify.default = stringify\n","'use strict'\n\nlet { isClean, my } = require('./symbols')\nlet CssSyntaxError = require('./css-syntax-error')\nlet Stringifier = require('./stringifier')\nlet stringify = require('./stringify')\n\nfunction cloneNode(obj, parent) {\n  let cloned = new obj.constructor()\n\n  for (let i in obj) {\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) {\n      /* c8 ignore next 2 */\n      continue\n    }\n    if (i === 'proxyCache') continue\n    let value = obj[i]\n    let type = typeof value\n\n    if (i === 'parent' && type === 'object') {\n      if (parent) cloned[i] = parent\n    } else if (i === 'source') {\n      cloned[i] = value\n    } else if (Array.isArray(value)) {\n      cloned[i] = value.map(j => cloneNode(j, cloned))\n    } else {\n      if (type === 'object' && value !== null) value = cloneNode(value)\n      cloned[i] = value\n    }\n  }\n\n  return cloned\n}\n\nclass Node {\n  constructor(defaults = {}) {\n    this.raws = {}\n    this[isClean] = false\n    this[my] = true\n\n    for (let name in defaults) {\n      if (name === 'nodes') {\n        this.nodes = []\n        for (let node of defaults[name]) {\n          if (typeof node.clone === 'function') {\n            this.append(node.clone())\n          } else {\n            this.append(node)\n          }\n        }\n      } else {\n        this[name] = defaults[name]\n      }\n    }\n  }\n\n  error(message, opts = {}) {\n    if (this.source) {\n      let { start, end } = this.rangeBy(opts)\n      return this.source.input.error(\n        message,\n        { line: start.line, column: start.column },\n        { line: end.line, column: end.column },\n        opts\n      )\n    }\n    return new CssSyntaxError(message)\n  }\n\n  warn(result, text, opts) {\n    let data = { node: this }\n    for (let i in opts) data[i] = opts[i]\n    return result.warn(text, data)\n  }\n\n  remove() {\n    if (this.parent) {\n      this.parent.removeChild(this)\n    }\n    this.parent = undefined\n    return this\n  }\n\n  toString(stringifier = stringify) {\n    if (stringifier.stringify) stringifier = stringifier.stringify\n    let result = ''\n    stringifier(this, i => {\n      result += i\n    })\n    return result\n  }\n\n  assign(overrides = {}) {\n    for (let name in overrides) {\n      this[name] = overrides[name]\n    }\n    return this\n  }\n\n  clone(overrides = {}) {\n    let cloned = cloneNode(this)\n    for (let name in overrides) {\n      cloned[name] = overrides[name]\n    }\n    return cloned\n  }\n\n  cloneBefore(overrides = {}) {\n    let cloned = this.clone(overrides)\n    this.parent.insertBefore(this, cloned)\n    return cloned\n  }\n\n  cloneAfter(overrides = {}) {\n    let cloned = this.clone(overrides)\n    this.parent.insertAfter(this, cloned)\n    return cloned\n  }\n\n  replaceWith(...nodes) {\n    if (this.parent) {\n      let bookmark = this\n      let foundSelf = false\n      for (let node of nodes) {\n        if (node === this) {\n          foundSelf = true\n        } else if (foundSelf) {\n          this.parent.insertAfter(bookmark, node)\n          bookmark = node\n        } else {\n          this.parent.insertBefore(bookmark, node)\n        }\n      }\n\n      if (!foundSelf) {\n        this.remove()\n      }\n    }\n\n    return this\n  }\n\n  next() {\n    if (!this.parent) return undefined\n    let index = this.parent.index(this)\n    return this.parent.nodes[index + 1]\n  }\n\n  prev() {\n    if (!this.parent) return undefined\n    let index = this.parent.index(this)\n    return this.parent.nodes[index - 1]\n  }\n\n  before(add) {\n    this.parent.insertBefore(this, add)\n    return this\n  }\n\n  after(add) {\n    this.parent.insertAfter(this, add)\n    return this\n  }\n\n  root() {\n    let result = this\n    while (result.parent && result.parent.type !== 'document') {\n      result = result.parent\n    }\n    return result\n  }\n\n  raw(prop, defaultType) {\n    let str = new Stringifier()\n    return str.raw(this, prop, defaultType)\n  }\n\n  cleanRaws(keepBetween) {\n    delete this.raws.before\n    delete this.raws.after\n    if (!keepBetween) delete this.raws.between\n  }\n\n  toJSON(_, inputs) {\n    let fixed = {}\n    let emitInputs = inputs == null\n    inputs = inputs || new Map()\n    let inputsNextIndex = 0\n\n    for (let name in this) {\n      if (!Object.prototype.hasOwnProperty.call(this, name)) {\n        /* c8 ignore next 2 */\n        continue\n      }\n      if (name === 'parent' || name === 'proxyCache') continue\n      let value = this[name]\n\n      if (Array.isArray(value)) {\n        fixed[name] = value.map(i => {\n          if (typeof i === 'object' && i.toJSON) {\n            return i.toJSON(null, inputs)\n          } else {\n            return i\n          }\n        })\n      } else if (typeof value === 'object' && value.toJSON) {\n        fixed[name] = value.toJSON(null, inputs)\n      } else if (name === 'source') {\n        let inputId = inputs.get(value.input)\n        if (inputId == null) {\n          inputId = inputsNextIndex\n          inputs.set(value.input, inputsNextIndex)\n          inputsNextIndex++\n        }\n        fixed[name] = {\n          inputId,\n          start: value.start,\n          end: value.end\n        }\n      } else {\n        fixed[name] = value\n      }\n    }\n\n    if (emitInputs) {\n      fixed.inputs = [...inputs.keys()].map(input => input.toJSON())\n    }\n\n    return fixed\n  }\n\n  positionInside(index) {\n    let string = this.toString()\n    let column = this.source.start.column\n    let line = this.source.start.line\n\n    for (let i = 0; i < index; i++) {\n      if (string[i] === '\\n') {\n        column = 1\n        line += 1\n      } else {\n        column += 1\n      }\n    }\n\n    return { line, column }\n  }\n\n  positionBy(opts) {\n    let pos = this.source.start\n    if (opts.index) {\n      pos = this.positionInside(opts.index)\n    } else if (opts.word) {\n      let index = this.toString().indexOf(opts.word)\n      if (index !== -1) pos = this.positionInside(index)\n    }\n    return pos\n  }\n\n  rangeBy(opts) {\n    let start = {\n      line: this.source.start.line,\n      column: this.source.start.column\n    }\n    let end = this.source.end\n      ? {\n          line: this.source.end.line,\n          column: this.source.end.column + 1\n        }\n      : {\n          line: start.line,\n          column: start.column + 1\n        }\n\n    if (opts.word) {\n      let index = this.toString().indexOf(opts.word)\n      if (index !== -1) {\n        start = this.positionInside(index)\n        end = this.positionInside(index + opts.word.length)\n      }\n    } else {\n      if (opts.start) {\n        start = {\n          line: opts.start.line,\n          column: opts.start.column\n        }\n      } else if (opts.index) {\n        start = this.positionInside(opts.index)\n      }\n\n      if (opts.end) {\n        end = {\n          line: opts.end.line,\n          column: opts.end.column\n        }\n      } else if (opts.endIndex) {\n        end = this.positionInside(opts.endIndex)\n      } else if (opts.index) {\n        end = this.positionInside(opts.index + 1)\n      }\n    }\n\n    if (\n      end.line < start.line ||\n      (end.line === start.line && end.column <= start.column)\n    ) {\n      end = { line: start.line, column: start.column + 1 }\n    }\n\n    return { start, end }\n  }\n\n  getProxyProcessor() {\n    return {\n      set(node, prop, value) {\n        if (node[prop] === value) return true\n        node[prop] = value\n        if (\n          prop === 'prop' ||\n          prop === 'value' ||\n          prop === 'name' ||\n          prop === 'params' ||\n          prop === 'important' ||\n          /* c8 ignore next */\n          prop === 'text'\n        ) {\n          node.markDirty()\n        }\n        return true\n      },\n\n      get(node, prop) {\n        if (prop === 'proxyOf') {\n          return node\n        } else if (prop === 'root') {\n          return () => node.root().toProxy()\n        } else {\n          return node[prop]\n        }\n      }\n    }\n  }\n\n  toProxy() {\n    if (!this.proxyCache) {\n      this.proxyCache = new Proxy(this, this.getProxyProcessor())\n    }\n    return this.proxyCache\n  }\n\n  addToError(error) {\n    error.postcssNode = this\n    if (error.stack && this.source && /\\n\\s{4}at /.test(error.stack)) {\n      let s = this.source\n      error.stack = error.stack.replace(\n        /\\n\\s{4}at /,\n        `$&${s.input.from}:${s.start.line}:${s.start.column}$&`\n      )\n    }\n    return error\n  }\n\n  markDirty() {\n    if (this[isClean]) {\n      this[isClean] = false\n      let next = this\n      while ((next = next.parent)) {\n        next[isClean] = false\n      }\n    }\n  }\n\n  get proxyOf() {\n    return this\n  }\n}\n\nmodule.exports = Node\nNode.default = Node\n","'use strict'\n\nlet Node = require('./node')\n\nclass Declaration extends Node {\n  constructor(defaults) {\n    if (\n      defaults &&\n      typeof defaults.value !== 'undefined' &&\n      typeof defaults.value !== 'string'\n    ) {\n      defaults = { ...defaults, value: String(defaults.value) }\n    }\n    super(defaults)\n    this.type = 'decl'\n  }\n\n  get variable() {\n    return this.prop.startsWith('--') || this.prop[0] === '$'\n  }\n}\n\nmodule.exports = Declaration\nDeclaration.default = Declaration\n","let urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\nlet customAlphabet = (alphabet, defaultSize = 21) => {\n  return (size = defaultSize) => {\n    let id = ''\n    let i = size\n    while (i--) {\n      id += alphabet[(Math.random() * alphabet.length) | 0]\n    }\n    return id\n  }\n}\nlet nanoid = (size = 21) => {\n  let id = ''\n  let i = size\n  while (i--) {\n    id += urlAlphabet[(Math.random() * 64) | 0]\n  }\n  return id\n}\nmodule.exports = { nanoid, customAlphabet }\n","'use strict'\n\nlet { SourceMapConsumer, SourceMapGenerator } = require('source-map-js')\nlet { existsSync, readFileSync } = require('fs')\nlet { dirname, join } = require('path')\n\nfunction fromBase64(str) {\n  if (Buffer) {\n    return Buffer.from(str, 'base64').toString()\n  } else {\n    /* c8 ignore next 2 */\n    return window.atob(str)\n  }\n}\n\nclass PreviousMap {\n  constructor(css, opts) {\n    if (opts.map === false) return\n    this.loadAnnotation(css)\n    this.inline = this.startWith(this.annotation, 'data:')\n\n    let prev = opts.map ? opts.map.prev : undefined\n    let text = this.loadMap(opts.from, prev)\n    if (!this.mapFile && opts.from) {\n      this.mapFile = opts.from\n    }\n    if (this.mapFile) this.root = dirname(this.mapFile)\n    if (text) this.text = text\n  }\n\n  consumer() {\n    if (!this.consumerCache) {\n      this.consumerCache = new SourceMapConsumer(this.text)\n    }\n    return this.consumerCache\n  }\n\n  withContent() {\n    return !!(\n      this.consumer().sourcesContent &&\n      this.consumer().sourcesContent.length > 0\n    )\n  }\n\n  startWith(string, start) {\n    if (!string) return false\n    return string.substr(0, start.length) === start\n  }\n\n  getAnnotationURL(sourceMapString) {\n    return sourceMapString.replace(/^\\/\\*\\s*# sourceMappingURL=/, '').trim()\n  }\n\n  loadAnnotation(css) {\n    let comments = css.match(/\\/\\*\\s*# sourceMappingURL=/gm)\n    if (!comments) return\n\n    // sourceMappingURLs from comments, strings, etc.\n    let start = css.lastIndexOf(comments.pop())\n    let end = css.indexOf('*/', start)\n\n    if (start > -1 && end > -1) {\n      // Locate the last sourceMappingURL to avoid pickin\n      this.annotation = this.getAnnotationURL(css.substring(start, end))\n    }\n  }\n\n  decodeInline(text) {\n    let baseCharsetUri = /^data:application\\/json;charset=utf-?8;base64,/\n    let baseUri = /^data:application\\/json;base64,/\n    let charsetUri = /^data:application\\/json;charset=utf-?8,/\n    let uri = /^data:application\\/json,/\n\n    if (charsetUri.test(text) || uri.test(text)) {\n      return decodeURIComponent(text.substr(RegExp.lastMatch.length))\n    }\n\n    if (baseCharsetUri.test(text) || baseUri.test(text)) {\n      return fromBase64(text.substr(RegExp.lastMatch.length))\n    }\n\n    let encoding = text.match(/data:application\\/json;([^,]+),/)[1]\n    throw new Error('Unsupported source map encoding ' + encoding)\n  }\n\n  loadFile(path) {\n    this.root = dirname(path)\n    if (existsSync(path)) {\n      this.mapFile = path\n      return readFileSync(path, 'utf-8').toString().trim()\n    }\n  }\n\n  loadMap(file, prev) {\n    if (prev === false) return false\n\n    if (prev) {\n      if (typeof prev === 'string') {\n        return prev\n      } else if (typeof prev === 'function') {\n        let prevPath = prev(file)\n        if (prevPath) {\n          let map = this.loadFile(prevPath)\n          if (!map) {\n            throw new Error(\n              'Unable to load previous source map: ' + prevPath.toString()\n            )\n          }\n          return map\n        }\n      } else if (prev instanceof SourceMapConsumer) {\n        return SourceMapGenerator.fromSourceMap(prev).toString()\n      } else if (prev instanceof SourceMapGenerator) {\n        return prev.toString()\n      } else if (this.isMap(prev)) {\n        return JSON.stringify(prev)\n      } else {\n        throw new Error(\n          'Unsupported previous source map format: ' + prev.toString()\n        )\n      }\n    } else if (this.inline) {\n      return this.decodeInline(this.annotation)\n    } else if (this.annotation) {\n      let map = this.annotation\n      if (file) map = join(dirname(file), map)\n      return this.loadFile(map)\n    }\n  }\n\n  isMap(map) {\n    if (typeof map !== 'object') return false\n    return (\n      typeof map.mappings === 'string' ||\n      typeof map._mappings === 'string' ||\n      Array.isArray(map.sections)\n    )\n  }\n}\n\nmodule.exports = PreviousMap\nPreviousMap.default = PreviousMap\n","'use strict'\n\nlet { SourceMapConsumer, SourceMapGenerator } = require('source-map-js')\nlet { fileURLToPath, pathToFileURL } = require('url')\nlet { resolve, isAbsolute } = require('path')\nlet { nanoid } = require('nanoid/non-secure')\n\nlet terminalHighlight = require('./terminal-highlight')\nlet CssSyntaxError = require('./css-syntax-error')\nlet PreviousMap = require('./previous-map')\n\nlet fromOffsetCache = Symbol('fromOffsetCache')\n\nlet sourceMapAvailable = Boolean(SourceMapConsumer && SourceMapGenerator)\nlet pathAvailable = Boolean(resolve && isAbsolute)\n\nclass Input {\n  constructor(css, opts = {}) {\n    if (\n      css === null ||\n      typeof css === 'undefined' ||\n      (typeof css === 'object' && !css.toString)\n    ) {\n      throw new Error(`PostCSS received ${css} instead of CSS string`)\n    }\n\n    this.css = css.toString()\n\n    if (this.css[0] === '\\uFEFF' || this.css[0] === '\\uFFFE') {\n      this.hasBOM = true\n      this.css = this.css.slice(1)\n    } else {\n      this.hasBOM = false\n    }\n\n    if (opts.from) {\n      if (\n        !pathAvailable ||\n        /^\\w+:\\/\\//.test(opts.from) ||\n        isAbsolute(opts.from)\n      ) {\n        this.file = opts.from\n      } else {\n        this.file = resolve(opts.from)\n      }\n    }\n\n    if (pathAvailable && sourceMapAvailable) {\n      let map = new PreviousMap(this.css, opts)\n      if (map.text) {\n        this.map = map\n        let file = map.consumer().file\n        if (!this.file && file) this.file = this.mapResolve(file)\n      }\n    }\n\n    if (!this.file) {\n      this.id = '<input css ' + nanoid(6) + '>'\n    }\n    if (this.map) this.map.file = this.from\n  }\n\n  fromOffset(offset) {\n    let lastLine, lineToIndex\n    if (!this[fromOffsetCache]) {\n      let lines = this.css.split('\\n')\n      lineToIndex = new Array(lines.length)\n      let prevIndex = 0\n\n      for (let i = 0, l = lines.length; i < l; i++) {\n        lineToIndex[i] = prevIndex\n        prevIndex += lines[i].length + 1\n      }\n\n      this[fromOffsetCache] = lineToIndex\n    } else {\n      lineToIndex = this[fromOffsetCache]\n    }\n    lastLine = lineToIndex[lineToIndex.length - 1]\n\n    let min = 0\n    if (offset >= lastLine) {\n      min = lineToIndex.length - 1\n    } else {\n      let max = lineToIndex.length - 2\n      let mid\n      while (min < max) {\n        mid = min + ((max - min) >> 1)\n        if (offset < lineToIndex[mid]) {\n          max = mid - 1\n        } else if (offset >= lineToIndex[mid + 1]) {\n          min = mid + 1\n        } else {\n          min = mid\n          break\n        }\n      }\n    }\n    return {\n      line: min + 1,\n      col: offset - lineToIndex[min] + 1\n    }\n  }\n\n  error(message, line, column, opts = {}) {\n    let result, endLine, endColumn\n\n    if (line && typeof line === 'object') {\n      let start = line\n      let end = column\n      if (typeof start.offset === 'number') {\n        let pos = this.fromOffset(start.offset)\n        line = pos.line\n        column = pos.col\n      } else {\n        line = start.line\n        column = start.column\n      }\n      if (typeof end.offset === 'number') {\n        let pos = this.fromOffset(end.offset)\n        endLine = pos.line\n        endColumn = pos.col\n      } else {\n        endLine = end.line\n        endColumn = end.column\n      }\n    } else if (!column) {\n      let pos = this.fromOffset(line)\n      line = pos.line\n      column = pos.col\n    }\n\n    let origin = this.origin(line, column, endLine, endColumn)\n    if (origin) {\n      result = new CssSyntaxError(\n        message,\n        origin.endLine === undefined\n          ? origin.line\n          : { line: origin.line, column: origin.column },\n        origin.endLine === undefined\n          ? origin.column\n          : { line: origin.endLine, column: origin.endColumn },\n        origin.source,\n        origin.file,\n        opts.plugin\n      )\n    } else {\n      result = new CssSyntaxError(\n        message,\n        endLine === undefined ? line : { line, column },\n        endLine === undefined ? column : { line: endLine, column: endColumn },\n        this.css,\n        this.file,\n        opts.plugin\n      )\n    }\n\n    result.input = { line, column, endLine, endColumn, source: this.css }\n    if (this.file) {\n      if (pathToFileURL) {\n        result.input.url = pathToFileURL(this.file).toString()\n      }\n      result.input.file = this.file\n    }\n\n    return result\n  }\n\n  origin(line, column, endLine, endColumn) {\n    if (!this.map) return false\n    let consumer = this.map.consumer()\n\n    let from = consumer.originalPositionFor({ line, column })\n    if (!from.source) return false\n\n    let to\n    if (typeof endLine === 'number') {\n      to = consumer.originalPositionFor({ line: endLine, column: endColumn })\n    }\n\n    let fromUrl\n\n    if (isAbsolute(from.source)) {\n      fromUrl = pathToFileURL(from.source)\n    } else {\n      fromUrl = new URL(\n        from.source,\n        this.map.consumer().sourceRoot || pathToFileURL(this.map.mapFile)\n      )\n    }\n\n    let result = {\n      url: fromUrl.toString(),\n      line: from.line,\n      column: from.column,\n      endLine: to && to.line,\n      endColumn: to && to.column\n    }\n\n    if (fromUrl.protocol === 'file:') {\n      if (fileURLToPath) {\n        result.file = fileURLToPath(fromUrl)\n      } else {\n        /* c8 ignore next 2 */\n        throw new Error(`file: protocol is not available in this PostCSS build`)\n      }\n    }\n\n    let source = consumer.sourceContentFor(from.source)\n    if (source) result.source = source\n\n    return result\n  }\n\n  mapResolve(file) {\n    if (/^\\w+:\\/\\//.test(file)) {\n      return file\n    }\n    return resolve(this.map.consumer().sourceRoot || this.map.root || '.', file)\n  }\n\n  get from() {\n    return this.file || this.id\n  }\n\n  toJSON() {\n    let json = {}\n    for (let name of ['hasBOM', 'css', 'file', 'id']) {\n      if (this[name] != null) {\n        json[name] = this[name]\n      }\n    }\n    if (this.map) {\n      json.map = { ...this.map }\n      if (json.map.consumerCache) {\n        json.map.consumerCache = undefined\n      }\n    }\n    return json\n  }\n}\n\nmodule.exports = Input\nInput.default = Input\n\nif (terminalHighlight && terminalHighlight.registerInput) {\n  terminalHighlight.registerInput(Input)\n}\n","'use strict'\n\nlet { SourceMapConsumer, SourceMapGenerator } = require('source-map-js')\nlet { dirname, resolve, relative, sep } = require('path')\nlet { pathToFileURL } = require('url')\n\nlet Input = require('./input')\n\nlet sourceMapAvailable = Boolean(SourceMapConsumer && SourceMapGenerator)\nlet pathAvailable = Boolean(dirname && resolve && relative && sep)\n\nclass MapGenerator {\n  constructor(stringify, root, opts, cssString) {\n    this.stringify = stringify\n    this.mapOpts = opts.map || {}\n    this.root = root\n    this.opts = opts\n    this.css = cssString\n    this.usesFileUrls = !this.mapOpts.from && this.mapOpts.absolute\n  }\n\n  isMap() {\n    if (typeof this.opts.map !== 'undefined') {\n      return !!this.opts.map\n    }\n    return this.previous().length > 0\n  }\n\n  previous() {\n    if (!this.previousMaps) {\n      this.previousMaps = []\n      if (this.root) {\n        this.root.walk(node => {\n          if (node.source && node.source.input.map) {\n            let map = node.source.input.map\n            if (!this.previousMaps.includes(map)) {\n              this.previousMaps.push(map)\n            }\n          }\n        })\n      } else {\n        let input = new Input(this.css, this.opts)\n        if (input.map) this.previousMaps.push(input.map)\n      }\n    }\n\n    return this.previousMaps\n  }\n\n  isInline() {\n    if (typeof this.mapOpts.inline !== 'undefined') {\n      return this.mapOpts.inline\n    }\n\n    let annotation = this.mapOpts.annotation\n    if (typeof annotation !== 'undefined' && annotation !== true) {\n      return false\n    }\n\n    if (this.previous().length) {\n      return this.previous().some(i => i.inline)\n    }\n    return true\n  }\n\n  isSourcesContent() {\n    if (typeof this.mapOpts.sourcesContent !== 'undefined') {\n      return this.mapOpts.sourcesContent\n    }\n    if (this.previous().length) {\n      return this.previous().some(i => i.withContent())\n    }\n    return true\n  }\n\n  clearAnnotation() {\n    if (this.mapOpts.annotation === false) return\n\n    if (this.root) {\n      let node\n      for (let i = this.root.nodes.length - 1; i >= 0; i--) {\n        node = this.root.nodes[i]\n        if (node.type !== 'comment') continue\n        if (node.text.indexOf('# sourceMappingURL=') === 0) {\n          this.root.removeChild(i)\n        }\n      }\n    } else if (this.css) {\n      this.css = this.css.replace(/(\\n)?\\/\\*#[\\S\\s]*?\\*\\/$/gm, '')\n    }\n  }\n\n  setSourcesContent() {\n    let already = {}\n    if (this.root) {\n      this.root.walk(node => {\n        if (node.source) {\n          let from = node.source.input.from\n          if (from && !already[from]) {\n            already[from] = true\n            let fromUrl = this.usesFileUrls\n              ? this.toFileUrl(from)\n              : this.toUrl(this.path(from))\n            this.map.setSourceContent(fromUrl, node.source.input.css)\n          }\n        }\n      })\n    } else if (this.css) {\n      let from = this.opts.from\n        ? this.toUrl(this.path(this.opts.from))\n        : '<no source>'\n      this.map.setSourceContent(from, this.css)\n    }\n  }\n\n  applyPrevMaps() {\n    for (let prev of this.previous()) {\n      let from = this.toUrl(this.path(prev.file))\n      let root = prev.root || dirname(prev.file)\n      let map\n\n      if (this.mapOpts.sourcesContent === false) {\n        map = new SourceMapConsumer(prev.text)\n        if (map.sourcesContent) {\n          map.sourcesContent = map.sourcesContent.map(() => null)\n        }\n      } else {\n        map = prev.consumer()\n      }\n\n      this.map.applySourceMap(map, from, this.toUrl(this.path(root)))\n    }\n  }\n\n  isAnnotation() {\n    if (this.isInline()) {\n      return true\n    }\n    if (typeof this.mapOpts.annotation !== 'undefined') {\n      return this.mapOpts.annotation\n    }\n    if (this.previous().length) {\n      return this.previous().some(i => i.annotation)\n    }\n    return true\n  }\n\n  toBase64(str) {\n    if (Buffer) {\n      return Buffer.from(str).toString('base64')\n    } else {\n      return window.btoa(unescape(encodeURIComponent(str)))\n    }\n  }\n\n  addAnnotation() {\n    let content\n\n    if (this.isInline()) {\n      content =\n        'data:application/json;base64,' + this.toBase64(this.map.toString())\n    } else if (typeof this.mapOpts.annotation === 'string') {\n      content = this.mapOpts.annotation\n    } else if (typeof this.mapOpts.annotation === 'function') {\n      content = this.mapOpts.annotation(this.opts.to, this.root)\n    } else {\n      content = this.outputFile() + '.map'\n    }\n    let eol = '\\n'\n    if (this.css.includes('\\r\\n')) eol = '\\r\\n'\n\n    this.css += eol + '/*# sourceMappingURL=' + content + ' */'\n  }\n\n  outputFile() {\n    if (this.opts.to) {\n      return this.path(this.opts.to)\n    } else if (this.opts.from) {\n      return this.path(this.opts.from)\n    } else {\n      return 'to.css'\n    }\n  }\n\n  generateMap() {\n    if (this.root) {\n      this.generateString()\n    } else if (this.previous().length === 1) {\n      let prev = this.previous()[0].consumer()\n      prev.file = this.outputFile()\n      this.map = SourceMapGenerator.fromSourceMap(prev)\n    } else {\n      this.map = new SourceMapGenerator({ file: this.outputFile() })\n      this.map.addMapping({\n        source: this.opts.from\n          ? this.toUrl(this.path(this.opts.from))\n          : '<no source>',\n        generated: { line: 1, column: 0 },\n        original: { line: 1, column: 0 }\n      })\n    }\n\n    if (this.isSourcesContent()) this.setSourcesContent()\n    if (this.root && this.previous().length > 0) this.applyPrevMaps()\n    if (this.isAnnotation()) this.addAnnotation()\n\n    if (this.isInline()) {\n      return [this.css]\n    } else {\n      return [this.css, this.map]\n    }\n  }\n\n  path(file) {\n    if (file.indexOf('<') === 0) return file\n    if (/^\\w+:\\/\\//.test(file)) return file\n    if (this.mapOpts.absolute) return file\n\n    let from = this.opts.to ? dirname(this.opts.to) : '.'\n\n    if (typeof this.mapOpts.annotation === 'string') {\n      from = dirname(resolve(from, this.mapOpts.annotation))\n    }\n\n    file = relative(from, file)\n    return file\n  }\n\n  toUrl(path) {\n    if (sep === '\\\\') {\n      path = path.replace(/\\\\/g, '/')\n    }\n    return encodeURI(path).replace(/[#?]/g, encodeURIComponent)\n  }\n\n  toFileUrl(path) {\n    if (pathToFileURL) {\n      return pathToFileURL(path).toString()\n    } else {\n      throw new Error(\n        '`map.absolute` option is not available in this PostCSS build'\n      )\n    }\n  }\n\n  sourcePath(node) {\n    if (this.mapOpts.from) {\n      return this.toUrl(this.mapOpts.from)\n    } else if (this.usesFileUrls) {\n      return this.toFileUrl(node.source.input.from)\n    } else {\n      return this.toUrl(this.path(node.source.input.from))\n    }\n  }\n\n  generateString() {\n    this.css = ''\n    this.map = new SourceMapGenerator({ file: this.outputFile() })\n\n    let line = 1\n    let column = 1\n\n    let noSource = '<no source>'\n    let mapping = {\n      source: '',\n      generated: { line: 0, column: 0 },\n      original: { line: 0, column: 0 }\n    }\n\n    let lines, last\n    this.stringify(this.root, (str, node, type) => {\n      this.css += str\n\n      if (node && type !== 'end') {\n        mapping.generated.line = line\n        mapping.generated.column = column - 1\n        if (node.source && node.source.start) {\n          mapping.source = this.sourcePath(node)\n          mapping.original.line = node.source.start.line\n          mapping.original.column = node.source.start.column - 1\n          this.map.addMapping(mapping)\n        } else {\n          mapping.source = noSource\n          mapping.original.line = 1\n          mapping.original.column = 0\n          this.map.addMapping(mapping)\n        }\n      }\n\n      lines = str.match(/\\n/g)\n      if (lines) {\n        line += lines.length\n        last = str.lastIndexOf('\\n')\n        column = str.length - last\n      } else {\n        column += str.length\n      }\n\n      if (node && type !== 'start') {\n        let p = node.parent || { raws: {} }\n        let childless =\n          node.type === 'decl' || (node.type === 'atrule' && !node.nodes)\n        if (!childless || node !== p.last || p.raws.semicolon) {\n          if (node.source && node.source.end) {\n            mapping.source = this.sourcePath(node)\n            mapping.original.line = node.source.end.line\n            mapping.original.column = node.source.end.column - 1\n            mapping.generated.line = line\n            mapping.generated.column = column - 2\n            this.map.addMapping(mapping)\n          } else {\n            mapping.source = noSource\n            mapping.original.line = 1\n            mapping.original.column = 0\n            mapping.generated.line = line\n            mapping.generated.column = column - 1\n            this.map.addMapping(mapping)\n          }\n        }\n      }\n    })\n  }\n\n  generate() {\n    this.clearAnnotation()\n    if (pathAvailable && sourceMapAvailable && this.isMap()) {\n      return this.generateMap()\n    } else {\n      let result = ''\n      this.stringify(this.root, i => {\n        result += i\n      })\n      return [result]\n    }\n  }\n}\n\nmodule.exports = MapGenerator\n","'use strict'\n\nlet Node = require('./node')\n\nclass Comment extends Node {\n  constructor(defaults) {\n    super(defaults)\n    this.type = 'comment'\n  }\n}\n\nmodule.exports = Comment\nComment.default = Comment\n","'use strict'\n\nlet { isClean, my } = require('./symbols')\nlet Declaration = require('./declaration')\nlet Comment = require('./comment')\nlet Node = require('./node')\n\nlet parse, Rule, AtRule, Root\n\nfunction cleanSource(nodes) {\n  return nodes.map(i => {\n    if (i.nodes) i.nodes = cleanSource(i.nodes)\n    delete i.source\n    return i\n  })\n}\n\nfunction markDirtyUp(node) {\n  node[isClean] = false\n  if (node.proxyOf.nodes) {\n    for (let i of node.proxyOf.nodes) {\n      markDirtyUp(i)\n    }\n  }\n}\n\nclass Container extends Node {\n  push(child) {\n    child.parent = this\n    this.proxyOf.nodes.push(child)\n    return this\n  }\n\n  each(callback) {\n    if (!this.proxyOf.nodes) return undefined\n    let iterator = this.getIterator()\n\n    let index, result\n    while (this.indexes[iterator] < this.proxyOf.nodes.length) {\n      index = this.indexes[iterator]\n      result = callback(this.proxyOf.nodes[index], index)\n      if (result === false) break\n\n      this.indexes[iterator] += 1\n    }\n\n    delete this.indexes[iterator]\n    return result\n  }\n\n  walk(callback) {\n    return this.each((child, i) => {\n      let result\n      try {\n        result = callback(child, i)\n      } catch (e) {\n        throw child.addToError(e)\n      }\n      if (result !== false && child.walk) {\n        result = child.walk(callback)\n      }\n\n      return result\n    })\n  }\n\n  walkDecls(prop, callback) {\n    if (!callback) {\n      callback = prop\n      return this.walk((child, i) => {\n        if (child.type === 'decl') {\n          return callback(child, i)\n        }\n      })\n    }\n    if (prop instanceof RegExp) {\n      return this.walk((child, i) => {\n        if (child.type === 'decl' && prop.test(child.prop)) {\n          return callback(child, i)\n        }\n      })\n    }\n    return this.walk((child, i) => {\n      if (child.type === 'decl' && child.prop === prop) {\n        return callback(child, i)\n      }\n    })\n  }\n\n  walkRules(selector, callback) {\n    if (!callback) {\n      callback = selector\n\n      return this.walk((child, i) => {\n        if (child.type === 'rule') {\n          return callback(child, i)\n        }\n      })\n    }\n    if (selector instanceof RegExp) {\n      return this.walk((child, i) => {\n        if (child.type === 'rule' && selector.test(child.selector)) {\n          return callback(child, i)\n        }\n      })\n    }\n    return this.walk((child, i) => {\n      if (child.type === 'rule' && child.selector === selector) {\n        return callback(child, i)\n      }\n    })\n  }\n\n  walkAtRules(name, callback) {\n    if (!callback) {\n      callback = name\n      return this.walk((child, i) => {\n        if (child.type === 'atrule') {\n          return callback(child, i)\n        }\n      })\n    }\n    if (name instanceof RegExp) {\n      return this.walk((child, i) => {\n        if (child.type === 'atrule' && name.test(child.name)) {\n          return callback(child, i)\n        }\n      })\n    }\n    return this.walk((child, i) => {\n      if (child.type === 'atrule' && child.name === name) {\n        return callback(child, i)\n      }\n    })\n  }\n\n  walkComments(callback) {\n    return this.walk((child, i) => {\n      if (child.type === 'comment') {\n        return callback(child, i)\n      }\n    })\n  }\n\n  append(...children) {\n    for (let child of children) {\n      let nodes = this.normalize(child, this.last)\n      for (let node of nodes) this.proxyOf.nodes.push(node)\n    }\n\n    this.markDirty()\n\n    return this\n  }\n\n  prepend(...children) {\n    children = children.reverse()\n    for (let child of children) {\n      let nodes = this.normalize(child, this.first, 'prepend').reverse()\n      for (let node of nodes) this.proxyOf.nodes.unshift(node)\n      for (let id in this.indexes) {\n        this.indexes[id] = this.indexes[id] + nodes.length\n      }\n    }\n\n    this.markDirty()\n\n    return this\n  }\n\n  cleanRaws(keepBetween) {\n    super.cleanRaws(keepBetween)\n    if (this.nodes) {\n      for (let node of this.nodes) node.cleanRaws(keepBetween)\n    }\n  }\n\n  insertBefore(exist, add) {\n    let existIndex = this.index(exist)\n    let type = existIndex === 0 ? 'prepend' : false\n    let nodes = this.normalize(add, this.proxyOf.nodes[existIndex], type).reverse()\n    existIndex = this.index(exist)\n    for (let node of nodes) this.proxyOf.nodes.splice(existIndex, 0, node)\n\n    let index\n    for (let id in this.indexes) {\n      index = this.indexes[id]\n      if (existIndex <= index) {\n        this.indexes[id] = index + nodes.length\n      }\n    }\n\n    this.markDirty()\n\n    return this\n  }\n\n  insertAfter(exist, add) {\n    let existIndex = this.index(exist)\n    let nodes = this.normalize(add, this.proxyOf.nodes[existIndex]).reverse()\n    existIndex = this.index(exist)\n    for (let node of nodes) this.proxyOf.nodes.splice(existIndex + 1, 0, node)\n\n    let index\n    for (let id in this.indexes) {\n      index = this.indexes[id]\n      if (existIndex < index) {\n        this.indexes[id] = index + nodes.length\n      }\n    }\n\n    this.markDirty()\n\n    return this\n  }\n\n  removeChild(child) {\n    child = this.index(child)\n    this.proxyOf.nodes[child].parent = undefined\n    this.proxyOf.nodes.splice(child, 1)\n\n    let index\n    for (let id in this.indexes) {\n      index = this.indexes[id]\n      if (index >= child) {\n        this.indexes[id] = index - 1\n      }\n    }\n\n    this.markDirty()\n\n    return this\n  }\n\n  removeAll() {\n    for (let node of this.proxyOf.nodes) node.parent = undefined\n    this.proxyOf.nodes = []\n\n    this.markDirty()\n\n    return this\n  }\n\n  replaceValues(pattern, opts, callback) {\n    if (!callback) {\n      callback = opts\n      opts = {}\n    }\n\n    this.walkDecls(decl => {\n      if (opts.props && !opts.props.includes(decl.prop)) return\n      if (opts.fast && !decl.value.includes(opts.fast)) return\n\n      decl.value = decl.value.replace(pattern, callback)\n    })\n\n    this.markDirty()\n\n    return this\n  }\n\n  every(condition) {\n    return this.nodes.every(condition)\n  }\n\n  some(condition) {\n    return this.nodes.some(condition)\n  }\n\n  index(child) {\n    if (typeof child === 'number') return child\n    if (child.proxyOf) child = child.proxyOf\n    return this.proxyOf.nodes.indexOf(child)\n  }\n\n  get first() {\n    if (!this.proxyOf.nodes) return undefined\n    return this.proxyOf.nodes[0]\n  }\n\n  get last() {\n    if (!this.proxyOf.nodes) return undefined\n    return this.proxyOf.nodes[this.proxyOf.nodes.length - 1]\n  }\n\n  normalize(nodes, sample) {\n    if (typeof nodes === 'string') {\n      nodes = cleanSource(parse(nodes).nodes)\n    } else if (Array.isArray(nodes)) {\n      nodes = nodes.slice(0)\n      for (let i of nodes) {\n        if (i.parent) i.parent.removeChild(i, 'ignore')\n      }\n    } else if (nodes.type === 'root' && this.type !== 'document') {\n      nodes = nodes.nodes.slice(0)\n      for (let i of nodes) {\n        if (i.parent) i.parent.removeChild(i, 'ignore')\n      }\n    } else if (nodes.type) {\n      nodes = [nodes]\n    } else if (nodes.prop) {\n      if (typeof nodes.value === 'undefined') {\n        throw new Error('Value field is missed in node creation')\n      } else if (typeof nodes.value !== 'string') {\n        nodes.value = String(nodes.value)\n      }\n      nodes = [new Declaration(nodes)]\n    } else if (nodes.selector) {\n      nodes = [new Rule(nodes)]\n    } else if (nodes.name) {\n      nodes = [new AtRule(nodes)]\n    } else if (nodes.text) {\n      nodes = [new Comment(nodes)]\n    } else {\n      throw new Error('Unknown node type in node creation')\n    }\n\n    let processed = nodes.map(i => {\n      /* c8 ignore next */\n      if (!i[my]) Container.rebuild(i)\n      i = i.proxyOf\n      if (i.parent) i.parent.removeChild(i)\n      if (i[isClean]) markDirtyUp(i)\n      if (typeof i.raws.before === 'undefined') {\n        if (sample && typeof sample.raws.before !== 'undefined') {\n          i.raws.before = sample.raws.before.replace(/\\S/g, '')\n        }\n      }\n      i.parent = this.proxyOf\n      return i\n    })\n\n    return processed\n  }\n\n  getProxyProcessor() {\n    return {\n      set(node, prop, value) {\n        if (node[prop] === value) return true\n        node[prop] = value\n        if (prop === 'name' || prop === 'params' || prop === 'selector') {\n          node.markDirty()\n        }\n        return true\n      },\n\n      get(node, prop) {\n        if (prop === 'proxyOf') {\n          return node\n        } else if (!node[prop]) {\n          return node[prop]\n        } else if (\n          prop === 'each' ||\n          (typeof prop === 'string' && prop.startsWith('walk'))\n        ) {\n          return (...args) => {\n            return node[prop](\n              ...args.map(i => {\n                if (typeof i === 'function') {\n                  return (child, index) => i(child.toProxy(), index)\n                } else {\n                  return i\n                }\n              })\n            )\n          }\n        } else if (prop === 'every' || prop === 'some') {\n          return cb => {\n            return node[prop]((child, ...other) =>\n              cb(child.toProxy(), ...other)\n            )\n          }\n        } else if (prop === 'root') {\n          return () => node.root().toProxy()\n        } else if (prop === 'nodes') {\n          return node.nodes.map(i => i.toProxy())\n        } else if (prop === 'first' || prop === 'last') {\n          return node[prop].toProxy()\n        } else {\n          return node[prop]\n        }\n      }\n    }\n  }\n\n  getIterator() {\n    if (!this.lastEach) this.lastEach = 0\n    if (!this.indexes) this.indexes = {}\n\n    this.lastEach += 1\n    let iterator = this.lastEach\n    this.indexes[iterator] = 0\n\n    return iterator\n  }\n}\n\nContainer.registerParse = dependant => {\n  parse = dependant\n}\n\nContainer.registerRule = dependant => {\n  Rule = dependant\n}\n\nContainer.registerAtRule = dependant => {\n  AtRule = dependant\n}\n\nContainer.registerRoot = dependant => {\n  Root = dependant\n}\n\nmodule.exports = Container\nContainer.default = Container\n\n/* c8 ignore start */\nContainer.rebuild = node => {\n  if (node.type === 'atrule') {\n    Object.setPrototypeOf(node, AtRule.prototype)\n  } else if (node.type === 'rule') {\n    Object.setPrototypeOf(node, Rule.prototype)\n  } else if (node.type === 'decl') {\n    Object.setPrototypeOf(node, Declaration.prototype)\n  } else if (node.type === 'comment') {\n    Object.setPrototypeOf(node, Comment.prototype)\n  } else if (node.type === 'root') {\n    Object.setPrototypeOf(node, Root.prototype)\n  }\n\n  node[my] = true\n\n  if (node.nodes) {\n    node.nodes.forEach(child => {\n      Container.rebuild(child)\n    })\n  }\n}\n/* c8 ignore stop */\n","'use strict'\n\nlet Container = require('./container')\n\nlet LazyResult, Processor\n\nclass Document extends Container {\n  constructor(defaults) {\n    // type needs to be passed to super, otherwise child roots won't be normalized correctly\n    super({ type: 'document', ...defaults })\n\n    if (!this.nodes) {\n      this.nodes = []\n    }\n  }\n\n  toResult(opts = {}) {\n    let lazy = new LazyResult(new Processor(), this, opts)\n\n    return lazy.stringify()\n  }\n}\n\nDocument.registerLazyResult = dependant => {\n  LazyResult = dependant\n}\n\nDocument.registerProcessor = dependant => {\n  Processor = dependant\n}\n\nmodule.exports = Document\nDocument.default = Document\n","/* eslint-disable no-console */\n'use strict'\n\nlet printed = {}\n\nmodule.exports = function warnOnce(message) {\n  if (printed[message]) return\n  printed[message] = true\n\n  if (typeof console !== 'undefined' && console.warn) {\n    console.warn(message)\n  }\n}\n","'use strict'\n\nclass Warning {\n  constructor(text, opts = {}) {\n    this.type = 'warning'\n    this.text = text\n\n    if (opts.node && opts.node.source) {\n      let range = opts.node.rangeBy(opts)\n      this.line = range.start.line\n      this.column = range.start.column\n      this.endLine = range.end.line\n      this.endColumn = range.end.column\n    }\n\n    for (let opt in opts) this[opt] = opts[opt]\n  }\n\n  toString() {\n    if (this.node) {\n      return this.node.error(this.text, {\n        plugin: this.plugin,\n        index: this.index,\n        word: this.word\n      }).message\n    }\n\n    if (this.plugin) {\n      return this.plugin + ': ' + this.text\n    }\n\n    return this.text\n  }\n}\n\nmodule.exports = Warning\nWarning.default = Warning\n","'use strict'\n\nlet Warning = require('./warning')\n\nclass Result {\n  constructor(processor, root, opts) {\n    this.processor = processor\n    this.messages = []\n    this.root = root\n    this.opts = opts\n    this.css = undefined\n    this.map = undefined\n  }\n\n  toString() {\n    return this.css\n  }\n\n  warn(text, opts = {}) {\n    if (!opts.plugin) {\n      if (this.lastPlugin && this.lastPlugin.postcssPlugin) {\n        opts.plugin = this.lastPlugin.postcssPlugin\n      }\n    }\n\n    let warning = new Warning(text, opts)\n    this.messages.push(warning)\n\n    return warning\n  }\n\n  warnings() {\n    return this.messages.filter(i => i.type === 'warning')\n  }\n\n  get content() {\n    return this.css\n  }\n}\n\nmodule.exports = Result\nResult.default = Result\n","'use strict'\n\nconst SINGLE_QUOTE = \"'\".charCodeAt(0)\nconst DOUBLE_QUOTE = '\"'.charCodeAt(0)\nconst BACKSLASH = '\\\\'.charCodeAt(0)\nconst SLASH = '/'.charCodeAt(0)\nconst NEWLINE = '\\n'.charCodeAt(0)\nconst SPACE = ' '.charCodeAt(0)\nconst FEED = '\\f'.charCodeAt(0)\nconst TAB = '\\t'.charCodeAt(0)\nconst CR = '\\r'.charCodeAt(0)\nconst OPEN_SQUARE = '['.charCodeAt(0)\nconst CLOSE_SQUARE = ']'.charCodeAt(0)\nconst OPEN_PARENTHESES = '('.charCodeAt(0)\nconst CLOSE_PARENTHESES = ')'.charCodeAt(0)\nconst OPEN_CURLY = '{'.charCodeAt(0)\nconst CLOSE_CURLY = '}'.charCodeAt(0)\nconst SEMICOLON = ';'.charCodeAt(0)\nconst ASTERISK = '*'.charCodeAt(0)\nconst COLON = ':'.charCodeAt(0)\nconst AT = '@'.charCodeAt(0)\n\nconst RE_AT_END = /[\\t\\n\\f\\r \"#'()/;[\\\\\\]{}]/g\nconst RE_WORD_END = /[\\t\\n\\f\\r !\"#'():;@[\\\\\\]{}]|\\/(?=\\*)/g\nconst RE_BAD_BRACKET = /.[\\n\"'(/\\\\]/\nconst RE_HEX_ESCAPE = /[\\da-f]/i\n\nmodule.exports = function tokenizer(input, options = {}) {\n  let css = input.css.valueOf()\n  let ignore = options.ignoreErrors\n\n  let code, next, quote, content, escape\n  let escaped, escapePos, prev, n, currentToken\n\n  let length = css.length\n  let pos = 0\n  let buffer = []\n  let returned = []\n\n  function position() {\n    return pos\n  }\n\n  function unclosed(what) {\n    throw input.error('Unclosed ' + what, pos)\n  }\n\n  function endOfFile() {\n    return returned.length === 0 && pos >= length\n  }\n\n  function nextToken(opts) {\n    if (returned.length) return returned.pop()\n    if (pos >= length) return\n\n    let ignoreUnclosed = opts ? opts.ignoreUnclosed : false\n\n    code = css.charCodeAt(pos)\n\n    switch (code) {\n      case NEWLINE:\n      case SPACE:\n      case TAB:\n      case CR:\n      case FEED: {\n        next = pos\n        do {\n          next += 1\n          code = css.charCodeAt(next)\n        } while (\n          code === SPACE ||\n          code === NEWLINE ||\n          code === TAB ||\n          code === CR ||\n          code === FEED\n        )\n\n        currentToken = ['space', css.slice(pos, next)]\n        pos = next - 1\n        break\n      }\n\n      case OPEN_SQUARE:\n      case CLOSE_SQUARE:\n      case OPEN_CURLY:\n      case CLOSE_CURLY:\n      case COLON:\n      case SEMICOLON:\n      case CLOSE_PARENTHESES: {\n        let controlChar = String.fromCharCode(code)\n        currentToken = [controlChar, controlChar, pos]\n        break\n      }\n\n      case OPEN_PARENTHESES: {\n        prev = buffer.length ? buffer.pop()[1] : ''\n        n = css.charCodeAt(pos + 1)\n        if (\n          prev === 'url' &&\n          n !== SINGLE_QUOTE &&\n          n !== DOUBLE_QUOTE &&\n          n !== SPACE &&\n          n !== NEWLINE &&\n          n !== TAB &&\n          n !== FEED &&\n          n !== CR\n        ) {\n          next = pos\n          do {\n            escaped = false\n            next = css.indexOf(')', next + 1)\n            if (next === -1) {\n              if (ignore || ignoreUnclosed) {\n                next = pos\n                break\n              } else {\n                unclosed('bracket')\n              }\n            }\n            escapePos = next\n            while (css.charCodeAt(escapePos - 1) === BACKSLASH) {\n              escapePos -= 1\n              escaped = !escaped\n            }\n          } while (escaped)\n\n          currentToken = ['brackets', css.slice(pos, next + 1), pos, next]\n\n          pos = next\n        } else {\n          next = css.indexOf(')', pos + 1)\n          content = css.slice(pos, next + 1)\n\n          if (next === -1 || RE_BAD_BRACKET.test(content)) {\n            currentToken = ['(', '(', pos]\n          } else {\n            currentToken = ['brackets', content, pos, next]\n            pos = next\n          }\n        }\n\n        break\n      }\n\n      case SINGLE_QUOTE:\n      case DOUBLE_QUOTE: {\n        quote = code === SINGLE_QUOTE ? \"'\" : '\"'\n        next = pos\n        do {\n          escaped = false\n          next = css.indexOf(quote, next + 1)\n          if (next === -1) {\n            if (ignore || ignoreUnclosed) {\n              next = pos + 1\n              break\n            } else {\n              unclosed('string')\n            }\n          }\n          escapePos = next\n          while (css.charCodeAt(escapePos - 1) === BACKSLASH) {\n            escapePos -= 1\n            escaped = !escaped\n          }\n        } while (escaped)\n\n        currentToken = ['string', css.slice(pos, next + 1), pos, next]\n        pos = next\n        break\n      }\n\n      case AT: {\n        RE_AT_END.lastIndex = pos + 1\n        RE_AT_END.test(css)\n        if (RE_AT_END.lastIndex === 0) {\n          next = css.length - 1\n        } else {\n          next = RE_AT_END.lastIndex - 2\n        }\n\n        currentToken = ['at-word', css.slice(pos, next + 1), pos, next]\n\n        pos = next\n        break\n      }\n\n      case BACKSLASH: {\n        next = pos\n        escape = true\n        while (css.charCodeAt(next + 1) === BACKSLASH) {\n          next += 1\n          escape = !escape\n        }\n        code = css.charCodeAt(next + 1)\n        if (\n          escape &&\n          code !== SLASH &&\n          code !== SPACE &&\n          code !== NEWLINE &&\n          code !== TAB &&\n          code !== CR &&\n          code !== FEED\n        ) {\n          next += 1\n          if (RE_HEX_ESCAPE.test(css.charAt(next))) {\n            while (RE_HEX_ESCAPE.test(css.charAt(next + 1))) {\n              next += 1\n            }\n            if (css.charCodeAt(next + 1) === SPACE) {\n              next += 1\n            }\n          }\n        }\n\n        currentToken = ['word', css.slice(pos, next + 1), pos, next]\n\n        pos = next\n        break\n      }\n\n      default: {\n        if (code === SLASH && css.charCodeAt(pos + 1) === ASTERISK) {\n          next = css.indexOf('*/', pos + 2) + 1\n          if (next === 0) {\n            if (ignore || ignoreUnclosed) {\n              next = css.length\n            } else {\n              unclosed('comment')\n            }\n          }\n\n          currentToken = ['comment', css.slice(pos, next + 1), pos, next]\n          pos = next\n        } else {\n          RE_WORD_END.lastIndex = pos + 1\n          RE_WORD_END.test(css)\n          if (RE_WORD_END.lastIndex === 0) {\n            next = css.length - 1\n          } else {\n            next = RE_WORD_END.lastIndex - 2\n          }\n\n          currentToken = ['word', css.slice(pos, next + 1), pos, next]\n          buffer.push(currentToken)\n          pos = next\n        }\n\n        break\n      }\n    }\n\n    pos++\n    return currentToken\n  }\n\n  function back(token) {\n    returned.push(token)\n  }\n\n  return {\n    back,\n    nextToken,\n    endOfFile,\n    position\n  }\n}\n","'use strict'\n\nlet Container = require('./container')\n\nclass AtRule extends Container {\n  constructor(defaults) {\n    super(defaults)\n    this.type = 'atrule'\n  }\n\n  append(...children) {\n    if (!this.proxyOf.nodes) this.nodes = []\n    return super.append(...children)\n  }\n\n  prepend(...children) {\n    if (!this.proxyOf.nodes) this.nodes = []\n    return super.prepend(...children)\n  }\n}\n\nmodule.exports = AtRule\nAtRule.default = AtRule\n\nContainer.registerAtRule(AtRule)\n","'use strict'\n\nlet Container = require('./container')\n\nlet LazyResult, Processor\n\nclass Root extends Container {\n  constructor(defaults) {\n    super(defaults)\n    this.type = 'root'\n    if (!this.nodes) this.nodes = []\n  }\n\n  removeChild(child, ignore) {\n    let index = this.index(child)\n\n    if (!ignore && index === 0 && this.nodes.length > 1) {\n      this.nodes[1].raws.before = this.nodes[index].raws.before\n    }\n\n    return super.removeChild(child)\n  }\n\n  normalize(child, sample, type) {\n    let nodes = super.normalize(child)\n\n    if (sample) {\n      if (type === 'prepend') {\n        if (this.nodes.length > 1) {\n          sample.raws.before = this.nodes[1].raws.before\n        } else {\n          delete sample.raws.before\n        }\n      } else if (this.first !== sample) {\n        for (let node of nodes) {\n          node.raws.before = sample.raws.before\n        }\n      }\n    }\n\n    return nodes\n  }\n\n  toResult(opts = {}) {\n    let lazy = new LazyResult(new Processor(), this, opts)\n    return lazy.stringify()\n  }\n}\n\nRoot.registerLazyResult = dependant => {\n  LazyResult = dependant\n}\n\nRoot.registerProcessor = dependant => {\n  Processor = dependant\n}\n\nmodule.exports = Root\nRoot.default = Root\n\nContainer.registerRoot(Root)\n","'use strict'\n\nlet list = {\n  split(string, separators, last) {\n    let array = []\n    let current = ''\n    let split = false\n\n    let func = 0\n    let inQuote = false\n    let prevQuote = ''\n    let escape = false\n\n    for (let letter of string) {\n      if (escape) {\n        escape = false\n      } else if (letter === '\\\\') {\n        escape = true\n      } else if (inQuote) {\n        if (letter === prevQuote) {\n          inQuote = false\n        }\n      } else if (letter === '\"' || letter === \"'\") {\n        inQuote = true\n        prevQuote = letter\n      } else if (letter === '(') {\n        func += 1\n      } else if (letter === ')') {\n        if (func > 0) func -= 1\n      } else if (func === 0) {\n        if (separators.includes(letter)) split = true\n      }\n\n      if (split) {\n        if (current !== '') array.push(current.trim())\n        current = ''\n        split = false\n      } else {\n        current += letter\n      }\n    }\n\n    if (last || current !== '') array.push(current.trim())\n    return array\n  },\n\n  space(string) {\n    let spaces = [' ', '\\n', '\\t']\n    return list.split(string, spaces)\n  },\n\n  comma(string) {\n    return list.split(string, [','], true)\n  }\n}\n\nmodule.exports = list\nlist.default = list\n","'use strict'\n\nlet Container = require('./container')\nlet list = require('./list')\n\nclass Rule extends Container {\n  constructor(defaults) {\n    super(defaults)\n    this.type = 'rule'\n    if (!this.nodes) this.nodes = []\n  }\n\n  get selectors() {\n    return list.comma(this.selector)\n  }\n\n  set selectors(values) {\n    let match = this.selector ? this.selector.match(/,\\s*/) : null\n    let sep = match ? match[0] : ',' + this.raw('between', 'beforeOpen')\n    this.selector = values.join(sep)\n  }\n}\n\nmodule.exports = Rule\nRule.default = Rule\n\nContainer.registerRule(Rule)\n","'use strict'\n\nlet Declaration = require('./declaration')\nlet tokenizer = require('./tokenize')\nlet Comment = require('./comment')\nlet AtRule = require('./at-rule')\nlet Root = require('./root')\nlet Rule = require('./rule')\n\nconst SAFE_COMMENT_NEIGHBOR = {\n  empty: true,\n  space: true\n}\n\nfunction findLastWithPosition(tokens) {\n  for (let i = tokens.length - 1; i >= 0; i--) {\n    let token = tokens[i]\n    let pos = token[3] || token[2]\n    if (pos) return pos\n  }\n}\n\nclass Parser {\n  constructor(input) {\n    this.input = input\n\n    this.root = new Root()\n    this.current = this.root\n    this.spaces = ''\n    this.semicolon = false\n    this.customProperty = false\n\n    this.createTokenizer()\n    this.root.source = { input, start: { offset: 0, line: 1, column: 1 } }\n  }\n\n  createTokenizer() {\n    this.tokenizer = tokenizer(this.input)\n  }\n\n  parse() {\n    let token\n    while (!this.tokenizer.endOfFile()) {\n      token = this.tokenizer.nextToken()\n\n      switch (token[0]) {\n        case 'space':\n          this.spaces += token[1]\n          break\n\n        case ';':\n          this.freeSemicolon(token)\n          break\n\n        case '}':\n          this.end(token)\n          break\n\n        case 'comment':\n          this.comment(token)\n          break\n\n        case 'at-word':\n          this.atrule(token)\n          break\n\n        case '{':\n          this.emptyRule(token)\n          break\n\n        default:\n          this.other(token)\n          break\n      }\n    }\n    this.endFile()\n  }\n\n  comment(token) {\n    let node = new Comment()\n    this.init(node, token[2])\n    node.source.end = this.getPosition(token[3] || token[2])\n\n    let text = token[1].slice(2, -2)\n    if (/^\\s*$/.test(text)) {\n      node.text = ''\n      node.raws.left = text\n      node.raws.right = ''\n    } else {\n      let match = text.match(/^(\\s*)([^]*\\S)(\\s*)$/)\n      node.text = match[2]\n      node.raws.left = match[1]\n      node.raws.right = match[3]\n    }\n  }\n\n  emptyRule(token) {\n    let node = new Rule()\n    this.init(node, token[2])\n    node.selector = ''\n    node.raws.between = ''\n    this.current = node\n  }\n\n  other(start) {\n    let end = false\n    let type = null\n    let colon = false\n    let bracket = null\n    let brackets = []\n    let customProperty = start[1].startsWith('--')\n\n    let tokens = []\n    let token = start\n    while (token) {\n      type = token[0]\n      tokens.push(token)\n\n      if (type === '(' || type === '[') {\n        if (!bracket) bracket = token\n        brackets.push(type === '(' ? ')' : ']')\n      } else if (customProperty && colon && type === '{') {\n        if (!bracket) bracket = token\n        brackets.push('}')\n      } else if (brackets.length === 0) {\n        if (type === ';') {\n          if (colon) {\n            this.decl(tokens, customProperty)\n            return\n          } else {\n            break\n          }\n        } else if (type === '{') {\n          this.rule(tokens)\n          return\n        } else if (type === '}') {\n          this.tokenizer.back(tokens.pop())\n          end = true\n          break\n        } else if (type === ':') {\n          colon = true\n        }\n      } else if (type === brackets[brackets.length - 1]) {\n        brackets.pop()\n        if (brackets.length === 0) bracket = null\n      }\n\n      token = this.tokenizer.nextToken()\n    }\n\n    if (this.tokenizer.endOfFile()) end = true\n    if (brackets.length > 0) this.unclosedBracket(bracket)\n\n    if (end && colon) {\n      if (!customProperty) {\n        while (tokens.length) {\n          token = tokens[tokens.length - 1][0]\n          if (token !== 'space' && token !== 'comment') break\n          this.tokenizer.back(tokens.pop())\n        }\n      }\n      this.decl(tokens, customProperty)\n    } else {\n      this.unknownWord(tokens)\n    }\n  }\n\n  rule(tokens) {\n    tokens.pop()\n\n    let node = new Rule()\n    this.init(node, tokens[0][2])\n\n    node.raws.between = this.spacesAndCommentsFromEnd(tokens)\n    this.raw(node, 'selector', tokens)\n    this.current = node\n  }\n\n  decl(tokens, customProperty) {\n    let node = new Declaration()\n    this.init(node, tokens[0][2])\n\n    let last = tokens[tokens.length - 1]\n    if (last[0] === ';') {\n      this.semicolon = true\n      tokens.pop()\n    }\n\n    node.source.end = this.getPosition(\n      last[3] || last[2] || findLastWithPosition(tokens)\n    )\n\n    while (tokens[0][0] !== 'word') {\n      if (tokens.length === 1) this.unknownWord(tokens)\n      node.raws.before += tokens.shift()[1]\n    }\n    node.source.start = this.getPosition(tokens[0][2])\n\n    node.prop = ''\n    while (tokens.length) {\n      let type = tokens[0][0]\n      if (type === ':' || type === 'space' || type === 'comment') {\n        break\n      }\n      node.prop += tokens.shift()[1]\n    }\n\n    node.raws.between = ''\n\n    let token\n    while (tokens.length) {\n      token = tokens.shift()\n\n      if (token[0] === ':') {\n        node.raws.between += token[1]\n        break\n      } else {\n        if (token[0] === 'word' && /\\w/.test(token[1])) {\n          this.unknownWord([token])\n        }\n        node.raws.between += token[1]\n      }\n    }\n\n    if (node.prop[0] === '_' || node.prop[0] === '*') {\n      node.raws.before += node.prop[0]\n      node.prop = node.prop.slice(1)\n    }\n\n    let firstSpaces = []\n    let next\n    while (tokens.length) {\n      next = tokens[0][0]\n      if (next !== 'space' && next !== 'comment') break\n      firstSpaces.push(tokens.shift())\n    }\n\n    this.precheckMissedSemicolon(tokens)\n\n    for (let i = tokens.length - 1; i >= 0; i--) {\n      token = tokens[i]\n      if (token[1].toLowerCase() === '!important') {\n        node.important = true\n        let string = this.stringFrom(tokens, i)\n        string = this.spacesFromEnd(tokens) + string\n        if (string !== ' !important') node.raws.important = string\n        break\n      } else if (token[1].toLowerCase() === 'important') {\n        let cache = tokens.slice(0)\n        let str = ''\n        for (let j = i; j > 0; j--) {\n          let type = cache[j][0]\n          if (str.trim().indexOf('!') === 0 && type !== 'space') {\n            break\n          }\n          str = cache.pop()[1] + str\n        }\n        if (str.trim().indexOf('!') === 0) {\n          node.important = true\n          node.raws.important = str\n          tokens = cache\n        }\n      }\n\n      if (token[0] !== 'space' && token[0] !== 'comment') {\n        break\n      }\n    }\n\n    let hasWord = tokens.some(i => i[0] !== 'space' && i[0] !== 'comment')\n\n    if (hasWord) {\n      node.raws.between += firstSpaces.map(i => i[1]).join('')\n      firstSpaces = []\n    }\n    this.raw(node, 'value', firstSpaces.concat(tokens), customProperty)\n\n    if (node.value.includes(':') && !customProperty) {\n      this.checkMissedSemicolon(tokens)\n    }\n  }\n\n  atrule(token) {\n    let node = new AtRule()\n    node.name = token[1].slice(1)\n    if (node.name === '') {\n      this.unnamedAtrule(node, token)\n    }\n    this.init(node, token[2])\n\n    let type\n    let prev\n    let shift\n    let last = false\n    let open = false\n    let params = []\n    let brackets = []\n\n    while (!this.tokenizer.endOfFile()) {\n      token = this.tokenizer.nextToken()\n      type = token[0]\n\n      if (type === '(' || type === '[') {\n        brackets.push(type === '(' ? ')' : ']')\n      } else if (type === '{' && brackets.length > 0) {\n        brackets.push('}')\n      } else if (type === brackets[brackets.length - 1]) {\n        brackets.pop()\n      }\n\n      if (brackets.length === 0) {\n        if (type === ';') {\n          node.source.end = this.getPosition(token[2])\n          this.semicolon = true\n          break\n        } else if (type === '{') {\n          open = true\n          break\n        } else if (type === '}') {\n          if (params.length > 0) {\n            shift = params.length - 1\n            prev = params[shift]\n            while (prev && prev[0] === 'space') {\n              prev = params[--shift]\n            }\n            if (prev) {\n              node.source.end = this.getPosition(prev[3] || prev[2])\n            }\n          }\n          this.end(token)\n          break\n        } else {\n          params.push(token)\n        }\n      } else {\n        params.push(token)\n      }\n\n      if (this.tokenizer.endOfFile()) {\n        last = true\n        break\n      }\n    }\n\n    node.raws.between = this.spacesAndCommentsFromEnd(params)\n    if (params.length) {\n      node.raws.afterName = this.spacesAndCommentsFromStart(params)\n      this.raw(node, 'params', params)\n      if (last) {\n        token = params[params.length - 1]\n        node.source.end = this.getPosition(token[3] || token[2])\n        this.spaces = node.raws.between\n        node.raws.between = ''\n      }\n    } else {\n      node.raws.afterName = ''\n      node.params = ''\n    }\n\n    if (open) {\n      node.nodes = []\n      this.current = node\n    }\n  }\n\n  end(token) {\n    if (this.current.nodes && this.current.nodes.length) {\n      this.current.raws.semicolon = this.semicolon\n    }\n    this.semicolon = false\n\n    this.current.raws.after = (this.current.raws.after || '') + this.spaces\n    this.spaces = ''\n\n    if (this.current.parent) {\n      this.current.source.end = this.getPosition(token[2])\n      this.current = this.current.parent\n    } else {\n      this.unexpectedClose(token)\n    }\n  }\n\n  endFile() {\n    if (this.current.parent) this.unclosedBlock()\n    if (this.current.nodes && this.current.nodes.length) {\n      this.current.raws.semicolon = this.semicolon\n    }\n    this.current.raws.after = (this.current.raws.after || '') + this.spaces\n  }\n\n  freeSemicolon(token) {\n    this.spaces += token[1]\n    if (this.current.nodes) {\n      let prev = this.current.nodes[this.current.nodes.length - 1]\n      if (prev && prev.type === 'rule' && !prev.raws.ownSemicolon) {\n        prev.raws.ownSemicolon = this.spaces\n        this.spaces = ''\n      }\n    }\n  }\n\n  // Helpers\n\n  getPosition(offset) {\n    let pos = this.input.fromOffset(offset)\n    return {\n      offset,\n      line: pos.line,\n      column: pos.col\n    }\n  }\n\n  init(node, offset) {\n    this.current.push(node)\n    node.source = {\n      start: this.getPosition(offset),\n      input: this.input\n    }\n    node.raws.before = this.spaces\n    this.spaces = ''\n    if (node.type !== 'comment') this.semicolon = false\n  }\n\n  raw(node, prop, tokens, customProperty) {\n    let token, type\n    let length = tokens.length\n    let value = ''\n    let clean = true\n    let next, prev\n\n    for (let i = 0; i < length; i += 1) {\n      token = tokens[i]\n      type = token[0]\n      if (type === 'space' && i === length - 1 && !customProperty) {\n        clean = false\n      } else if (type === 'comment') {\n        prev = tokens[i - 1] ? tokens[i - 1][0] : 'empty'\n        next = tokens[i + 1] ? tokens[i + 1][0] : 'empty'\n        if (!SAFE_COMMENT_NEIGHBOR[prev] && !SAFE_COMMENT_NEIGHBOR[next]) {\n          if (value.slice(-1) === ',') {\n            clean = false\n          } else {\n            value += token[1]\n          }\n        } else {\n          clean = false\n        }\n      } else {\n        value += token[1]\n      }\n    }\n    if (!clean) {\n      let raw = tokens.reduce((all, i) => all + i[1], '')\n      node.raws[prop] = { value, raw }\n    }\n    node[prop] = value\n  }\n\n  spacesAndCommentsFromEnd(tokens) {\n    let lastTokenType\n    let spaces = ''\n    while (tokens.length) {\n      lastTokenType = tokens[tokens.length - 1][0]\n      if (lastTokenType !== 'space' && lastTokenType !== 'comment') break\n      spaces = tokens.pop()[1] + spaces\n    }\n    return spaces\n  }\n\n  spacesAndCommentsFromStart(tokens) {\n    let next\n    let spaces = ''\n    while (tokens.length) {\n      next = tokens[0][0]\n      if (next !== 'space' && next !== 'comment') break\n      spaces += tokens.shift()[1]\n    }\n    return spaces\n  }\n\n  spacesFromEnd(tokens) {\n    let lastTokenType\n    let spaces = ''\n    while (tokens.length) {\n      lastTokenType = tokens[tokens.length - 1][0]\n      if (lastTokenType !== 'space') break\n      spaces = tokens.pop()[1] + spaces\n    }\n    return spaces\n  }\n\n  stringFrom(tokens, from) {\n    let result = ''\n    for (let i = from; i < tokens.length; i++) {\n      result += tokens[i][1]\n    }\n    tokens.splice(from, tokens.length - from)\n    return result\n  }\n\n  colon(tokens) {\n    let brackets = 0\n    let token, type, prev\n    for (let [i, element] of tokens.entries()) {\n      token = element\n      type = token[0]\n\n      if (type === '(') {\n        brackets += 1\n      }\n      if (type === ')') {\n        brackets -= 1\n      }\n      if (brackets === 0 && type === ':') {\n        if (!prev) {\n          this.doubleColon(token)\n        } else if (prev[0] === 'word' && prev[1] === 'progid') {\n          continue\n        } else {\n          return i\n        }\n      }\n\n      prev = token\n    }\n    return false\n  }\n\n  // Errors\n\n  unclosedBracket(bracket) {\n    throw this.input.error(\n      'Unclosed bracket',\n      { offset: bracket[2] },\n      { offset: bracket[2] + 1 }\n    )\n  }\n\n  unknownWord(tokens) {\n    throw this.input.error(\n      'Unknown word',\n      { offset: tokens[0][2] },\n      { offset: tokens[0][2] + tokens[0][1].length }\n    )\n  }\n\n  unexpectedClose(token) {\n    throw this.input.error(\n      'Unexpected }',\n      { offset: token[2] },\n      { offset: token[2] + 1 }\n    )\n  }\n\n  unclosedBlock() {\n    let pos = this.current.source.start\n    throw this.input.error('Unclosed block', pos.line, pos.column)\n  }\n\n  doubleColon(token) {\n    throw this.input.error(\n      'Double colon',\n      { offset: token[2] },\n      { offset: token[2] + token[1].length }\n    )\n  }\n\n  unnamedAtrule(node, token) {\n    throw this.input.error(\n      'At-rule without name',\n      { offset: token[2] },\n      { offset: token[2] + token[1].length }\n    )\n  }\n\n  precheckMissedSemicolon(/* tokens */) {\n    // Hook for Safe Parser\n  }\n\n  checkMissedSemicolon(tokens) {\n    let colon = this.colon(tokens)\n    if (colon === false) return\n\n    let founded = 0\n    let token\n    for (let j = colon - 1; j >= 0; j--) {\n      token = tokens[j]\n      if (token[0] !== 'space') {\n        founded += 1\n        if (founded === 2) break\n      }\n    }\n    // If the token is a word, e.g. `!important`, `red` or any other valid property's value.\n    // Then we need to return the colon after that word token. [3] is the \"end\" colon of that word.\n    // And because we need it after that one we do +1 to get the next one.\n    throw this.input.error(\n      'Missed semicolon',\n      token[0] === 'word' ? token[3] + 1 : token[2]\n    )\n  }\n}\n\nmodule.exports = Parser\n","'use strict'\n\nlet Container = require('./container')\nlet Parser = require('./parser')\nlet Input = require('./input')\n\nfunction parse(css, opts) {\n  let input = new Input(css, opts)\n  let parser = new Parser(input)\n  try {\n    parser.parse()\n  } catch (e) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (e.name === 'CssSyntaxError' && opts && opts.from) {\n        if (/\\.scss$/i.test(opts.from)) {\n          e.message +=\n            '\\nYou tried to parse SCSS with ' +\n            'the standard CSS parser; ' +\n            'try again with the postcss-scss parser'\n        } else if (/\\.sass/i.test(opts.from)) {\n          e.message +=\n            '\\nYou tried to parse Sass with ' +\n            'the standard CSS parser; ' +\n            'try again with the postcss-sass parser'\n        } else if (/\\.less$/i.test(opts.from)) {\n          e.message +=\n            '\\nYou tried to parse Less with ' +\n            'the standard CSS parser; ' +\n            'try again with the postcss-less parser'\n        }\n      }\n    }\n    throw e\n  }\n\n  return parser.root\n}\n\nmodule.exports = parse\nparse.default = parse\n\nContainer.registerParse(parse)\n","'use strict'\n\nlet { isClean, my } = require('./symbols')\nlet MapGenerator = require('./map-generator')\nlet stringify = require('./stringify')\nlet Container = require('./container')\nlet Document = require('./document')\nlet warnOnce = require('./warn-once')\nlet Result = require('./result')\nlet parse = require('./parse')\nlet Root = require('./root')\n\nconst TYPE_TO_CLASS_NAME = {\n  document: 'Document',\n  root: 'Root',\n  atrule: 'AtRule',\n  rule: 'Rule',\n  decl: 'Declaration',\n  comment: 'Comment'\n}\n\nconst PLUGIN_PROPS = {\n  postcssPlugin: true,\n  prepare: true,\n  Once: true,\n  Document: true,\n  Root: true,\n  Declaration: true,\n  Rule: true,\n  AtRule: true,\n  Comment: true,\n  DeclarationExit: true,\n  RuleExit: true,\n  AtRuleExit: true,\n  CommentExit: true,\n  RootExit: true,\n  DocumentExit: true,\n  OnceExit: true\n}\n\nconst NOT_VISITORS = {\n  postcssPlugin: true,\n  prepare: true,\n  Once: true\n}\n\nconst CHILDREN = 0\n\nfunction isPromise(obj) {\n  return typeof obj === 'object' && typeof obj.then === 'function'\n}\n\nfunction getEvents(node) {\n  let key = false\n  let type = TYPE_TO_CLASS_NAME[node.type]\n  if (node.type === 'decl') {\n    key = node.prop.toLowerCase()\n  } else if (node.type === 'atrule') {\n    key = node.name.toLowerCase()\n  }\n\n  if (key && node.append) {\n    return [\n      type,\n      type + '-' + key,\n      CHILDREN,\n      type + 'Exit',\n      type + 'Exit-' + key\n    ]\n  } else if (key) {\n    return [type, type + '-' + key, type + 'Exit', type + 'Exit-' + key]\n  } else if (node.append) {\n    return [type, CHILDREN, type + 'Exit']\n  } else {\n    return [type, type + 'Exit']\n  }\n}\n\nfunction toStack(node) {\n  let events\n  if (node.type === 'document') {\n    events = ['Document', CHILDREN, 'DocumentExit']\n  } else if (node.type === 'root') {\n    events = ['Root', CHILDREN, 'RootExit']\n  } else {\n    events = getEvents(node)\n  }\n\n  return {\n    node,\n    events,\n    eventIndex: 0,\n    visitors: [],\n    visitorIndex: 0,\n    iterator: 0\n  }\n}\n\nfunction cleanMarks(node) {\n  node[isClean] = false\n  if (node.nodes) node.nodes.forEach(i => cleanMarks(i))\n  return node\n}\n\nlet postcss = {}\n\nclass LazyResult {\n  constructor(processor, css, opts) {\n    this.stringified = false\n    this.processed = false\n\n    let root\n    if (\n      typeof css === 'object' &&\n      css !== null &&\n      (css.type === 'root' || css.type === 'document')\n    ) {\n      root = cleanMarks(css)\n    } else if (css instanceof LazyResult || css instanceof Result) {\n      root = cleanMarks(css.root)\n      if (css.map) {\n        if (typeof opts.map === 'undefined') opts.map = {}\n        if (!opts.map.inline) opts.map.inline = false\n        opts.map.prev = css.map\n      }\n    } else {\n      let parser = parse\n      if (opts.syntax) parser = opts.syntax.parse\n      if (opts.parser) parser = opts.parser\n      if (parser.parse) parser = parser.parse\n\n      try {\n        root = parser(css, opts)\n      } catch (error) {\n        this.processed = true\n        this.error = error\n      }\n\n      if (root && !root[my]) {\n        /* c8 ignore next 2 */\n        Container.rebuild(root)\n      }\n    }\n\n    this.result = new Result(processor, root, opts)\n    this.helpers = { ...postcss, result: this.result, postcss }\n    this.plugins = this.processor.plugins.map(plugin => {\n      if (typeof plugin === 'object' && plugin.prepare) {\n        return { ...plugin, ...plugin.prepare(this.result) }\n      } else {\n        return plugin\n      }\n    })\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'LazyResult'\n  }\n\n  get processor() {\n    return this.result.processor\n  }\n\n  get opts() {\n    return this.result.opts\n  }\n\n  get css() {\n    return this.stringify().css\n  }\n\n  get content() {\n    return this.stringify().content\n  }\n\n  get map() {\n    return this.stringify().map\n  }\n\n  get root() {\n    return this.sync().root\n  }\n\n  get messages() {\n    return this.sync().messages\n  }\n\n  warnings() {\n    return this.sync().warnings()\n  }\n\n  toString() {\n    return this.css\n  }\n\n  then(onFulfilled, onRejected) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (!('from' in this.opts)) {\n        warnOnce(\n          'Without `from` option PostCSS could generate wrong source map ' +\n            'and will not find Browserslist config. Set it to CSS file path ' +\n            'or to `undefined` to prevent this warning.'\n        )\n      }\n    }\n    return this.async().then(onFulfilled, onRejected)\n  }\n\n  catch(onRejected) {\n    return this.async().catch(onRejected)\n  }\n\n  finally(onFinally) {\n    return this.async().then(onFinally, onFinally)\n  }\n\n  async() {\n    if (this.error) return Promise.reject(this.error)\n    if (this.processed) return Promise.resolve(this.result)\n    if (!this.processing) {\n      this.processing = this.runAsync()\n    }\n    return this.processing\n  }\n\n  sync() {\n    if (this.error) throw this.error\n    if (this.processed) return this.result\n    this.processed = true\n\n    if (this.processing) {\n      throw this.getAsyncError()\n    }\n\n    for (let plugin of this.plugins) {\n      let promise = this.runOnRoot(plugin)\n      if (isPromise(promise)) {\n        throw this.getAsyncError()\n      }\n    }\n\n    this.prepareVisitors()\n    if (this.hasListener) {\n      let root = this.result.root\n      while (!root[isClean]) {\n        root[isClean] = true\n        this.walkSync(root)\n      }\n      if (this.listeners.OnceExit) {\n        if (root.type === 'document') {\n          for (let subRoot of root.nodes) {\n            this.visitSync(this.listeners.OnceExit, subRoot)\n          }\n        } else {\n          this.visitSync(this.listeners.OnceExit, root)\n        }\n      }\n    }\n\n    return this.result\n  }\n\n  stringify() {\n    if (this.error) throw this.error\n    if (this.stringified) return this.result\n    this.stringified = true\n\n    this.sync()\n\n    let opts = this.result.opts\n    let str = stringify\n    if (opts.syntax) str = opts.syntax.stringify\n    if (opts.stringifier) str = opts.stringifier\n    if (str.stringify) str = str.stringify\n\n    let map = new MapGenerator(str, this.result.root, this.result.opts)\n    let data = map.generate()\n    this.result.css = data[0]\n    this.result.map = data[1]\n\n    return this.result\n  }\n\n  walkSync(node) {\n    node[isClean] = true\n    let events = getEvents(node)\n    for (let event of events) {\n      if (event === CHILDREN) {\n        if (node.nodes) {\n          node.each(child => {\n            if (!child[isClean]) this.walkSync(child)\n          })\n        }\n      } else {\n        let visitors = this.listeners[event]\n        if (visitors) {\n          if (this.visitSync(visitors, node.toProxy())) return\n        }\n      }\n    }\n  }\n\n  visitSync(visitors, node) {\n    for (let [plugin, visitor] of visitors) {\n      this.result.lastPlugin = plugin\n      let promise\n      try {\n        promise = visitor(node, this.helpers)\n      } catch (e) {\n        throw this.handleError(e, node.proxyOf)\n      }\n      if (node.type !== 'root' && node.type !== 'document' && !node.parent) {\n        return true\n      }\n      if (isPromise(promise)) {\n        throw this.getAsyncError()\n      }\n    }\n  }\n\n  runOnRoot(plugin) {\n    this.result.lastPlugin = plugin\n    try {\n      if (typeof plugin === 'object' && plugin.Once) {\n        if (this.result.root.type === 'document') {\n          let roots = this.result.root.nodes.map(root =>\n            plugin.Once(root, this.helpers)\n          )\n\n          if (isPromise(roots[0])) {\n            return Promise.all(roots)\n          }\n\n          return roots\n        }\n\n        return plugin.Once(this.result.root, this.helpers)\n      } else if (typeof plugin === 'function') {\n        return plugin(this.result.root, this.result)\n      }\n    } catch (error) {\n      throw this.handleError(error)\n    }\n  }\n\n  getAsyncError() {\n    throw new Error('Use process(css).then(cb) to work with async plugins')\n  }\n\n  handleError(error, node) {\n    let plugin = this.result.lastPlugin\n    try {\n      if (node) node.addToError(error)\n      this.error = error\n      if (error.name === 'CssSyntaxError' && !error.plugin) {\n        error.plugin = plugin.postcssPlugin\n        error.setMessage()\n      } else if (plugin.postcssVersion) {\n        if (process.env.NODE_ENV !== 'production') {\n          let pluginName = plugin.postcssPlugin\n          let pluginVer = plugin.postcssVersion\n          let runtimeVer = this.result.processor.version\n          let a = pluginVer.split('.')\n          let b = runtimeVer.split('.')\n\n          if (a[0] !== b[0] || parseInt(a[1]) > parseInt(b[1])) {\n            // eslint-disable-next-line no-console\n            console.error(\n              'Unknown error from PostCSS plugin. Your current PostCSS ' +\n                'version is ' +\n                runtimeVer +\n                ', but ' +\n                pluginName +\n                ' uses ' +\n                pluginVer +\n                '. Perhaps this is the source of the error below.'\n            )\n          }\n        }\n      }\n    } catch (err) {\n      /* c8 ignore next 3 */\n      // eslint-disable-next-line no-console\n      if (console && console.error) console.error(err)\n    }\n    return error\n  }\n\n  async runAsync() {\n    this.plugin = 0\n    for (let i = 0; i < this.plugins.length; i++) {\n      let plugin = this.plugins[i]\n      let promise = this.runOnRoot(plugin)\n      if (isPromise(promise)) {\n        try {\n          await promise\n        } catch (error) {\n          throw this.handleError(error)\n        }\n      }\n    }\n\n    this.prepareVisitors()\n    if (this.hasListener) {\n      let root = this.result.root\n      while (!root[isClean]) {\n        root[isClean] = true\n        let stack = [toStack(root)]\n        while (stack.length > 0) {\n          let promise = this.visitTick(stack)\n          if (isPromise(promise)) {\n            try {\n              await promise\n            } catch (e) {\n              let node = stack[stack.length - 1].node\n              throw this.handleError(e, node)\n            }\n          }\n        }\n      }\n\n      if (this.listeners.OnceExit) {\n        for (let [plugin, visitor] of this.listeners.OnceExit) {\n          this.result.lastPlugin = plugin\n          try {\n            if (root.type === 'document') {\n              let roots = root.nodes.map(subRoot =>\n                visitor(subRoot, this.helpers)\n              )\n\n              await Promise.all(roots)\n            } else {\n              await visitor(root, this.helpers)\n            }\n          } catch (e) {\n            throw this.handleError(e)\n          }\n        }\n      }\n    }\n\n    this.processed = true\n    return this.stringify()\n  }\n\n  prepareVisitors() {\n    this.listeners = {}\n    let add = (plugin, type, cb) => {\n      if (!this.listeners[type]) this.listeners[type] = []\n      this.listeners[type].push([plugin, cb])\n    }\n    for (let plugin of this.plugins) {\n      if (typeof plugin === 'object') {\n        for (let event in plugin) {\n          if (!PLUGIN_PROPS[event] && /^[A-Z]/.test(event)) {\n            throw new Error(\n              `Unknown event ${event} in ${plugin.postcssPlugin}. ` +\n                `Try to update PostCSS (${this.processor.version} now).`\n            )\n          }\n          if (!NOT_VISITORS[event]) {\n            if (typeof plugin[event] === 'object') {\n              for (let filter in plugin[event]) {\n                if (filter === '*') {\n                  add(plugin, event, plugin[event][filter])\n                } else {\n                  add(\n                    plugin,\n                    event + '-' + filter.toLowerCase(),\n                    plugin[event][filter]\n                  )\n                }\n              }\n            } else if (typeof plugin[event] === 'function') {\n              add(plugin, event, plugin[event])\n            }\n          }\n        }\n      }\n    }\n    this.hasListener = Object.keys(this.listeners).length > 0\n  }\n\n  visitTick(stack) {\n    let visit = stack[stack.length - 1]\n    let { node, visitors } = visit\n\n    if (node.type !== 'root' && node.type !== 'document' && !node.parent) {\n      stack.pop()\n      return\n    }\n\n    if (visitors.length > 0 && visit.visitorIndex < visitors.length) {\n      let [plugin, visitor] = visitors[visit.visitorIndex]\n      visit.visitorIndex += 1\n      if (visit.visitorIndex === visitors.length) {\n        visit.visitors = []\n        visit.visitorIndex = 0\n      }\n      this.result.lastPlugin = plugin\n      try {\n        return visitor(node.toProxy(), this.helpers)\n      } catch (e) {\n        throw this.handleError(e, node)\n      }\n    }\n\n    if (visit.iterator !== 0) {\n      let iterator = visit.iterator\n      let child\n      while ((child = node.nodes[node.indexes[iterator]])) {\n        node.indexes[iterator] += 1\n        if (!child[isClean]) {\n          child[isClean] = true\n          stack.push(toStack(child))\n          return\n        }\n      }\n      visit.iterator = 0\n      delete node.indexes[iterator]\n    }\n\n    let events = visit.events\n    while (visit.eventIndex < events.length) {\n      let event = events[visit.eventIndex]\n      visit.eventIndex += 1\n      if (event === CHILDREN) {\n        if (node.nodes && node.nodes.length) {\n          node[isClean] = true\n          visit.iterator = node.getIterator()\n        }\n        return\n      } else if (this.listeners[event]) {\n        visit.visitors = this.listeners[event]\n        return\n      }\n    }\n    stack.pop()\n  }\n}\n\nLazyResult.registerPostcss = dependant => {\n  postcss = dependant\n}\n\nmodule.exports = LazyResult\nLazyResult.default = LazyResult\n\nRoot.registerLazyResult(LazyResult)\nDocument.registerLazyResult(LazyResult)\n","'use strict'\n\nlet MapGenerator = require('./map-generator')\nlet stringify = require('./stringify')\nlet warnOnce = require('./warn-once')\nlet parse = require('./parse')\nconst Result = require('./result')\n\nclass NoWorkResult {\n  constructor(processor, css, opts) {\n    css = css.toString()\n    this.stringified = false\n\n    this._processor = processor\n    this._css = css\n    this._opts = opts\n    this._map = undefined\n    let root\n\n    let str = stringify\n    this.result = new Result(this._processor, root, this._opts)\n    this.result.css = css\n\n    let self = this\n    Object.defineProperty(this.result, 'root', {\n      get() {\n        return self.root\n      }\n    })\n\n    let map = new MapGenerator(str, root, this._opts, css)\n    if (map.isMap()) {\n      let [generatedCSS, generatedMap] = map.generate()\n      if (generatedCSS) {\n        this.result.css = generatedCSS\n      }\n      if (generatedMap) {\n        this.result.map = generatedMap\n      }\n    }\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'NoWorkResult'\n  }\n\n  get processor() {\n    return this.result.processor\n  }\n\n  get opts() {\n    return this.result.opts\n  }\n\n  get css() {\n    return this.result.css\n  }\n\n  get content() {\n    return this.result.css\n  }\n\n  get map() {\n    return this.result.map\n  }\n\n  get root() {\n    if (this._root) {\n      return this._root\n    }\n\n    let root\n    let parser = parse\n\n    try {\n      root = parser(this._css, this._opts)\n    } catch (error) {\n      this.error = error\n    }\n\n    if (this.error) {\n      throw this.error\n    } else {\n      this._root = root\n      return root\n    }\n  }\n\n  get messages() {\n    return []\n  }\n\n  warnings() {\n    return []\n  }\n\n  toString() {\n    return this._css\n  }\n\n  then(onFulfilled, onRejected) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (!('from' in this._opts)) {\n        warnOnce(\n          'Without `from` option PostCSS could generate wrong source map ' +\n            'and will not find Browserslist config. Set it to CSS file path ' +\n            'or to `undefined` to prevent this warning.'\n        )\n      }\n    }\n\n    return this.async().then(onFulfilled, onRejected)\n  }\n\n  catch(onRejected) {\n    return this.async().catch(onRejected)\n  }\n\n  finally(onFinally) {\n    return this.async().then(onFinally, onFinally)\n  }\n\n  async() {\n    if (this.error) return Promise.reject(this.error)\n    return Promise.resolve(this.result)\n  }\n\n  sync() {\n    if (this.error) throw this.error\n    return this.result\n  }\n}\n\nmodule.exports = NoWorkResult\nNoWorkResult.default = NoWorkResult\n","'use strict'\n\nlet NoWorkResult = require('./no-work-result')\nlet LazyResult = require('./lazy-result')\nlet Document = require('./document')\nlet Root = require('./root')\n\nclass Processor {\n  constructor(plugins = []) {\n    this.version = '8.4.23'\n    this.plugins = this.normalize(plugins)\n  }\n\n  use(plugin) {\n    this.plugins = this.plugins.concat(this.normalize([plugin]))\n    return this\n  }\n\n  process(css, opts = {}) {\n    if (\n      this.plugins.length === 0 &&\n      typeof opts.parser === 'undefined' &&\n      typeof opts.stringifier === 'undefined' &&\n      typeof opts.syntax === 'undefined'\n    ) {\n      return new NoWorkResult(this, css, opts)\n    } else {\n      return new LazyResult(this, css, opts)\n    }\n  }\n\n  normalize(plugins) {\n    let normalized = []\n    for (let i of plugins) {\n      if (i.postcss === true) {\n        i = i()\n      } else if (i.postcss) {\n        i = i.postcss\n      }\n\n      if (typeof i === 'object' && Array.isArray(i.plugins)) {\n        normalized = normalized.concat(i.plugins)\n      } else if (typeof i === 'object' && i.postcssPlugin) {\n        normalized.push(i)\n      } else if (typeof i === 'function') {\n        normalized.push(i)\n      } else if (typeof i === 'object' && (i.parse || i.stringify)) {\n        if (process.env.NODE_ENV !== 'production') {\n          throw new Error(\n            'PostCSS syntaxes cannot be used as plugins. Instead, please use ' +\n              'one of the syntax/parser/stringifier options as outlined ' +\n              'in your PostCSS runner documentation.'\n          )\n        }\n      } else {\n        throw new Error(i + ' is not a PostCSS plugin')\n      }\n    }\n    return normalized\n  }\n}\n\nmodule.exports = Processor\nProcessor.default = Processor\n\nRoot.registerProcessor(Processor)\nDocument.registerProcessor(Processor)\n","'use strict'\n\nlet Declaration = require('./declaration')\nlet PreviousMap = require('./previous-map')\nlet Comment = require('./comment')\nlet AtRule = require('./at-rule')\nlet Input = require('./input')\nlet Root = require('./root')\nlet Rule = require('./rule')\n\nfunction fromJSON(json, inputs) {\n  if (Array.isArray(json)) return json.map(n => fromJSON(n))\n\n  let { inputs: ownInputs, ...defaults } = json\n  if (ownInputs) {\n    inputs = []\n    for (let input of ownInputs) {\n      let inputHydrated = { ...input, __proto__: Input.prototype }\n      if (inputHydrated.map) {\n        inputHydrated.map = {\n          ...inputHydrated.map,\n          __proto__: PreviousMap.prototype\n        }\n      }\n      inputs.push(inputHydrated)\n    }\n  }\n  if (defaults.nodes) {\n    defaults.nodes = json.nodes.map(n => fromJSON(n, inputs))\n  }\n  if (defaults.source) {\n    let { inputId, ...source } = defaults.source\n    defaults.source = source\n    if (inputId != null) {\n      defaults.source.input = inputs[inputId]\n    }\n  }\n  if (defaults.type === 'root') {\n    return new Root(defaults)\n  } else if (defaults.type === 'decl') {\n    return new Declaration(defaults)\n  } else if (defaults.type === 'rule') {\n    return new Rule(defaults)\n  } else if (defaults.type === 'comment') {\n    return new Comment(defaults)\n  } else if (defaults.type === 'atrule') {\n    return new AtRule(defaults)\n  } else {\n    throw new Error('Unknown node type: ' + json.type)\n  }\n}\n\nmodule.exports = fromJSON\nfromJSON.default = fromJSON\n","'use strict'\n\nlet CssSyntaxError = require('./css-syntax-error')\nlet Declaration = require('./declaration')\nlet LazyResult = require('./lazy-result')\nlet Container = require('./container')\nlet Processor = require('./processor')\nlet stringify = require('./stringify')\nlet fromJSON = require('./fromJSON')\nlet Document = require('./document')\nlet Warning = require('./warning')\nlet Comment = require('./comment')\nlet AtRule = require('./at-rule')\nlet Result = require('./result.js')\nlet Input = require('./input')\nlet parse = require('./parse')\nlet list = require('./list')\nlet Rule = require('./rule')\nlet Root = require('./root')\nlet Node = require('./node')\n\nfunction postcss(...plugins) {\n  if (plugins.length === 1 && Array.isArray(plugins[0])) {\n    plugins = plugins[0]\n  }\n  return new Processor(plugins)\n}\n\npostcss.plugin = function plugin(name, initializer) {\n  let warningPrinted = false\n  function creator(...args) {\n    // eslint-disable-next-line no-console\n    if (console && console.warn && !warningPrinted) {\n      warningPrinted = true\n      // eslint-disable-next-line no-console\n      console.warn(\n        name +\n          ': postcss.plugin was deprecated. Migration guide:\\n' +\n          'https://evilmartians.com/chronicles/postcss-8-plugin-migration'\n      )\n      if (process.env.LANG && process.env.LANG.startsWith('cn')) {\n        /* c8 ignore next 7 */\n        // eslint-disable-next-line no-console\n        console.warn(\n          name +\n            ': 里面 postcss.plugin 被弃用. 迁移指南:\\n' +\n            'https://www.w3ctech.com/topic/2226'\n        )\n      }\n    }\n    let transformer = initializer(...args)\n    transformer.postcssPlugin = name\n    transformer.postcssVersion = new Processor().version\n    return transformer\n  }\n\n  let cache\n  Object.defineProperty(creator, 'postcss', {\n    get() {\n      if (!cache) cache = creator()\n      return cache\n    }\n  })\n\n  creator.process = function (css, processOpts, pluginOpts) {\n    return postcss([creator(pluginOpts)]).process(css, processOpts)\n  }\n\n  return creator\n}\n\npostcss.stringify = stringify\npostcss.parse = parse\npostcss.fromJSON = fromJSON\npostcss.list = list\n\npostcss.comment = defaults => new Comment(defaults)\npostcss.atRule = defaults => new AtRule(defaults)\npostcss.decl = defaults => new Declaration(defaults)\npostcss.rule = defaults => new Rule(defaults)\npostcss.root = defaults => new Root(defaults)\npostcss.document = defaults => new Document(defaults)\n\npostcss.CssSyntaxError = CssSyntaxError\npostcss.Declaration = Declaration\npostcss.Container = Container\npostcss.Processor = Processor\npostcss.Document = Document\npostcss.Comment = Comment\npostcss.Warning = Warning\npostcss.AtRule = AtRule\npostcss.Result = Result\npostcss.Input = Input\npostcss.Rule = Rule\npostcss.Root = Root\npostcss.Node = Node\n\nLazyResult.registerPostcss(postcss)\n\nmodule.exports = postcss\npostcss.default = postcss\n","import postcss from './postcss.js'\n\nexport default postcss\n\nexport const stringify = postcss.stringify\nexport const fromJSON = postcss.fromJSON\nexport const plugin = postcss.plugin\nexport const parse = postcss.parse\nexport const list = postcss.list\n\nexport const document = postcss.document\nexport const comment = postcss.comment\nexport const atRule = postcss.atRule\nexport const rule = postcss.rule\nexport const decl = postcss.decl\nexport const root = postcss.root\n\nexport const CssSyntaxError = postcss.CssSyntaxError\nexport const Declaration = postcss.Declaration\nexport const Container = postcss.Container\nexport const Processor = postcss.Processor\nexport const Document = postcss.Document\nexport const Comment = postcss.Comment\nexport const Warning = postcss.Warning\nexport const AtRule = postcss.AtRule\nexport const Result = postcss.Result\nexport const Input = postcss.Input\nexport const Rule = postcss.Rule\nexport const Root = postcss.Root\nexport const Node = postcss.Node\n","// noinspection JSUnusedGlobalSymbols\n\n\"use strict\";\n\n// Should all be language neutral\n\nimport {\n    DEFINITE,\n    INDEFINITE,\n    lang,\n    util,\n    w,\n    errormsg,\n    failedmsg,\n    falsemsg,\n    formatList,\n    clearScreen,\n    debugmsg,\n    msg,\n    NULL_FUNC,\n    printOrRun,\n    processText,\n    respond,\n    scopeReachable,\n    sentenceCase,\n    showMenu,\n    player,\n    loc,\n    world,\n    settings,\n    regions, createItem, cloneObject, game, Exit\n} from \"../index.js\";\nimport {list} from \"postcss\";\n\nexport const TAKEABLE_DICTIONARY = {\n  afterCreation:function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      verbList.push(o.isAtLoc(player().name) ? lang.verbs.drop : lang.verbs.take)\n    })\n  },\n\n  takeable:true,\n  msgDrop:lang.drop_successful,\n  msgDropIn:lang.done_msg,\n  msgTake:lang.take_successful,\n  msgTakeOut:lang.done_msg,\n\n  drop:function(options) {\n    if (this.testDrop && !this.testDrop(options)) return false\n    const dest = w[options.char.loc]\n    if (dest.testDropIn && !dest.testDropIn(options)) return false\n\n    msg(this.msgDrop, options);\n    this.moveToFrom(options, \"loc\", \"name\")\n    return true;\n  },\n\n  take:function(options) {\n    const char = options.char\n    if (this.isAtLoc(char.name)) return falsemsg(lang.already_have, options)\n    if (!char.testManipulate(this, \"take\")) return false\n    if (this.testTake && !this.testTake(options)) return false\n    if (w[char.loc].testTakeOut && !w[char.loc].testTakeOut(options)) return false\n\n    msg(this.msgTake, options)\n\n    this.moveToFrom(options, \"name\", \"loc\")\n    if (this.scenery) this.scenery = false\n    return true\n  },\n\n  // This returns the location from which the item is to be taken\n  // (and does not do taking from a location).\n  // This can be useful for weird objects, such as ropes\n  takeFromLoc:function(char) { return this.loc },\n\n};\n\nexport const TAKEABLE = () => TAKEABLE_DICTIONARY;\n\nexport const SHIFTABLE = function() {\n    return {\n      shiftable: true,\n  };\n}\n\nexport const createEnsemble = function(name, ensembleMembers, dict) {\n  const res = createItem(name, dict);\n  res.ensemble = true;\n  res.ensembleMembers = ensembleMembers;\n  res.parserPriority = 30;\n  res.inventorySkip = true;\n  res.takeable = true;\n  res.getWorn = function(situation) { return this.isAtLoc(this.ensembleMembers[0].loc, situation) && this.ensembleMembers[0].getWorn(); }\n\n  res.nameModifierFunctions = [function(o, list) {\n    if (o.ensembleMembers[0].getWorn() && o.isAllTogether() && o.ensembleMembers[0].isAtLoc(player().name)) list.push(lang.invModifiers.worn)\n  }]\n\n\n  // Tests if all parts are n the same location and either all are worn or none are worn\n  // We can use this to determine if the set is together or not too\n  res.isLocatedAt = function(loc, situation) {\n    if (situation !== world.PARSER) return false;\n    const worn = this.ensembleMembers[0].getWorn();\n    for (let member of this.ensembleMembers) {\n      if (member.loc !== loc) return false;\n      if (member.getWorn() !== worn) return false;\n    }\n    return true;\n  }\n\n\n  // Tests if all parts are together\n  res.isAllTogether = function() {\n    const worn = this.ensembleMembers[0].getWorn();\n    const loc = this.ensembleMembers[0].loc;\n    for (let member of this.ensembleMembers) {\n      if (member.loc !== loc) return false;\n      if (member.breakEnsemble && member.breakEnsemble()) return false;\n      if (member.getWorn() !== worn) return false;\n    }\n    return true;\n  }\n\n  res.msgDrop = lang.drop_successful\n  res.msgTake = lang.take_successful\n\n  res.drop = function(options) {\n    const dest = w[options.char.loc]\n    if (dest.testDrop && !dest.testDrop(options)) return false\n    if (dest.testDropIn && !dest.testDropIn(options)) return false\n    msg(this.msgDrop, options);\n    for (let member of this.ensembleMembers) {\n      member.moveToFrom(options, \"loc\")\n    }\n    return true;\n  }\n\n  res.take = function(options) {\n    const char = options.char\n    if (this.isAtLoc(char.name)) {\n      msg(lang.already_have, options);\n      return false;\n    }\n\n    if (!char.testManipulate(this, \"take\")) return false;\n    if (this.testTake && !this.testTake(options)) return false\n    if (w[char.loc].testTakeOut && !w[char.loc].testTakeOut(options)) return false\n    msg(this.msgTake, options);\n    for (let member of this.ensembleMembers) {\n      member.moveToFrom(options, \"name\")\n      if (member.scenery) member.scenery = false\n    }\n    return true;\n  }\n\n  for (let member of ensembleMembers) {\n    member.ensembleMaster = res;\n  }\n  return res;\n}\n\nexport const MERCH = function(value, locs) {\n  const res = {\n    price:value,\n    getPrice:function() { return this.price },\n    msgPurchase:lang.purchase_successful,\n    msgSell:lang.sell_successful,\n\n\n    // The price when the player sells the item\n    // By default, half the \"list\" price\n    //\n    getSellingPrice:function(char) {\n      if (w[char.loc].buyingValue) {\n        return Math.round(this.getPrice() * (w[char.loc].buyingValue) / 100);\n      }\n      return Math.round(this.getPrice() / 2);\n    },\n\n    // The price when the player buys the item\n    // Uses the sellingDiscount, as te shop is selling it!\n    getBuyingPrice:function(char) {\n      if (w[char.loc].sellingDiscount) {\n        return Math.round(this.getPrice() * (100 - w[char.loc].sellingDiscount) / 100);\n      }\n      return this.getPrice();\n    },\n\n    isLocatedAt:function(loc, situation) {\n      if (this.salesLoc || this.salesLocs) {\n        // In the shop for sale\n        return (situation === world.PURCHASE || situation === world.PARSER) && this.isForSale(loc)\n      }\n      else {\n        // Acting like a normal item\n        return this.loc === loc\n      }\n    },\n\n    isForSale:function(loc) {\n      if (!this.salesLoc && !this.salesLocs) return false  // already sold\n      if (this.doNotClone) return (this.salesLoc === loc)\n      return (this.salesLocs.includes(loc))\n    },\n\n    canBeSoldHere:function(loc) {\n      return w[loc].willBuy && w[loc].willBuy(this);\n    },\n\n    purchase:function(options) {\n      if (this.testPurchase && !this.testPurchase(options)) return false\n      if (!this.isForSale(options.char.loc)) {\n        return failedmsg(this.doNotClone && this.isAtLoc(options.char.name) ? lang.cannot_purchase_again : lang.cannot_purchase_here, options)\n      }\n\n      const cost = this.getBuyingPrice(options.char);\n      options.money = cost\n      if (options.char.money < cost) return failedmsg(lang.cannot_afford, options);\n      return this.purchaseScript(options, options.char, cost)\n    },\n\n    purchaseScript:function(options, char, cost) {\n      char.money -= cost;\n      msg(this.msgPurchase, options);\n      if (this.doNotClone) {\n        this.loc = char.name\n        delete this.salesLoc\n        if (this.afterPurchase) this.afterPurchase(options)\n      }\n      else {\n        const o = cloneObject(this, char.name)\n        o.loc = char.name\n        delete o.salesLocs\n        if (o.afterPurchase) o.afterPurchase(options)\n      }\n      return world.SUCCESS;\n    },\n\n    sell:function(options) {\n      if (this.testSell && !this.testSell(options)) return false\n      if (!this.canBeSoldHere(options.char.loc)) {\n        return failedmsg(lang.cannot_sell_here, options);\n      }\n      const cost = this.getSellingPrice(options.char);\n      options.money = cost\n      options.char.money += cost;\n      msg(this.msgSell, options);\n      if (this.doNotClone) {\n        this.salesLoc = options.char.loc\n        delete this.loc\n      }\n      else {\n        delete w[this.name]\n      }\n      if (this.afterSell) this.afterSell(options)\n      return world.SUCCESS;\n    },\n  }\n  if (!Array.isArray(locs)) {\n    res.doNotClone = true;\n    res.salesLoc = locs;\n  }\n  else {\n    res.salesLocs = locs;\n  }\n  return res;\n}\n\n// countableLocs should be a dictionary, with the room name as the key, and the number there as the value\nexport const COUNTABLE = function(countableLocs) {\n  const res = Object.assign({}, TAKEABLE_DICTIONARY)\n  res.countable = true\n  res.countableLocs = countableLocs ? countableLocs : {}\n  res.multiLoc = true\n  res.defaultToAll = true\n\n  res.isUltimatelyHeldBy = function(obj) {\n    const locs = []\n    for (const key in this.countableLocs) {\n      if (this.countableLocs[key]) locs.push(key)\n    }\n    return util.multiIsUltimatelyHeldBy(obj, locs)\n  }\n\n  res.extractNumber = function() {\n    const md = /^(\\d+)/.exec(this.cmdMatch)\n    if (!md) { return false;}\n    return parseInt(md[1])\n  }\n\n  res.beforeSaveForTemplate = function() {\n    const l = []\n    for (let key in this.countableLocs) {\n      l.push(key + \"=\" + this.countableLocs[key])\n    }\n    this.customSaveCountableLocs = l.join(\",\")\n    this.beforeSave()\n  }\n\n  res.afterLoadForTemplate = function() {\n    const l = this.customSaveCountableLocs.split(\",\")\n    this.countableLocs = {}\n    for (let el of l) {\n      const parts = el.split(\"=\")\n      this.countableLocs[parts[0]] = parseInt(parts[1])\n    }\n    this.customSaveCountableLocs = false\n    this.afterLoad()\n  };\n\n  res.getListAlias = function(loc) {\n    return sentenceCase(this.pluralAlias) + \" (\" + this.countAtLoc(loc) + \")\";\n  };\n\n  res.isLocatedAt = function(loc, situation) {\n    if (!this.countableLocs[loc]) { return false; }\n    return (this.countableLocs[loc] > 0 || this.countableLocs[loc] === 'infinity');\n  };\n\n  res.countAtLoc = function(loc) {\n    if (typeof loc !== 'string') loc = loc.name\n    if (!this.countableLocs[loc]) { return 0; }\n    return this.countableLocs[loc];\n  };\n\n  res.moveToFrom = function(options, toLoc, fromLoc) {\n    util.setToFrom(options, toLoc, fromLoc)\n    let count = options.count ? options.count : this.extractNumber()\n    if (!count) count = options.fromLoc === player().name ? 1 : this.countAtLoc(options.fromLoc)\n    if (count === 'infinity') count = 1\n    this.takeFrom(options.fromLoc, count)\n    this.giveTo(options.toLoc, count)\n  };\n\n  res.takeFrom = function(loc, count) {\n    if (this.countableLocs[loc] !== 'infinity') this.countableLocs[loc] -= count\n    if (this.countableLocs[loc] <= 0) this.countableLocs[loc] = false\n    w[loc].afterDropIn(player(), {item:this, count:count})\n  };\n\n  res.giveTo = function(loc, count) {\n    if (!this.countableLocs[loc]) { this.countableLocs[loc] = 0; }\n    if (this.countableLocs[loc] !== 'infinity') this.countableLocs[loc] += count;\n    w[loc].afterDropIn(player(), {item:this, count:count});\n  };\n\n  res.findSource = function(sourceLoc, tryContainers) {\n    // some at the specific location, so use them\n    if (this.isAtLoc(sourceLoc)) {\n      return sourceLoc;\n    }\n\n    if (tryContainers) {\n      const containers = scopeReachable().filter(el => el.container);\n      for (let container of containers) {\n        if (container.closed) continue;\n        if (this.isAtLoc(container.name)) return container.name;\n      }\n    }\n\n    return false;\n  }\n\n\n  res.getTakeDropCount = function(options, loc) {\n    options.excess = false // do this here to ensure it is resrt\n    let n = this.extractNumber()\n    let m = this.countAtLoc(loc)\n    if (!n) {  // no number specified\n      if (m === 'infinity') {\n        n = 1\n      }\n      else if (this.defaultToAll) {\n        n = m\n      }\n      else {\n        n = 1\n      }\n    }\n    if (n > m) {  // too big number specified\n      n = m\n      options.excess = true\n    }\n    options.count = n\n  }\n\n  // As this is flagged as multiLoc, need to take special care about where the thing is\n  res.take = function(options) {\n    const sourceLoc = this.findSource(options.char.loc, true);\n    if (!sourceLoc) return falsemsg(lang.none_here, options)\n    this.getTakeDropCount(options, sourceLoc)\n\n    if (this.testTake && !this.testTake(options)) return false\n    if (w[sourceLoc].testTakeOut && !w[sourceLoc].testTakeOut(options)) return false\n\n    msg(this.msgTake, options)\n    this.takeFrom(sourceLoc, options.count)\n    this.giveTo(options.char.name, options.count)\n    if (this.scenery) this.scenery = false\n    return true\n  }\n\n  res.drop = function(options) {\n    if (this.countAtLoc(options.char.name) === 0) return falsemsg(lang.none_held, options)\n    const dest = w[options.char.loc]\n    options.destination = dest\n    this.getTakeDropCount(options, options.char.name)\n\n    if (this.testDrop && !this.testDrop(options)) return false\n    if (dest.testDropIn && !dest.testDropIn(options)) return false\n\n    msg(this.msgDrop, options);\n    this.takeFrom(options.char.name, options.count);\n    this.giveTo(options.char.loc, options.count);\n    return true;\n  };\n\n  res.afterCreation = function(o) {\n    if (!o.regex) o.regex = new RegExp(\"^(\\\\d+ )?\" + o.name + \"s?$\")\n  }\n\n\n  return res;\n};\n\nexport const WEARABLE = function(wear_layer, slots) {\n  const res = Object.assign({}, TAKEABLE_DICTIONARY)\n  res.wearable = true\n  res.armour = 0\n  res.wear_layer = wear_layer ? wear_layer : false\n  res.slots = slots && wear_layer ? slots: []\n  res.worn = false\n  res.useDefaultsTo = function(char) {\n    return char === player() ? 'Wear' : 'NpcWear'\n  }\n\n  res.getSlots = function() { return this.slots }\n  res.getWorn = function() { return this.worn }\n  res.getArmour = function() { return this.armour }\n  res.msgWear = lang.wear_successful\n  res.msgRemove = lang.remove_successful\n\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      if (!o.isAtLoc(player().name)) {\n        verbList.push(lang.verbs.take)\n      }\n      else if (o.getWorn()) {\n        if (!o.getWearRemoveBlocker(player(), false)) verbList.push(lang.verbs.remove)\n      }\n      else {\n        verbList.push(lang.verbs.drop)\n        if (!o.getWearRemoveBlocker(player(), true)) verbList.push(lang.verbs.wear)\n      }\n    })\n\n    o.nameModifierFunctions.push(function(o, list) {\n      if (o.worn && o.isAtLoc(player().name)) list.push(lang.invModifiers.worn)\n    })\n  }\n\n  res.icon = () => 'garment12'\n\n  res.getWearRemoveBlocker = function(char, toWear) {\n    if (!this.wear_layer) return false\n    const slots = this.getSlots()\n    for (let slot of slots) {\n      let outer = char.getOuterWearable(slot)\n      if (outer && outer !== this && (outer.wear_layer >= this.wear_layer || outer.wear_layer === 0)) {\n        return outer\n      }\n    }\n    return false\n  }\n\n  res.testWear = function() { return true }\n  res.testRemove = function() { return true }\n\n  res._canWearRemove = function(toWear, options) {\n    if (toWear) {\n      if (!this.testWear(options)) return false\n    }\n    else {\n      if (!this.testRemove(options)) return false\n    }\n    const outer = this.getWearRemoveBlocker(options.char, toWear)\n    if (outer) {\n      options.outer = outer\n      return falsemsg(toWear ? lang.cannot_wear_over : lang.cannot_remove_under, options)\n    }\n    return true;\n  };\n\n  // Assumes the item is already held\n  res.wear = function(options) {\n    if (!this._canWearRemove(true, options)) return false\n    if (!options.char.testManipulate(this, \"wear\")) return false\n    msg(this.msgWear, options)\n    this.worn = true\n    if (this.afterWear) this.afterWear(options)\n    return true\n  };\n\n  // Assumes the item is already held\n  res.remove = function(options) {\n    if (!this._canWearRemove(false, options)) return false\n    if (!options.char.testManipulate(this, \"remove\")) return false\n    msg(this.msgRemove, options);\n    this.worn = false;\n    if (this.afterRemove) this.afterRemove(options);\n    return true;\n  };\n\n\n  return res;\n};\n\nexport const OPENABLE_DICTIONARY = {\n  msgClose:lang.close_successful,\n  msgOpen:lang.open_successful,\n  msgLock:lang.lock_successful,\n  msgUnlock:lang.unlock_successful,\n  msgCloseAndLock:lang.close_and_lock_successful,\n  openMsg:function(options) { msg(this.msgOpen, options) },\n  open:function(options) {\n    options.container = this\n    if (!this.openable) {\n      msg(lang.cannot_open, {item:this});\n      return false;\n    }\n    else if (!this.closed) {\n      msg(lang.already, {item:this});\n      return false;\n    }\n    else if (this.testOpen && !this.testOpen(options)) {\n      return false\n    }\n    if (this.locked) {\n      if (this.testKeys(options.char)) {\n        this.locked = false\n        this.closed = false\n        msg(this.msgUnlock, options)\n        this.openMsg(options)\n        return true\n      }\n      else {\n        msg(lang.locked, options)\n        return false;\n      }\n    }\n    this.closed = false;\n    this.openMsg(options)\n    if (this.afterOpen) this.afterOpen(options)\n    return true;\n  },\n\n  close:function(options) {\n    options.container = this\n    if (!this.openable) {\n      msg(lang.cannot_close, {item:this});\n      return false;\n    }\n    else if (this.closed) {\n      msg(lang.already, {item:this});\n      return false;\n    }\n    else if (this.testClose && !this.testClose(options)) {\n      return false\n    }\n    this.closed = true;\n    msg(this.msgClose, options)\n    if (this.afterClose) this.afterClose(options)\n    return true;\n  },\n\n\n}\n\nexport const CONTAINER = function(openable) {\n  const res = Object.assign({}, OPENABLE_DICTIONARY);\n  res.container = true\n\n  res.closed = openable;\n  res.openable = openable\n  res.contentsType = \"container\"\n  res.getContents = util.getContents\n  res.testForRecursion = util.testForRecursion\n  res.listContents = util.listContents\n  res.transparent = false\n\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      if (o.openable) {\n        verbList.push(o.closed ? lang.verbs.open : lang.verbs.close);\n      }\n    })\n    o.nameModifierFunctions.push(util.nameModifierFunctionForContainer)\n  };\n\n  res.lookinside = function(options) {\n    options.container = this\n    if (this.closed && !this.transparent) {\n      msg(lang.not_open, options);\n      return false;\n    }\n    options.list = this.listContents(world.LOOK, true)\n    msg(lang.look_inside, options);\n    return true;\n  };\n\n  res.openMsg = function(options) {\n    options.list = this.listContents(world.LOOK)\n    msg(this.msgOpen + \" \" + (options.list === lang.list_nothing ? lang.it_is_empty : lang.look_inside_it), options)\n  };\n\n  res.icon = function() {\n    return this.closed ? 'closed12' : 'opened12'\n  };\n\n  res.canReachThroughThis = function() { return !this.closed };\n  res.canSeeThroughThis = function() { return !this.closed || this.transparent };\n\n  return res;\n};\n\nexport const SURFACE = function() {\n  const res = {}\n  res.container = true\n  res.getContents = util.getContents\n  res.testForRecursion = util.testForRecursion\n  res.listContents = util.listContents\n  res.afterCreation = function(o) { o.nameModifierFunctions.push(util.nameModifierFunctionForContainer) }\n  res.closed = false;\n  res.openable = false;\n  res.contentsType = \"surface\";\n  res.canReachThroughThis = () => true;\n  res.canSeeThroughThis = () => true;\n  return res;\n};\n\nexport const OPENABLE = function(alreadyOpen) {\n  const res = Object.assign({}, OPENABLE_DICTIONARY);\n  res.closed = !alreadyOpen;\n  res.openable = true;\n\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      verbList.push(o.closed ? lang.verbs.open : lang.verbs.close);\n    })\n    o.nameModifierFunctions.push(function(o, list) {\n      if (!o.closed) list.push(lang.invModifiers.open)\n    })\n  }\n\n  return res\n}\n\nexport const LOCKED_WITH = function(keyNames) {\n  if (typeof keyNames === \"string\") { keyNames = [keyNames]; }\n  if (keyNames === undefined) { keyNames = []; }\n    return {\n      keyNames: keyNames,\n      locked: true,\n      lockwith: function (options) {\n          this.lock(options)\n      },\n      unlockwith: function (options) {\n          this.unlock(options)\n      },\n\n      lock: function (options) {\n          options.container = this\n          if (this.locked) return falsemsg(lang.already, options)\n          if (!this.testKeys(options.char, true)) return falsemsg(lang.no_key, options)\n\n          if (!this.closed) {\n              this.closed = true\n              this.locked = true\n              msg(this.msgCloseAndLock, options)\n          } else {\n              this.locked = true\n              msg(this.msgLock, options)\n          }\n          if (this.afterLock) this.afterLock(options)\n          return true\n      },\n\n      unlock: function (options) {\n          options.container = this\n          if (!this.locked) return falsemsg(lang.already, {item: this})\n          if (options.secondItem) {\n              if (!this.keyNames.includes(options.secondItem.name)) return falsemsg(lang.cannot_unlock_with, options)\n          } else {\n              if (!this.testKeys(options.char, false)) return falsemsg(lang.no_key, options)\n          }\n          msg(this.msgUnlock, options)\n          this.locked = false\n          if (this.afterUnlock) this.afterUnlock(options)\n          return true\n      },\n\n      testKeys: function (char, toLock) {\n\n          for (let s of this.keyNames) {\n              if (!w[s]) return errormsg(\"The key name for this container, `\" + s + \"`, does not match any key in the game.\")\n              if (w[s].isAtLoc(char.name)) return true\n          }\n          return false;\n      }\n  }\n}\n\nexport const LOCKED_DOOR = function(key, loc1, loc2, name1, name2) {\n  const res = Object.assign({}, OPENABLE(false), LOCKED_WITH(key))\n  res.loc1 = loc1\n  res.loc2 = loc2\n  res.name1 = name1\n  res.name2 = name2\n  res.scenery = true\n\n  res.afterCreation = function(item) {\n    const room1 = w[item.loc1]\n    if (!room1) return errormsg(\"Bad location name '\" + item.loc1 + \"' for door \" + item.name)\n\n    const exit1 = room1.findExit(item.loc2)\n    if (!exit1) return errormsg(\"No exit to '\" + item.loc2 + \"' for door \" + item.name)\n    item.dir1 = exit1.dir\n    if (!room1[item.dir1]) return errormsg(\"Bad exit '\" + item.dir1 + \"' in location '\" + room1.name + \"' for door: \" + item.name + \" (possibly because the room is defined after the door?)\")\n\n    const room2 = w[item.loc2]\n    if (!room2) return errormsg(\"Bad location name '\" + item.loc2 + \"' for door \" + item.name)\n    const exit2 = room2.findExit(item.loc1)\n    if (!exit2) return errormsg(\"No exit to '\" + item.loc1 + \"' for door \" + item.name)\n    item.dir2 = exit2.dir\n    if (!room2[item.dir2]) return errormsg(\"Bad exit '\" + item.dir2 + \"' in location '\" + room2.name + \"' for door: \" + item.name + \" (possibly because the room is defined after the door?)\")\n\n    room1[item.dir1].use = util.useWithDoor\n    room1[item.dir1].door = item.name\n    room1[item.dir1].doorName = item.name1 || 'door to ' + lang.getName(w[item.loc2], {article:DEFINITE})\n\n    room2[item.dir2].use = util.useWithDoor\n    room2[item.dir2].door = item.name\n    room2[item.dir2].doorName = item.name2 || 'door to ' + lang.getName(w[item.loc1], {article:DEFINITE})\n  }\n\n  res.isLocatedAt = function(loc) { return (loc === this.loc1 || loc === this.loc2) }\n\n  res.icon = () => 'door12'\n\n  return res;\n}\n\nexport const KEY = function() {\n  const res = Object.assign({}, TAKEABLE_DICTIONARY)\n  res.key = true\n  res.icon = () => 'key12'\n  return res;\n}\n\nexport const READABLE = function(mustBeHeld) {\n  const res = {}\n  res.readable = true\n  res.mustBeHeld = mustBeHeld\n  res.icon = () => 'readable12'\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      if (o.loc === player().name || !o.mustBeHeld) verbList.push(lang.verbs.read)\n    })\n  }\n  return res;\n}\n\nexport const BACKSCENE = function() {\n  return {\n    scenery:true,\n    parserPriority:-15,\n    isLocatedAt:function(loc, situation) {\n      if (!w[loc].room) return false\n      const locationType = w[loc].locationType || w[loc]._region\n      if (!locationType) return false\n      if (w[loc + '_' + this.name]) return false\n      return !!regions[locationType][this.name];\n\n    },\n    examine_for_backscene:function() {\n      if (!loc()) return\n\n      const locationType = loc().locationType || loc()._region\n      const addendum = loc()['addendum_examine_' + this.name] ? ' ' + loc()['addendum_examine_' + this.name] : ''\n\n      if (typeof loc()['examine_' + this.name] === 'function') {\n        loc()['examine_' + this.name](addendum)\n      }\n      else if (typeof loc()['examine_' + this.name] === 'string') {\n        msg(loc()['examine_' + this.name] + addendum)\n      }\n      else if (loc()._region && regions[loc()._region][this.name]) {\n        msg(regions[loc()._region][this.name] + addendum)\n      }\n      else if (this.defaultExamine) {\n        msg(this.defaultExamine + addendum)\n      }\n      else {\n        msg(lang.default_scenery)\n      }\n    },\n    afterCreation:function(o) {\n      o.defaultExamine = o.examine\n      o.examine = o.examine_for_backscene\n    },\n  }\n}\n\nexport const FURNITURE = function(options) {\n  if (options === undefined) return errormsg(\"No options for FURNITURE template. Look in the stack traces below for a reference to a file you are using to create objects, and see what the line number is.\")\n  const res = {\n    testPostureOn:() => true,\n    getoff:function(options) {\n      if (!options.char.posture) {\n        options.char.msg(lang.already, options);\n        return false;\n      }\n      if (options.char.posture) {\n        options.char.msg(lang.stop_posture(options.char));  // stop_posture handles details\n        return true;\n      }\n    },\n  }\n  res.useDefaultsTo = function(char) {\n    const cmd = this.useCmd ? this.useCmd : (this.reclineon ? 'ReclineOn' : (this.siton ? 'SitOn' : 'StandOn'))\n    return char === player() ? cmd : 'Npc' + cmd\n  }\n\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      if (player().posture && player().postureFurniture === o.name) {\n        verbList.push(lang.verbs.getOff)\n        return\n      }\n      if (player().posture && player().posture !== 'standing') return\n      if (o.siton) verbList.push(lang.verbs.sitOn)\n      if (o.standon) verbList.push(lang.verbs.standOn)\n      if (o.reclineon) verbList.push(lang.verbs.reclineOn)\n    })\n  }\n\n  res.assumePosture = function(options, posture, name, adverb) {\n    options.posture = posture\n    const char = options.char\n    if (char.posture === posture && char.postureFurniture === this.name) {\n      char.msg(lang.already, {item:char})\n      return false\n    }\n    if (!this.testPostureOn({char:char, posture:posture})) return false\n    if (char.posture && char.postureFurniture !== this.name) {\n      char.msg(lang.stop_posture(char))\n      char.msg(lang[name + '_on_successful'], options)\n    }\n    else if (char.posture && this[char.posture + \"_to_\" + posture] && this.postureChangesImplemented) {\n      char.msg(this[char.posture + \"_to_\" + posture], options)\n    }\n    else {\n      char.msg(lang[name + '_on_successful'], options)\n    }\n    char.posture = posture\n    char.postureFurniture = this.name\n    char.postureAdverb = adverb === undefined ? 'on' : adverb;\n    if (this.afterPostureOn) this.afterPostureOn(options)\n    return true\n  }\n\n  if (options.sit) {\n    res.siton = function(options) {\n      return this.assumePosture(options, \"sitting\", 'sit')\n    }\n  }\n  if (options.stand) {\n    res.standon = function(options) {\n      return this.assumePosture(options, \"standing\", 'stand')\n    }\n  }\n  if (options.recline) {\n    res.reclineon = function(options) {\n      return this.assumePosture(options, \"reclining\", 'recline')\n    }\n  }\n  if (options.useCmd) {\n    res.useCmd = options.useCmd\n  }\n  res.icon = () => 'furniture12'\n  return res;\n}\n\nexport const SWITCHABLE = function(alreadyOn, nameModifier) {\n  const res = {}\n  res.switchedon = alreadyOn\n  res.nameModifier = nameModifier\n  res.msgSwitchOff = lang.switch_off_successful\n  res.msgSwitchOn = lang.switch_on_successful\n\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      if (!o.mustBeHeldToOperate || o.isAtLoc(player())) {\n        verbList.push(o.switchedon ? lang.verbs.switchoff : lang.verbs.switchon)\n      }\n    })\n    o.nameModifierFunctions.push(function(o, list) {\n      if (o.nameModifier && o.switchedon) list.push(o.nameModifier)\n    })\n  }\n\n  res.switchon = function(options) {\n    if (this.switchedon) {\n      options.char.msg(lang.already, {item:this});\n      return false;\n    }\n    if (!this.testSwitchOn(options)) return false\n    if (!options.char.getAgreement(\"SwitchOn\", {item:this, switchOn:true})) return false\n\n    if (!this.suppressMsgs) options.char.msg(this.msgSwitchOn, options);\n    this.doSwitchon(options);\n    return true;\n  };\n\n  res.doSwitchon = function(options) {\n    let lighting = game.dark;\n    this.switchedon = true;\n    world.update();\n    if (lighting !== game.dark) {\n      loc().description();\n    }\n    if (this.afterSwitchOn) this.afterSwitchOn(options)\n  };\n\n  res.testSwitchOn = () => true;\n  res.testSwitchOff = () => true;\n\n  res.switchoff = function(options) {\n    if (!this.switchedon) {\n      options.char.msg(lang.already, {item:this});\n      return false;\n    }\n    if (!this.testSwitchOff(options)) return false\n    if (!options.char.getAgreement(\"SwitchOn\", {item:this})) return false\n\n    if (!this.suppressMsgs) options.char.msg(this.msgSwitchOff, options);\n    this.doSwitchoff(options);\n    return true;\n  };\n\n  res.doSwitchoff = function(options) {\n    let lighting = game.dark;\n    this.switchedon = false;\n    world.update();\n    if (lighting !== game.dark) {\n      loc().description();\n    }\n    if (this.afterSwitchOff) this.afterSwitchOff(options)\n  };\n\n  res.icon = function() {\n    return this.switchedon ? 'turnedon12' : 'turnedoff12'\n  }\n\n  return res;\n};\n\n// Ideally Quest will check components when doing a command for the whole\n// I think?\nexport const COMPONENT = function(nameOfWhole) {\n  const res = {\n    scenery:true,\n    component:true,\n    loc:nameOfWhole,\n    takeable:true, // Set this as it has its own take attribute\n    isLocatedAt:function(loc, situation) {\n      if (situation !== world.PARSER && situation !== world.ALL) return false;\n      let cont = w[this.loc];\n      return cont.isAtLoc(loc);\n    },\n    take:function(options) {\n      options.whole = w[this.loc]\n      msg(lang.cannot_take_component, options);\n      return false;\n    },\n  };\n  if (!w[nameOfWhole]) debugmsg(\"Whole is not define: \" + nameOfWhole);\n  w[nameOfWhole].componentHolder = true;\n  return res;\n};\n\nexport const EDIBLE = function(isLiquid) {\n  const res = Object.assign({}, TAKEABLE_DICTIONARY);\n  res.isLiquid = isLiquid\n  res.msgIngest = isLiquid ? lang.drink_successful : lang.eat_successful\n  res.eat = function(options) {\n    if (this.isLiquid) {\n      msg(lang.cannot_eat, options);\n      return false;\n    }\n    msg(this.msgIngest, options);\n    this.loc = null;\n    if (this.afterIngest) this.afterIngest(options);\n    return true;\n  };\n  res.drink = function(options) {\n    if (!this.isLiquid) {\n      msg(lang.cannot_drink, options);\n      return false;\n    }\n    msg(this.msgIngest, options);\n    this.loc = null;\n    if (this.afterIngest) this.afterIngest(options);\n    return true;\n  };\n  res.ingest = function(options) {\n    if (this.isLiquid) {\n      return this.drink(options)\n    }\n    else {\n      return this.eat(options)\n    }\n  }\n  res.icon = () => 'edible12'\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      verbList.push(o.isAtLoc(player().name) ? lang.verbs.drop : lang.verbs.take)\n      if (o.isAtLoc(player())) verbList.push(o.isLiquid ? lang.verbs.drink : lang.verbs.eat)\n    })\n  }\n  return res;\n};\n\nexport const VESSEL = function() {\n  const res = {}\n  res.vessel = true\n\n  res.afterCreation = function(o) {\n    if (o.volumeContained) {\n        // todo - what is a list?\n      list.push(\"full of \" + o.containedFluidName)\n    }\n  };\n\n  res.findSource = function(options) { return util.findSource(options) };\n\n  res.fill = function(options) {\n    if (!this.findSource(options)) return falsemsg(lang.no_generic_fluid_here, {item:this})\n    return this.doFill(options)\n  };\n\n  res.doFill = function(options) {\n    options.item = this\n    if (this.testFill && !this.testFill(options)) return false\n    if (this.containedFluidName) return falsemsg(lang.already_full, options)\n\n    this.containedFluidName = options.fluid\n    if (options.source.vessel) delete options.source.containedFluidName\n\n    msg(lang.fill_successful, options)\n    if (this.afterFill) this.afterFill(options)\n    return true\n  }\n\n  res.empty = function(options) {\n    delete options.item\n    return this.doEmpty(options)\n  }\n\n  res.doEmpty = function(options) {\n    options.source = this\n    options.fluid = this.containedFluidName\n\n    if (!this.containedFluidName) return falsemsg(lang.already_empty, options)\n    if (this.testEmpty && !this.testEmpty(options)) return false\n\n    if (!options.item) {\n      msg(lang.empty_successful, options)\n      delete this.containedFluidName\n    }\n    else if (options.item === options.source) {\n      return falsemsg(lang.pour_into_self, options)\n    }\n    else if (options.item.vessel) {\n      if (options.item.containedFluidName) return falsemsg(lang.already_full, {char:options.char, item:options.sink, fluid:options.item.containedFluidName})\n      msg(lang.empty_into_successful, options)\n      options.item.containedFluidName = this.containedFluidName\n      delete this.containedFluidName\n    }\n    else if (options.item.sink) {\n      if (!options.item.sink(this.containedFluidName, options.char, this)) return false\n    }\n    else {\n      msg(lang.empty_onto_successful, options)\n      delete this.containedFluidName\n    }\n    if (this.afterEmpty) this.afterEmpty(options.char, {fluid:this.containedFluidName, sink:options.item})\n    delete this.containedFluidName\n    return true\n  }\n\n  res.handleInOutContainer = function(options, items) {\n    let success = false;\n    for (const obj of items) {\n      if (!options.char.testManipulate(obj, options.verb)) return world.FAILED\n      options.count = obj.countable ? obj.extractNumber() : undefined\n      options.item = obj\n      if (options.count) options[obj.name + '_count'] = options.count  // for the text processor\n      let flag\n      if (this.container) {\n          // todo - what is func, char and container there??:\n        success = success || func(char, container, obj, options)\n      }\n      /*else if (obj.representsFluid) {\n        flag = this.doFill({char:options.char, fluid:obj.representsFluid})\n        success = success || flag\n      }*/\n      else {\n        msg(lang.not_container_not_vessel, options)\n      }\n    }\n    if (success) options.char.pause();\n    return success ? world.SUCCESS : world.FAILED;\n  };\n\n  res.afterCreation = function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      if (!o.isAtLoc(player().name)) return\n      verbList.push(o.containedFluidName ? lang.verbs.empty : lang.verbs.fill)\n    })\n  }\n  return res;\n}\n\nexport const CONSTRUCTION = function(componentNames) {\n  const res = {}\n  res.construction = true\n  res.componentNames = componentNames ? componentNames : []\n  res.destroyComponentsOnBuild = true\n  res.msgConstruction = lang.construction_done\n\n  res.testComponents = function(components, options) {\n    for (const el of components) {\n      if (!res.componentNames.includes(el.name)) {\n        options.wrong = el\n        return falsemsg(lang.component_wrong, options)\n      }\n    }\n    return true\n  }\n\n  res.buildPrecheck = function(options) {\n    if (this.loc) return falsemsg(lang.construction_already, options)\n    for (const el of options.components) {\n      if (el.loc !== player().name) {\n        options.missing = el\n        return falsemsg(lang.component_missing, options)\n      }\n    }\n    return true\n  }\n\n  res.build = function(options) {\n    const components = this.componentNames.map(el => w[el])\n    options.components = components\n    if (!this.buildPrecheck(options)) return false\n    if (this.testConstruction && !this.testConstruction(options)) return false\n\n    if (this.destroyComponentsOnBuild) {\n      for (const el of components) delete el.loc\n    }\n    this.loc = this.buildAtLocation ? player().loc : player().name\n    options.list = formatList(components, {article:DEFINITE, lastSep:'and'})\n    msg(this.msgConstruction, options)\n    if (this.afterConstruction) this.afterConstruction(options)\n    return true\n  }\n\n  return res\n}\n\nexport const ROPE = function(length, tetheredTo) {\n  const res = Object.assign({\n    rope:true,\n    ropeLength:length,\n    tethered:(tetheredTo !== undefined),\n    tiedTo1:tetheredTo,\n    locs:tetheredTo ? [w[w[tetheredTo].loc]] : [],\n    attachVerb:lang.rope_attach_verb,\n    attachedVerb:lang.rope_attached_verb,\n    detachVerb:lang.rope_detach_verb,\n    msgDetach:lang.rope_detach_success,\n    msgAttach:lang.rope_attach_success,\n    msgWind:lang.rope_wind,\n    msgUnwind:lang.rope_unwind,\n    isLocatedAt:function(loc, situation) {\n      if (this.loc) {\n        this.locs = [this.loc]\n        this.loc = false\n      }\n      if (typeof loc !== \"string\") loc = loc.name\n      // If the rope is in the location and held by the character, only want it to appear once in the side pane\n      if (situation === world.SIDE_PANE && this.locs.includes(player().name) && loc !== player().name) return false\n      return this.locs.includes(loc)\n    },\n    isUltimatelyHeldBy:function(obj) { return util.multiIsUltimatelyHeldBy(obj, this.locs) },\n    isAttachedTo:function(item) {\n      return this.tiedTo1 === item.name || this.tiedTo2 === item.name\n    },\n    getAttached:function() {\n      let res = this.tiedTo1 ? [this.tiedTo1] : []\n      if (this.tiedTo2) res.push(this.tiedTo2)\n      return res\n    },\n    examineAddendum:function() {\n      // It is tied to the chair, and trails into the kitchen.\n\n      // What is it tied to (and we can see)\n      const obj1 = (this.tiedTo1 && w[this.tiedTo1].isHere()) ? w[this.tiedTo1] : false\n      const obj2 = (this.tiedTo2 && w[this.tiedTo2].isHere()) ? w[this.tiedTo2] : false\n\n      // Handle the easy cases, only one loc in locs\n      if (this.locs.length === 1) {\n        if (obj1 && obj2) return processText(lang.examineAddBothEnds, {item:this, obj1:obj1, obj2:obj2})\n        if (obj1) return processText(lang.rope_examine_attached_one_end, {item:this, obj1:obj1})\n        if (obj2) return processText(lang.rope_examine_attached_one_end, {item:this, obj1:obj2})\n        return ''  // just in one place, like any ordinary object\n      }\n\n      // Who is it held by (and we can see)\n      const end1 = w[this.locs[0]]\n      const holder1 = (end1.npc || end1.player) && end1.isHere() ? end1 : false\n      const end2 = w[this.locs[this.locs.length - 1]]\n      const holder2 = (end2.npc || end2.player) && end2.isHere() ? end2 : false\n\n      // What locations does it go to\n      const index = this.locs.findIndex(el => el === player().loc)\n      const loc1 = (index > 0 && w[this.locs[index - 1]].room) ? w[this.locs[index - 1]] : false\n      const loc2 = (index < (this.locs.length - 1) && w[this.locs[index + 1]].room) ? w[this.locs[index + 1]] : false\n\n      let s = ''\n      let flag = false\n      if (obj1 || holder1 || loc1) {\n        s += ' ' + lang.rope_one_end + ' '\n        flag = true\n      }\n      if (obj1) {\n        s += lang.rope_examine_end_attached.replace('obj', 'obj1')\n      }\n      else if (holder1) {\n        s += lang.rope_examine_end_held.replace('holder', 'holder1')\n      }\n      else if (loc1) {\n        s += lang.rope_examine_end_headed.replace('loc', 'loc1')\n      }\n\n      if (obj2 || holder2 || loc2) {\n        s += ' ' + (flag ? lang.rope_other_end : lang.rope_one_end) + ' '\n      }\n      if (obj2) {\n        s += lang.rope_examine_end_attached.replace('obj', 'obj2')\n      }\n      else if (holder2) {\n        s += lang.rope_examine_end_held.replace('holder', 'holder2')\n      }\n      else if (loc2) {\n        s += lang.rope_examine_end_headed.replace('loc', 'loc2')\n      }\n\n      return processText(s, {item:this, obj1:obj1, obj2:obj2, holder1:holder1, holder2:holder2, loc1:loc1, loc2:loc2})\n    },\n    canAttachTo:function(item) {\n      return item.attachable\n    },\n    handleTieTo:function(char, obj) {\n      if (obj === undefined) obj = this.findAttachable(this)\n      const options = {char:char, item:this, obj:obj}\n\n      if (obj === undefined) return falsemsg(lang.rope_no_attachable_here, options)\n      if (!obj.attachable) return failedmsg(lang.rope_not_attachable_to, options)\n\n      if (this.tiedTo1 === obj.name) return failedmsg(lang.already, {item:this})\n      if (this.tiedTo2 === obj.name) return failedmsg(lang.already, {item:this})\n      if (this.tiedTo1 && this.tiedTo) return failedmsg(lang.rope_tied_both_ends_already, {item:this, obj1:w[this.tiedTo1], obj2:w[this.tiedTo2]})\n\n      if (obj.testAttach && !obj.testAttach(options)) return world.FAILED\n      this.attachTo(char, obj)\n      if (!this.suppessMsgs) msg(this.msgAttach, options)\n      return world.SUCCESS\n    },\n    handleUntieFrom:function(char, obj) {\n      const tpParams = {char:char, item:this, obj:obj}\n      if (obj === undefined) {\n        // obj not set; can we guess it?\n        if (!this.tiedTo1 && !this.tiedTo2) return failedmsg(lang.rope_not_attached, tpParams)\n        if (this.tiedTo1 && !this.tiedTo2) {\n          obj = w[this.tiedTo1]\n        }\n        else if (!this.tiedTo1 && this.tiedTo2) {\n          obj = w[this.tiedTo2]\n        }\n        else if (w[this.tiedTo1].isHere() && !w[this.tiedTo2].isHere()) {\n          obj = w[this.tiedTo1]\n        }\n        else if (!w[this.tiedTo1].isHere() && w[this.tiedTo2].isHere()) {\n          obj = w[this.tiedTo2]\n        }\n        else {\n          return failedmsg(lang.rope_detach_end_ambig, tpParams)\n        }\n        tpParams.obj = obj\n      }\n      else {\n        if (this.tiedTo1 !== obj.name && this.tiedTo2 !== obj.name) {\n          return failedmsg(lang.rope_not_attached_to, tpParams)\n        }\n      }\n      if (obj === this.tiedTo1 && this.tethered) return failedmsg(lang.rope_tethered, tpParams)\n\n      this.detachFrom(char, obj)\n      if (!this.suppessMsgs) msg(this.msgDetach, tpParams)\n      return world.SUCCESS\n    },\n    useWith:function(char, item) {\n      return this.handleTieTo(char, item) === world.SUCCESS\n    },\n    attachTo:function(char, item) {\n      const loc = item.loc // may want to go deep in case tied to a component of an item !!!\n      if (!this.tiedTo1) {\n        if (this.locs.length > 1) this.locs.shift()\n        if (this.locs[0] !== loc) this.locs.unshift(loc)\n        this.tiedTo1 = item.name\n      }\n      else {\n        if (this.locs.length > 1) this.locs.pop()\n        if (this.locs[this.locs.length - 1] !== loc) this.locs.push(loc)\n        this.tiedTo2 = item.name\n      }\n      if (this.afterAttach) this.afterAttach(char, {item:item})\n    },\n    detachFrom:function(char, item) {\n      if (this.tiedTo1 === item.name) {\n        if (this.locs.length === 2 && this.locs.includes(char.name)) this.locs.shift() // remove this room\n        if (this.locs[0] !== char.name) {\n          this.locs.unshift(char.name)\n        }\n        this.tiedTo1 = false\n      }\n      else {\n        if (this.locs.length === 2 && this.locs.includes(char.name)) this.locs.pop() // remove this room\n        if (this.locs[this.locs.length - 1] !== char.name) this.locs.push(char.name)\n        this.tiedTo2 = false\n      }\n      if (this.afterDetach) this.afterDetach(char, {item:item})\n    },\n    findAttachable:function() {\n      // Is there some other source?\n      const items = scopeReachable()\n      for (let obj of items) {\n        if (obj.attachable) return obj\n      }\n      return undefined\n    },\n  }, TAKEABLE_DICTIONARY)\n\n  res.moveToFrom = function() {\n    errormsg(\"You cannot use \\\"moveToFrom\\\" with a ROPE object, due to the complicated nature of these things. You should either prevent the user trying to do this, or look to implement some custom code as the ROPE template does for DROP and TAKE. Sorry I cannot be any more help than that!\")\n  }\n\n  res.drop = function(options) {\n    const char = options.char\n    if (!this.isAtLoc(char.name)) return falsemsg(lang.not_carrying, options)\n\n    let end\n    if (this.locs.length === 1) {\n      // Rope is in one place so move as a single item\n      this.locs = [char.loc]\n      end = 0\n    }\n    else if (this.locs[0] === char.name) {\n      // end 1 is here and not attached, so get that\n      this.locs.shift()\n      end = 1\n    }\n    else if (this.locs[this.locs.length - 1] === char.name) {\n      // end 2 is here and not attached, so get that\n      this.locs.pop()\n      end = 2\n    }\n    options.end = end\n    options.toLoc = char.loc\n    options.fromLoc = char.name\n\n    msg(this.msgDrop, options)\n    if (w[char.loc].afterDropIn) w[char.loc].afterDropIn(options);\n    if (w[char.name].afterTakeFrom) w[char.name].afterTakeFrom(options);\n    if (this.afterMove !== undefined) this.afterMove(options)\n    return true;\n  }\n\n  res.take = function(options) {\n    const char = options.char\n    if (this.isAtLoc(char.name) && !this.isAtLoc(options.char.loc)) return falsemsg(lang.already_have, options)\n    if (!char.testManipulate(this, \"take\")) return false;\n    if (this.tiedTo1 && this.tiedTo2) return falsemsg(lang.rope_tied_both_end, options)\n\n    let end\n    if (this.locs.length === 1 && !this.tiedTo1 && !this.tiedTo2) {\n      // Rope is in one place, not tied to anything, so move as a single item\n      this.locs = [char.name]\n      end = 0\n    }\n    else if (this.locs[0] === char.loc && !this.tiedTo1) {\n      // end 1 is here and not attached, so get that\n      this.locs.unshift(char.name)\n      end = 1\n    }\n    else if (this.locs[this.locs.length - 1] === char.loc && !this.tiedTo2) {\n      // end 2 is here and not attached, so get that\n      this.locs.push(char.name)\n      end = 2\n    }\n    else if (this.locs[0] === char.loc || this.locs[this.locs.length - 1] === char.loc) {\n      // an end is here - presumably tied to something\n      return falsemsg(lang.rope_tied_one_end, options)\n    }\n    else {\n      return falsemsg(lang.rope_no_end, options)\n    }\n    options.end = end\n    options.toLoc = char.name\n    options.fromLoc = char.loc\n\n    msg(this.msgTake, options)\n    if (w[char.loc].afterTakeOut) w[char.loc].afterTakeOut(options)\n    if (w[char.name].afterDropIn) w[char.name].afterDropIn(options)\n    if (this.afterMove !== undefined) this.afterMove(options)\n    if (this.afterTake !== undefined) this.afterTake(options)\n    if (this.scenery) this.scenery = false\n    return true;\n  }\n\n  res.testCarry = function(options) {\n    if (this.ropeLength === undefined) return true // length not set, infinitely long!\n    if (this.locs.length < 3) return true // just in one room\n    if (!this.locs.includes(options.char.name)) return true // not carrying, so no issue\n    if (this.locs[0] === options.char.name) {\n      if (this.locs[2] === options.exit.name) return true // heading back where we came from\n    }\n    else {\n      if (this.locs[this.locs.length - 3] === options.exit.name) return true // heading back where we came from\n    }\n    if (this.locs.length <= this.ropeLength) return true\n    msg(lang.rope_cannot_move, options)\n    return false\n  }\n  res.afterCarry = function(options) {\n    const char = options.char\n    if (this.locs.length === 1) return // carried as single item, treat as std item\n    if (!this.locs.includes(char.name)) return // not carrying, so no issue\n    if (this.locs[0] === char.name) {\n      // suppose locs is me, lounge, kitchen, garden\n      // case 1: move lounge to kitchen -> me, kitchen, garden\n      // case 2: move lounge to hall -> me, hall, lounge, kitchen, garden\n      this.locs.shift()  // remove me\n      if (this.locs[1] === char.loc) {\n        this.locs.shift()\n        char.msg(this.msgWind, {char:char, item:this})\n      }\n      else {\n        this.locs.unshift(char.loc)\n        char.msg(this.msgUnwind, {char:char, item:this})\n      }\n      this.locs.unshift(char.name)\n    }\n    else {\n      this.locs.pop()  // remove me\n      if (this.locs[this.locs.length - 2] === char.loc) {\n        this.locs.pop()\n        char.msg(this.msgWind, {char:char, item:this})\n      }\n      else {\n        this.locs.push(char.loc)\n        char.msg(this.msgUnwind, {char:char, item:this})\n      }\n      this.locs.push(char.name)\n    }\n  }\n  return res\n}\n\nexport const BUTTON_DICTIONARY = {\n  button:true,\n  msgPress:lang.press_button_successful,\n\n  afterCreation:function(o) {\n    o.verbFunctions.push(function(o, verbList) {\n      verbList.push(lang.verbs.push)\n    })\n  },\n}\n\nexport const BUTTON = function() {\n  const res = Object.assign({}, BUTTON_DICTIONARY)\n\n  res.push = function(options) {\n    msg(this.msgPress, options)\n    if (this.afterPress) this.afterPress(options)\n  }\n\n  return res\n}\n\nexport const TRANSIT_BUTTON = function(nameOfTransit, transitDest) {\n  const res = Object.assign({}, BUTTON_DICTIONARY)\n  res.loc = nameOfTransit;\n  res.transitDest = transitDest\n  res.transitButton = true;\n  res.transitAlreadyHere = lang.transit_already_here\n  res.transitGoToDest = lang.transit_go_to_dest\n\n  res.push = function(options) {\n    const transit = w[this.loc];\n    const exit = transit[transit.transitDoorDir]\n\n    if (this.testTransitButton && !this.testTransitButton(options.char, {multiple:options.multiple, transit:transit})) return false\n    if (transit.testTransit && !transit.testTransit(options.char, {multiple:options.multiple, button:this})) return false\n    if (this.locked) return falsemsg(this.transitLocked)\n    if (exit.name === this.transitDest) return falsemsg(this.transitAlreadyHere)\n\n    if (transit.transitAutoMove) {\n      player().moveChar(transit[transit.transitDoorDir])  //player.previousLoc,\n    }\n    else {\n      printOrRun(player(), this, \"transitGoToDest\")\n      transit.transitUpdate(this, true)\n    }\n    return true\n  }\n\n  return res;\n};\n\n// This is for rooms\nexport const ROOM_SET = function(setName) {\n  return { roomSet:setName }\n}\n\n// This is for rooms\nexport const EXIT_FAKER = function() {\n  const res = {}\n\n  res.exit_attributes = ['msg', 'npcLeaveMsg', 'npcEnterMsg']\n\n  res.getExit = function(dir) {\n    if (this['exit_' + dir] === undefined) return undefined\n    const params = {origin:this, dir:dir}\n    if (this['exit_func_' + dir]) params.simpleUse = this[this['exit_func_' + dir]]\n    for (const att of this.exit_attributes) {\n      if (this['exit_' + att + '_' + dir]) params[att] = this['exit_' + att + '_' + dir]\n    }\n    return new Exit(this['exit_' + dir], params)\n  }\n\n  res.hasExit = function(dir, options) {\n    if (options === undefined) options = {}\n    if (!this['exit_' + dir]) return false\n    if (options.excludeLocked && this.isExitLocked(dir)) return false\n\n    if (options.excludeScenery && this['exit_scenery_' + dir]) return false\n    if (game.dark && !this['exit_illuminated_' + dir]) return false\n    return !this.isExitHidden(dir)\n  }\n\n  return res\n}\n\n// This is for rooms\nexport const TRANSIT = function(exitDir) {\n    return {\n      saveExitDests: true,\n      transitDoorDir: exitDir,\n      mapMoveableLoc: true,\n      mapRedrawEveryTurn: true,\n\n      beforeEnter: function () {\n          const transitButton = this.findTransitButton(player().previousLoc)\n          if (transitButton) this.transitUpdate(transitButton)\n      },\n\n      getTransitButtons: function (includeHidden, includeLocked) {\n          return this.getContents(world.LOOK).filter(function (el) {\n              if (!el.transitButton) return false;\n              if (!includeHidden && el.hidden) return false;\n              return !(!includeLocked && el.locked);\n\n          })\n      },\n\n      findTransitButton: function (dest) {\n          for (let key in w) {\n              if (w[key].loc === this.name && w[key].transitDest === dest) return w[key]\n          }\n          return null\n      },\n\n      setTransitDest: function (transitButton) {\n          if (typeof transitButton === 'string') {\n              transitButton = this.findTransitButton(transitButton)\n          }\n          if (!transitButton) return errormsg(\"Trying to set a transit to an unfathomable destination.\")\n\n          this[this.transitDoorDir].name = transitButton.transitDest\n          this.currentButtonName = transitButton.name\n          this.transitCurrentLocation = transitButton.transitDest\n      },\n\n      getTransitDestLocation: function () {\n          return w[this[this.transitDoorDir].name]\n      },\n      getTransitDestButton: function () {\n          return w[this.currentButtonName]\n      },\n\n      transitUpdate: function (transitButton, callEvent) {\n          if (!this[this.transitDoorDir]) return errormsg(\"The transit \\\"\" + this.name + \"\\\" is set to use \\\"\" + this.transitDoorDir + \"\\\" as the exit, but has no such exit.\")\n          const previousDest = this[this.transitDoorDir].name\n          this.setTransitDest(transitButton)\n          if (typeof map !== 'undefined' && map.transitUpdate) map.transitUpdate(this, transitButton, callEvent)\n          if (callEvent && this.afterTransitMove) this.afterTransitMove(transitButton.transitDest, previousDest)\n      },\n\n      // The exit is not saved, so after a load, need to update the exit\n      afterLoadForTemplate: function () {\n          if (this.currentButtonName) this.setTransitDest(w[this.currentButtonName])\n          if (this.afterLoad) this.afterLoad()\n      },\n\n      isTransitHere: function (char = player()) {\n          log(this[this.transitDoorDir].name)\n          log(char.loc)\n          return this[this.transitDoorDir].name === char.loc\n      },\n\n\n      transitOfferMenu: function () {\n          if (this.testTransit && !this.testTransit(player())) {\n              if (this.transitAutoMove) player().moveChar(this[this.transitDoorDir])  // player.previousLoc,\n              return false\n          }\n          const buttons = this.getTransitButtons(true, false);\n          const transitDoorDir = this.transitDoorDir;\n          const room = this;\n          showMenu(this.transitMenuPrompt, buttons.map(el => el.transitDestAlias), function (result) {\n              for (let button of buttons) {\n                  if (buttons[i].transitDestAlias === result) {\n                      buttons[i].push(false, player())\n                  }\n              }\n          })\n      },\n  };\n}\n\nexport const CHARACTER = function() {\n    return {\n      // The following are used also both player and NPCs, so we can use the same functions for both\n      canReachThroughThis: () => true,\n      canSeeThroughThis: () => true,\n      getContents: util.getContents,\n      pause: NULL_FUNC,\n      testManipulate: () => true,\n      testMove: () => true,\n      testPosture: () => true,\n      testTakeDrop: () => true,\n      mentionedTopics: [],\n      testTalkFlag: true,\n      testTalk: function () {\n          return this.testTalkFlag\n      },\n      afterCarryList: [],\n      followers: [],\n      money: 0,\n\n      getAgreement: function (cmdType, options) {\n          if (this['getAgreement' + cmdType]) return this['getAgreement' + cmdType](options)\n          if (this.getAgreementDefault) return this.getAgreementDefault()\n          return true\n      },\n\n      getHolding: function () {\n          return this.getContents(world.LOOK).filter(function (el) {\n              return !el.getWorn();\n          });\n      },\n\n      getWearing: function () {\n          return this.getContents(world.LOOK).filter(function (el) {\n              return el.getWorn() && !el.ensemble;\n          });\n      },\n\n      getCarrying: function () {\n          const res = []\n          for (const key in w) {\n              if (w[key].isUltimatelyHeldBy && w[key].isUltimatelyHeldBy(this)) res.push(w[key])\n          }\n          return res\n      },\n\n      getStatusDesc: function () {\n          if (!this.posture) return false;\n          return this.posture + \" \" + this.postureAdverb + \" \" + lang.getName(w[this.postureFurniture], {article: DEFINITE});\n      },\n\n      handleGiveTo: function (options) {\n          if (!options.item.isAtLoc(options.char.name)) return falsemsg(lang.not_carrying, options)\n          if (!options.char.getAgreement(\"Give\", options)) return false\n          if (!options.char.testManipulate(options.item, \"give\")) return false\n\n          options.extraTest = function (options, response) {\n              if (!response.item) return true\n              const item = typeof response.item === 'string' ? w[response.item] : response.item\n              return item === options.item\n          }\n          return respond(options, this.receiveItems)\n      },\n\n      getOuterWearable: function (slot) {\n          const clothing = this.getWearing().filter(function (el) {\n              if (typeof el.getSlots !== \"function\") {\n                  console.log(\"Item with worn set to true, but no getSlots function\");\n                  console.log(el);\n              }\n              return el.getSlots().includes(slot);\n          });\n\n          if (clothing.length === 0) {\n              return false;\n          }\n          let outer = clothing[0];\n          for (let garment of clothing) {\n              if (garment.wear_layer > outer.wear_layer) {\n                  outer = garment;\n              }\n          }\n          return outer;\n      },\n\n      // Also used by NPCs, so has to allow for that\n      msg: function (s, params) {\n          msg(s, params);\n      },\n\n      afterCreation: function (o) {\n          o.nameModifierFunctions.push(function (o, l) {\n              let s = ''\n              const state = o.getStatusDesc();\n              const held = o.getHolding();\n              const worn = o.getWearingVisible();\n\n              const list = [];\n              if (state) {\n                  list.push(state);\n              }\n              if (held.length > 0) {\n                  list.push(lang.invHoldingPrefix + ' ' + formatList(held, {\n                      article: INDEFINITE,\n                      lastSep: lang.list_and,\n                      modified: false,\n                      nothing: lang.list_nothing,\n                      loc: o.name,\n                      npc: true\n                  }));\n              }\n              if (worn.length > 0) {\n                  list.push(lang.invWearingPrefix + ' ' + formatList(worn, {\n                      article: INDEFINITE,\n                      lastSep: lang.list_and,\n                      modified: false,\n                      nothing: lang.list_nothing,\n                      loc: o.name,\n                      npc: true\n                  }));\n              }\n              if (list.length > 0) l.push(list.join('; '))\n          })\n          o.verbFunctions.push(function (o, verbList) {\n              verbList.shift()\n              verbList.push(lang.verbs.lookat)\n              if (!settings.noTalkTo) verbList.push(lang.verbs.talkto)\n          })\n      },\n\n      // Use this to move the character. Describing it should be done elsewhere\n      moveChar: function (exit) {\n          if (!(exit instanceof Exit)) return errormsg(\"Using moveChar for \" + this.name + \" but no exit sent.\")\n          const room = util.getObj(exit.name)\n          this.previousLoc = this.loc\n\n          if (this.player) {\n              if (settings.clearScreenOnRoomEnter) clearScreen();\n              loc().afterExit(exit)\n              this.loc = room.name\n              world.update()\n              world.enterRoom(exit)\n          } else {\n              this.loc = room.name\n              this.handleMovingFollowers(exit)\n          }\n\n          if (this.afterMove) this.afterMove(exit)\n          for (const el of this.getCarrying()) {\n              if (el.afterCarry) el.afterCarry({char: this, item: el, exit: exit})\n          }\n      },\n\n      // Use when the NPC changes rooms; will give a message if the player can observe it\n      movingMsg: function (exit) {\n          if (this.player) {\n              if (exit.msg) {\n                  printOrRun(this, exit, \"msg\")\n              } else if (lang.go_successful) {\n                  msg(lang.go_successful, {char: this, dir: exit.dir})\n              }\n          } else {\n              if (exit.msgNPC) {\n                  exit.msgNPC(this)\n              } else {\n                  lang.npc_leaving_msg(this, exit)\n                  lang.npc_entering_msg(this, exit)\n              }\n          }\n      },\n\n      handleMovingFollowers: function (exit) {\n          for (let s of this.followers) {\n              const follower = w[s]\n              if (follower.loc === this.loc) continue\n              if (!follower.testFollowTo || follower.testFollowTo(w[exit.name])) {\n                  if (this.player) follower.movingMsg(exit, true)\n                  follower.moveChar(exit)\n              }\n          }\n      }\n  }\n}\n\nexport const PLAYER = function() {\n  const res = CHARACTER()\n  res.pronouns = lang.pronouns.secondperson\n  res.player = true\n\n  res.receiveItems = [\n    {\n      test:function() { return true },\n      f:function(options) {\n        msg(lang.done_msg, options)\n        util.giveItem(options)\n        return true\n      }\n    },\n  ]\n\n  return res;\n}\n","// noinspection JSUnusedGlobalSymbols\n\n\"use strict\";\n\n// This is where the world exist!\n\nimport {\n    DEFAULT_ITEM, DEFAULT_OBJECT, DEFAULT_ROOM,\n    endTurnUI, errormsg, msg, warningFor, initCommands,\n    lang, test, util, saveLoad, settings, TOPIC\n} from \"../index.js\";\n\nexport const w = {};\n\n//@DOC\n// ## World Functions\n//\n// These are functions for creating objects in the game world\n//@UNDOC\n\n//@DOC\n// Use this to create a new item (as opposed to a room).\n// It adds various defaults that apply only to items.\n// The first argument should be a string - a unique name for this object, composed only of letters, numbers and underscores.\n// It will than take any number of dictionaries that will be combined to set the properties.\n// Generally objects should not be created during play as they will not be saved properly.\n// Either keep the object hodden until required or clone existing objects.\nexport function createItem() {\n  const args = Array.prototype.slice.call(arguments)\n  const o = createItemOrRoom(args, DEFAULT_ITEM, settings.itemCreateFunc)\n\n  // Create topics from convTopics\n  if (o.convTopics) {\n    o.convTopics.forEach(function (value, i) {\n      value.loc = o.name\n      createItem(value.name ? value.name : o.name + '_convTopic_' + i, TOPIC(), value)\n    })\n    delete o.convTopics\n  }\n  return o\n}\n\n//@DOC\n// Use this to create a new room (as opposed to an item).\n// It adds various defaults that apply only to items\n// The first argument should be a string - a unique name for this object, composed only of letters, numbers and underscores.\n// It will than take any number of dictionaries that will be combined to set the properties.\n// Generally objects should not be created during play as they will not be saved properly.\n// Either keep the object hodden until required or clone existing objects.\nexport function createRoom() {\n  const args = Array.prototype.slice.call(arguments)\n  const o = createItemOrRoom(args, DEFAULT_ROOM, settings.roomCreateFunc)\n  o._region = region\n  if (o.scenery) {\n    for (const x of o.scenery) {\n      const el = typeof x === 'string' ? {alias:x} : x\n      const alias = Array.isArray(el.alias) ? el.alias.shift() : el.alias\n      const aliases = Array.isArray(el.alias) ? el.alias : []\n      if (!alias) throw \"ERROR: Scenery item is missing an alias in room: \" + o.name\n      const obj = createItem(o.name + '_scenery_' + alias.replace(/\\W/g, ''), {\n        loc:o.name,\n        alias:alias,\n        synonyms:aliases,\n        scenery:true,\n        examine:el.examine ? el.examine : lang.default_description,\n      })\n      delete el.alias\n      delete el.examine\n      for (const key in el) obj[key] = el[key]\n    }\n    delete o.scenery\n  }\n  return o\n}\n\nexport function createItemOrRoom(args, defaults, createFunc) {\n  const name = args.shift()\n  args.unshift(defaults)\n  const o = createObject(name, args)\n  if (createFunc) createFunc(o)\n  return o\n}\n\n//@DOC\n// Use this to create new items during play. The given item will be cloned at the given location.\n// The `newName` is optional, one will be generated if not supplied. If you do supply one bear inmid that\n// every clone must have a unique name.\nexport function cloneObject(item, loc, newName) {\n  if (item === undefined) { return errormsg(\"Item is not defined.\") }\n  if (typeof item === 'string') {\n    const o = w[item]\n    if (o === undefined) { return errormsg(\"No item called '\" + item + \"' found in cloneObject.\") }\n    item = o\n  }\n  if (!newName) newName = item.name\n  const clone = {};\n  for (let key in item) clone[key] = item[key]\n  clone.name = util.findUniqueName(newName)\n  if (!clone.clonePrototype) {\n    clone.clonePrototype = item\n  }\n  if (loc !== undefined) {\n    clone.loc = loc;\n  }\n\n  clone.getSaveStringPreamble = function(item) {\n    return \"Clone:\" + this.clonePrototype.name + \"=\"\n  }\n\n  w[clone.name] = clone\n  return clone\n}\n\n//@DOC\n// Use this to create new items before play. The given item will be cloned at the given location.\n// The `newName` is optional, one will be generated if not supplied. If you do supply one bear in mind that\n// every copy must have a unique name.\nexport function copyObject(item, loc, newName) {\n  if (world.isCreated) { return errormsg(\"Attempting to copy item after the game has started\") }\n  if (item === undefined) { return errormsg(\"Item is not defined.\") }\n  if (typeof item === 'string') {\n    const o = w[item]\n    if (o === undefined) { return errormsg(\"No item called '\" + item + \"' found in copyObject.\") }\n    item = o\n  }\n  if (!newName) newName = item.name\n\n\n  const copy = {...item,\n    verbFunctions:[world.defaultVerbFunction],\n    initialiserFunctions:[...item.initialiserFunctions],\n  };\n  copy.name = util.findUniqueName(newName)\n  if (loc !== undefined) {\n    copy.loc = loc;\n  }\n\n  w[copy.name] = copy\n  return copy\n}\n\n//@DOC\n// Creates a basic object. Generally it is better to use CreateItem or CreateRoom.\n// List of hashes will contain the hash that is common to everything, then the hash that is common to rooms or item, then any templates in oder and finally the author's data\nexport function createObject(name, listOfHashes) {\n  if (world.isCreated && !settings.saveDisabled) return errormsg(\"Attempting to use createObject with `\" + name + \"` after set up. To ensure games save properly you should use cloneObject to create ites during play.\")\n  if (/\\W/.test(name)) return errormsg(\"Attempting to use the prohibited name `\" + name + \"`; a name can only include letters and digits - no spaces or accented characters. Use the 'alias' attribute to give an item a name with other characters.\")\n  if (w[name]) return errormsg(\"Attempting to use the name `\" + name + \"` when there is already an item with that name in the world.\")\n  if (typeof listOfHashes.unshift !== 'function') return errormsg(\"The list of hashes for `\" + name + \"` is not what I was expecting. Maybe you meant to use createItem or createRoom?\")\n\n  // put the default attributes on the list\n  listOfHashes.unshift(DEFAULT_OBJECT)\n\n  const item = { name:name }\n\n  for (let hash of listOfHashes) {\n    for (let key in hash) {\n      item[key] = hash[key]\n    }\n  }\n\n  // Give every object an alias and list alias (used in the inventories)\n  item.setAlias(item.alias ? item.alias : item.name.replace(/_/g, \" \"), item)\n\n  item.verbFunctions = [world.defaultVerbFunction]\n  item.nameModifierFunctions = []\n  item.initialiserFunctions = []\n  for (let hash of listOfHashes) {\n    if (hash.afterCreation) item.initialiserFunctions.push(hash.afterCreation)\n  }\n\n  w[name] = item;\n  return item;\n}\n\nlet region;\nw._player = null;\nw._loc = null;\n\nexport function player() {\n    if (!w._player) {\n        return errormsg(\"No player object found. This is probably due to an error in the data file where the player object is defined, but could be because you have not set one.\");\n    }\n\n    return w._player;\n}\nexport function setPlayer(char) {\n    w._player = char;\n}\n\nexport function loc() {\n    if (!w._loc) {\n        return errormsg(\"Something wrong - current location not found!\");\n    }\n\n    return w._loc;\n}\n\n/*\nThis can be considered a stateless controller for the game world.\nIt is stateless because nothing here will be saved - use `game` for that.\nIt handles initialising, turn taking, room entering\n*/\nexport const world = {\n  //VISIBLE:1,\n  //REACHABLE:2,\n\n  // constants for lighting levels\n  LIGHT_NONE:0,\n  LIGHT_SELF:1,\n  LIGHT_MEAGRE:2,\n  LIGHT_FULL:3,\n  LIGHT_EXTREME:4,\n\n  // constants for verbosity of room descriptions\n  BRIEF:1,\n  TERSE:2,\n  VERBOSE:3,\n\n  // constants for isAtLoc situations\n  LOOK:1,\n  PARSER:2,\n  INVENTORY:3,\n  SIDE_PANE:4,\n  PURCHASE:5,\n  ALL:6,\n\n  // constants for command responses\n  // (but a verb will return true or false, so the command that uses it\n  // can in turn return one of these - a verb is an attribute of an object)\n  SUCCESS:1,\n  SUCCESS_NO_TURNSCRIPTS:2,\n  FAILED:-1,\n  PARSER_FAILURE:-2,\n\n  isCreated:false,\n\n\n  //------------------------------------------------------------\n  // Initialisation\n\n  init:function() {\n    settings.performanceLog('Start world.init')\n    // Initialise the player\n    for (let key in w) {\n      if (w[key].player) { setPlayer(w[key]); }\n    }\n    // check player found:\n    player();\n\n    // Initialise all object\n    for (let key in w) {\n      world.initItem(w[key])\n    }\n\n    // Initialise commands\n    initCommands()\n\n    settings.verbosity = world.VERBOSE\n\n    game.ticker = setInterval(world.gameTimer, settings.timerInterval);\n\n    w[player().loc].visited++\n    world.update()\n    world.saveGameState()\n    settings.performanceLog('End world.init')\n    world.isCreated = true\n  },\n  // Every item or room should have this called for them.\n  // That will be done at the start, but you need to do it yourself\n  // if creating items on the fly (but you should not be doing that anyway!).\n  initItem:function(item) {\n    if (item.clonePrototype) return errormsg('Trying to initiaslise a cloned object. This is not permitted, as the prototype will not have been initialised before it was cloned. Instead, clone the object in settings.setup.')\n    // remove duplicates first - can occur if a template adds another template and the author does so too\n    for (const f of [...new Set(item.initialiserFunctions)]) f(item)\n    delete item.initialiserFunctions\n    delete item.afterCreation\n\n    // Initialise exits\n    for (let exit of lang.exit_list) {\n      // So exit is the data object from lang, while ex is the Exit the author has created\n      const ex = item[exit.name]\n      if (ex) {\n        ex.origin = item\n        ex.dir = exit.name\n        if (ex.alsoDir) {\n          for (let dir of ex.alsoDir) {\n            item[dir] = new Exit(ex.name, ex);\n            item[dir].scenery = true\n            item[dir].isAlsoDir = true\n            item[dir].dir = dir\n            delete item[dir].alsoDir\n          }\n        }\n        if (ex instanceof Link) {\n          const reverseDir = ex.reverse()\n          const dest = w[ex.name]\n          if (dest[reverseDir]) {\n            log('WARNING: The returning Exit for the Link on ' + item.name + ' goes to a direction that already has something set (conflicts with \"' + reverseDir + '\" on ' + dest.name + ').')\n            continue\n          }\n          dest[reverseDir] = new Exit(ex.origin.name)\n          dest[reverseDir].origin = dest\n          dest[reverseDir].dir = reverseDir\n        }\n      }\n    }\n\n    // Handle room set\n    if (item.roomSet) {\n      if (!settings.roomSetList[item.roomSet]) {\n        settings.roomSetList[item.roomSet] = []\n      }\n      settings.roomSetList[item.roomSet].push({name:item.name, visited:false})\n    }\n\n\n\n    if (settings.playMode === 'dev' && !settings.disableChecks && !item.abstract) {\n      if (item.loc && !w[item.loc]) {\n        warningFor(item, \"In an unknown location (\" + item.loc + \")\");\n      }\n\n      if (item.consultable && !settings.noAskTell) {\n        if (!item.tellOptions || item.tellOptions.length === 0) warningFor(item, \"No tellOptions for consultable/NPC\")\n        if (!item.askOptions || item.askOptions.length === 0) warningFor(item, \"No askOptions for consultable/NPC\")\n      }\n\n      const dirs = lang.exit_list.filter(el => el.type !== 'nocmd').map(el => el.name)\n      //console.log(dirs)\n      for (let key in item) {\n        if (dirs.includes(key)) {\n          if (!item[key] instanceof Exit) warningFor(item, \"Exit \" + key + \" is not an Exit instance.\")\n          if (item[key].name !== '_' && !w[item[key].name]) warningFor(item, \"Exit \" + key + \" goes to an unknown location (\" + item[key].name + \").\")\n        }\n        else {\n          if (item[key] instanceof Exit) warningFor(item, \"Attribute \" + key + \" is an Exit instance and probably should not.\")\n        }\n      }\n\n      if (item.abstract) {\n        // do nothing\n      }\n      if (item.room) {\n        if (typeof item.desc === 'function') {\n          try {\n            test.testing = true\n            test.testOutput = []\n            const out = item.desc()\n            test.testing = false\n            if (test.testOutput.length > 0) warningFor(item, \"The 'desc' attribute for this location is a function that prints directy to screen; should return a string only: \" + item.name)\n            if (typeof out !== 'string') {\n              warningFor(item, \"The 'desc' function attribute does not return a string\")\n            }\n          }\n          catch(err) {\n            warningFor(item, \"The 'desc' function caused an error\")\n            log(err.message)\n            log(err.stack)\n          }\n        } else if (typeof item.desc !== 'string') {\n          warningFor(item, \"The 'desc' attribute for this location is neither a string nor a function\")\n        }\n      }\n      else if (item.conversationTopic) {\n        if (!item.msg && !item.script) warningFor(item, \"Topic has neither 'script' or 'msg' attribute\")\n        if (item.msg && typeof item.msg !== 'string') warningFor(item, \"The 'msg' attribute for this topic is not a string\")\n        if (item.script && typeof item.script !== 'function') warningFor(item, \"The 'script' attribute for this topic is not a function\")\n      }\n      else {\n        if (typeof item.examine === 'function') {\n          try {\n            test.testing = true\n            test.testOutput = []\n            const out = item.examine({char:player(), item:item})\n            test.testing = false\n            if (out !== undefined) {\n              warningFor(item, \"The 'examine' function attribute returns a value; it probably should not\")\n            }\n          }\n          catch(err) {\n            warningFor(item, \"The 'examine' function caused an error\")\n            log(err.message)\n            log(err.stack)\n          }\n        }\n        else if (typeof item.examine !== 'string') {\n          warningFor(item, \"The 'examine' attribute for this item is neither a string nor a function\")\n        }\n      }\n      if (settings.customObjectChecks) settings.customObjectChecks(item)\n    }\n\n\n  },\n\n  // Start the game - could be called after the start up dialog, so not part of init\n  begin:function() {\n    settings.performanceLog('Start begin')\n    if (settings.startingDialogEnabled) return\n    if (typeof settings.intro === \"string\") {\n      msg(settings.intro)\n    }\n    else if (settings.intro) {\n      for (let el of settings.intro) msg(el)\n    }\n    if (typeof settings.setup === \"function\") settings.setup()\n    world.enterRoom()\n    settings.performanceLog('End begin')\n  },\n\n  //------------------------------------------------------------\n  // Turn taking\n\n  // Call after the player takes a turn, sending it a result, SUCCESS, SUCCESS_NO_TURNSCRIPTS or FAILED\n  endTurn:function(result) {\n    if (result === true) log(\"That command returned 'true', rather than the proper result code.\");\n    if (result === false) log(\"That command returned 'false', rather than the proper result code.\");\n    util.handleChangeListeners()\n    if (result === world.SUCCESS || (settings.failCountsAsTurn && result === world.FAILED)) {\n      game.turnCount++\n      game.elapsedTime += settings.dateTime.secondsPerTurn;\n      for (const key in w) w[key].endTurn()\n      for (const m of settings.modulesToEndTurn) m.endTurn()\n\n      util.handleChangeListeners()\n      world.resetPauses();\n      world.update();\n      world.saveGameState();\n      endTurnUI(true);\n    }\n    else {\n      endTurnUI(false);\n    }\n  },\n\n\n  // Updates the game world, specifically...\n  // Sets the scoping snapshot\n  // Sets the light/dark\n  update:function() {\n    if (!player()) return errormsg(\"No player object found. This will not go well...\")\n    if (player().loc === player().name) return errormsg(\"The location assigned to the player is the player itself.\")\n    if (!player().loc || !w[player().loc]) {\n      if (world.isCreated) {\n        return errormsg((player().loc === undefined ? \"No player location set.\" : \"Player location set to '\" +\n            player().loc + \"', which does not exist.\") + \" Has the player just moved? This is likely to be because of an error in the exit being used.\")\n      }\n      else {\n        return errormsg((player().loc === undefined ? \"No player location set.\" : \"Player location set to '\" +\n            player().loc + \"', which does not exist.\") + \" This is may be because of an error in one of the .js files; the browser has hit the error and stopped at that point, before getting to where the player is set. Is there another error above this one? If so, that i the real problem.\")\n      }\n    }\n    w._loc = w[player().loc]\n\n    world.scopeSnapshot()\n  },\n\n  resetPauses:function() {\n    for (let key in w) {\n      if (w[key].paused){\n        w[key].paused = false\n      }\n    }\n  },\n\n  // Returns true if bad lighting is not obscuring the item\n  ifNotDark:function(item) {\n    return (!game.dark || item.lightSource() > world.LIGHT_NONE);\n  },\n\n  // scopeStatus is used to track what the player can see and reach; it is a lot faster than working\n  // it out each time, as the scope needs to be checked several times every turn.\n  scopeSnapshot:function() {\n    // reset every object\n    for (let key in w) w[key].scopeStatus = {}\n    world.scope = []\n\n    world.takeScopeSnapshot(\"See\")\n    world.takeScopeSnapshot(\"Reach\")\n    if (!world.scope.includes(loc())) world.scope.push(loc())\n    if (player().onPhoneTo && !world.scope.includes(w[player().onPhoneTo])) world.scope.push(w[player().onPhoneTo])\n\n    let light = world.LIGHT_NONE\n    for (const item of world.scope) {\n      if (!item.lightSource) log(item.name)\n      if (light < item.lightSource()) {\n        light = item.lightSource()\n      }\n    }\n    game.dark = (light < world.LIGHT_MEAGRE)\n  },\n\n  // mode is either \"Reach\" or \"See\"\n  takeScopeSnapshot:function(mode) {\n    // start from the current room\n    let room = loc()\n    room.scopeStatus['room' + mode] = true\n    // crawl up the room hierarchy to the topmost reachable/visible\n    while (room.loc && room['can' + mode + 'ThroughThis']()) {\n      room = w[room.loc]\n      room.scopeStatus['room' + mode] = true\n    }\n    // room is now the top level applicable, so now work downwards from here (recursively)\n    room.scopeSnapshot(mode)\n  },\n\n  defaultVerbFunction:function(o, verbList) {\n    verbList.push(lang.verbs.examine)\n    if (o.use !== undefined) verbList.push(lang.verbs.use)\n  },\n\n  //------------------------------------------------------------\n  // Entering a new room\n\n  // Runs the script and gives the description\n  enterRoom:function(exit) {\n    if (loc().beforeEnter === undefined) {\n      return errormsg(\"This room, \" + loc().name + \", has no 'beforeEnter` function defined.  This is probably because it is not actually a room (it was not created with 'createRoom' and has not got the DEFAULT_ROOM template), but is an item. It is not clear what state the game will continue in.\")\n    }\n    settings.beforeEnter(exit)\n    if (loc().visited === 0) {\n      if (loc().roomSet) {\n        loc().roomSetOrder = 1\n        for (const el of settings.roomSetList[loc().roomSet]) {\n          if (el.visited) loc().roomSetOrder++\n          if (el.name === loc().name) el.visited = true\n        }\n      }\n      loc().beforeFirstEnter(exit)\n    }\n    loc().beforeEnter(exit)\n    world.enterRoomAfterScripts(exit);\n  },\n\n  // Called when entering a new room, after beforeEnter and beforeFirstEnter re done\n  enterRoomAfterScripts:function(exit) {\n    loc().description()\n    player().handleMovingFollowers(exit)\n    loc().visited++\n    loc().afterEnter(exit)\n    settings.afterEnter(exit)\n    if (loc().visited === 1) { loc().afterFirstEnter(exit) }\n    for (let key in loc().afterEnterIf) {\n      // if already done, skip\n      if (loc().afterEnterIfFlags.split(\" \").includes(key)) continue;\n      if (loc().afterEnterIf[key].test()) {\n        loc().afterEnterIf[key].action()\n        loc().afterEnterIfFlags += \" \" + key\n      }\n    }\n  },\n\n\n\n  //------------------------------------------------------------\n  // Real time event handling\n  gameTimer:function() {\n    // Note that this gets added to window by setInterval, so 'this' does not refer to the game object\n    game.elapsedRealTime++;\n    let somethingHappened = false\n    for (let i = 0; i < game.timerEventNames.length; i++) {\n      if (game.timerEventTriggerTimes[i] && game.timerEventTriggerTimes[i] < game.elapsedRealTime) {\n        const flag = settings.eventFunctions[game.timerEventNames[i]]()\n        if (game.timerEventIntervals[i] !== -1 && !flag) {\n          game.timerEventTriggerTimes[i] += game.timerEventIntervals[i]\n        }\n        else {\n          game.timerEventTriggerTimes[i] = 0\n        }\n        somethingHappened = true\n      }\n    }\n    if (somethingHappened) util.handleChangeListeners()\n  },\n\n\n  //------------------------------------------------------------\n  // UNDO Support\n  gameState:[],\n  saveGameState:function() {\n    if (settings.maxUndo > 0) {\n      world.gameState.push(saveLoad.getSaveBody());\n      if (world.gameState.length > settings.maxUndo) world.gameState.shift();\n    }\n  },\n\n  find:function(fn, options) {\n    for (const key in w) {\n      if (fn(w[key], options)) return w[key]\n    }\n    return null\n  }\n}\n\nexport const game = {\n  turnCount:0,\n  elapsedTime:0,\n  elapsedRealTime:0,\n  startTime:settings.dateTime.start,\n  name:'built-in_game_object',\n\n  timerEventNames:[],\n  timerEventTriggerTimes:[],\n  timerEventIntervals:[],\n\n  getSaveString:function() {\n    let s = \"GameState=\"\n    for (const key in this) {\n      if (!this.saveLoadExclude(key)) s += saveLoad.encode(key, this[key])\n    }\n    return s\n  },\n  setLoadString:function(s) {\n    const parts = s.split(\"=\")\n    if (parts.length !== 2) return errormsg(\"Bad format in saved data (\" + s + \")\")\n    if (parts[0] !== \"GameState\") return errormsg(\"Expected GameState to be second\")\n    saveLoad.setFromArray(this, parts[1].split(\";\"));\n  },\n  saveLoadExclude:function(att) {\n    return (att === 'player' || typeof this[att] === 'function' || typeof this[att] === 'object')\n  },\n}\n\nexport class Exit {\n  constructor(name, hash) {\n    if (!hash) hash = {}\n    this.name = name\n    // set these from util so the defaults can be modified\n    this.use = util.defaultExitUse\n    this.isGuarded = util.defaultExitIsGuarded\n    this.getExitObject = function() { return lang.exit_list.find(el => el.name === this.dir ) }\n    this.nice = function() {\n      const dirObj = this.getExitObject()\n      return dirObj.niceDir ? dirObj.niceDir : dirObj.name\n    }\n    this.reverseNice = function() {\n      const dirObj = this.reverseObject()\n      return dirObj.niceDir ? dirObj.niceDir : dirObj.name\n    }\n    this.reverse = function() { return this.getExitObject().opp }\n    this.reverseObject = function() {\n      const dir = this.getExitObject().opp\n      return lang.exit_list.find(el => el.name === dir)\n    }\n    this.isLocked = function() { return this.origin.isExitLocked(this.dir); }\n    this.setLock = function(locked) { return this.origin.setExitLock(this.dir, locked); }\n    this.isHidden = function() { return this.origin.isExitHidden(this.dir) }\n    this.setHide = function(hidden) { return this.origin.setExitHide(this.dir, hidden); }\n    for (let key in hash) {\n      if (key !== 'name') this[key] = hash[key];\n    }\n  }\n}\n\nexport class Link extends Exit {\n  constructor(name, hash) {\n    super(name, hash)\n  }\n}\n\nexport const regions = {};\nexport const setRegion = function(name, data) {\n  region = name\n  regions[name] = data\n}\n","// noinspection JSUnusedGlobalSymbols\n\n\"use strict\";\n\n// Should all be language neutral\n\nimport {\n    CHARACTER, debugmsg, errormsg, failedmsg, falsemsg, formatList,\n    getResponseList, metamsg, msg, printOrRun, respond,\n    util, io, lang, array, w,\n    game, world, settings, player, loc\n} from \"../index.js\";\n\nexport const NPC = function(isFemale) {\n  // A whole bunch of defaults are the same as the player\n  const res = Object.assign({}, CHARACTER(), CONSULTABLE(), AGENDA_FOLLOWER());\n\n  res.npc = true;\n  res.isFemale = isFemale\n  res.pronouns = isFemale ? lang.pronouns.female : lang.pronouns.male\n\n  res.askOptions = [];\n  res.tellOptions = [];\n  res.excludeFromAll = true;\n  res.reactions = []\n  res.receiveItems = [\n    {\n      msg:lang.not_interested_for_give,\n      failed:true,\n    },\n  ];\n  res.followers = []\n  res.canReachThroughThis = () => false;\n  res.icon = () => 'npc12'\n\n  // This does not work properly, it just gets all clothing!!!\n  // But authors could replace as required\n  res.getWearingVisible = function() {\n    return this.getWearing();\n  };\n\n  res.isHere = function() {\n    return this.isAtLoc(player().loc);\n  }\n\n  res.msg = function(s, params) {\n    if (this.isHere()) msg(s, params);\n  }\n\n  res.multiMsg = function(ary) {\n    if (!this.isHere()) return;\n    const counter = ary[0].replace(/[^a-z]/ig, '');\n    if (this[counter] === undefined) this[counter] = -1;\n    this[counter]++;\n    if (this[counter] >= ary.length) this[counter] = ary.length - 1;\n    if (ary[this[counter]]) msg(ary[this[counter]]);\n  }\n\n  // can we see the NPC from here?\n  // do we need a prefix?\n  res.inSight = function(room) {\n    if (!this.loc) return false\n    if (!room) room = w[this.loc]\n    if (player().loc === room.name) return true\n    if (room.visibleFrom === undefined) return false\n    if (typeof room.visibleFrom === 'function') return room.visibleFrom(loc())\n    if (Array.isArray(room.visibleFrom)) {\n      if (room.visibleFrom.includes(loc().name)) return room.visibleFromPrefix ? room.visibleFromPrefix : true\n    }\n    return false\n  }\n\n  res.setLeader = function(npc) {\n    if (typeof npc === 'string') npc = w[npc]\n    if (this.leaderName) array.remove(w[this.leaderName].followers, this.name)\n    if (npc) {\n      npc.followers.push(this.name)\n      this.leaderName = npc.name\n    }\n    else {\n      delete this.leaderName\n    }\n  }\n\n  res.getFollowers = function() {\n    return this.followers.map(el => w[el])\n  }\n\n  // Used by commands\n  res.startFollow = function() {\n    if (this.leaderName) return falsemsg(lang.already_following, {npc:this})\n    this.setLeader(player())\n    msg(\"{nv:npc:nod:true} his head.\", {npc:this})\n    return true\n  };\n  res.endFollow = function() {\n    if (!this.leaderName) return falsemsg(lang.already_waiting, {npc:this})\n    this.setLeader()\n    msg(\"{nv:npc:nod:true} his head.\", {npc:this})\n    return true\n  };\n\n  res.endTurn = function(turn) {\n    if (this.dead) return\n    this.sayTakeTurn()\n    this.doReactions()\n    if (!this.paused && !this.suspended && this.agenda && this.agenda.length > 0) this.doAgenda()\n    this.doEvent(turn)\n  }\n\n  res.doReactions = function() {\n    if (this.player) return   // needed for POV swapping\n    if (!this.isHere() && !settings.npcReactionsAlways) return\n    if (!this.reactionFlags) this.reactionFlags = []\n\n    const params = {\n      char:this,\n      noResponseNotError:true,\n      afterScript:function(params, response) {\n        if (!response) return\n        if (response.name) params.char.reactionFlags.push(response.name)\n        if (!response.noPause) params.char.pause()\n        if (response.override) params.char.reactionFlags = params.char.reactionFlags.concat(response.override)\n      },\n      extraTest:function(params, response, ) {\n        return !response.name || !params.char.reactionFlags.includes(response.name)\n      },\n    }\n    respond(params, this.reactions)\n  }\n\n  for (const key in npc_utilities) res[key] = npc_utilities[key]\n\n  // For ASK/TELL\n  res.topics = function() {\n    if (this.askOptions.length === 0 && this.tellOptions.length === 0) {\n      metamsg(lang.topics_no_ask_tell);\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    }\n\n    let flag = false;\n    for (let action of ['ask', 'tell']) {\n      const arr = getResponseList({char:this, action:action}, this[action + 'Options']);\n      const arr2 = []\n      for (let res of arr) {\n        if (res.silent && !player().mentionedTopics.includes(res.name)) continue\n        arr2.push(res.name)\n      }\n      if (arr2.length !== 0) {\n        metamsg(lang['topics_' + action + '_list'], {item:this, list:arr2.sort().join('; ')});\n        flag = true;\n      }\n    }\n\n    if (!flag) {\n      metamsg(lang.topics_none_found, {item:this})\n    }\n\n    return settings.lookCountsAsTurn ? world.SUCCESS : world.SUCCESS_NO_TURNSCRIPTS\n  }\n\n  res.sayBonus = 0;\n  res.sayPriority = 0;\n  res.sayState = 0;\n  res.sayUsed = \" \";\n  res.sayResponse = function(s) {\n    if (!this.sayResponses) return false\n\n    const params = {\n      text:s,\n      char:this,\n      extraTest:function(params, response) {\n        if (!response.regex) return true\n        if (response.id && params.char.sayUsed.match(new RegExp('\\\\b' + response.id + '\\\\b'))) return false\n        return response.regex.test(params.text)\n      },\n      afterScript:function(params, response) {\n        if (!response) return\n        if (this.oldQuestion) {\n          delete this.oldQuestion\n        }\n        else {\n          params.char.sayBonus = 0\n          params.char.sayQuestion = false\n        }\n        if (response.id) params.char.sayUsed += response.id + \" \"\n      },\n      noResponseNotError:true,\n    }\n    return respond(params, this.sayResponses)\n  }\n\n  res.sayCanHear = function(char, verb) {\n    return char.loc === this.loc;\n  }\n\n  res.askQuestion = function(questionName) {\n    if (typeof questionName !== \"string\") questionName = questionName.name\n    if (this.sayQuestion) this.oldQuestion = this.sayQuestion\n    const q = util.questionList[questionName]\n    if (!q) return errormsg(\"Trying to set a question that does not exist, \" + questionName + \", for \" + this.name)\n\n    this.sayQuestion = questionName\n    this.sayQuestionCountdown = q.countdown\n    this.sayBonus = 100\n  }\n\n  res.respondToAnswer = function(s) {\n    const q = util.questionList[this.sayQuestion]\n    return q.sayResponse(this, s)\n  }\n\n  res.sayTakeTurn = function() {\n    if (!this.sayQuestion) return\n    this.sayQuestionCountdown--\n    if (this.sayQuestionCountdown > 0) return\n    const q = util.questionList[this.sayQuestion]\n    this.sayQuestion = false\n    this.sayBonus = 0\n    if (q.expiredScript) q.expiredScript(this)\n  }\n\n  return res;\n};\n\nexport const npc_utilities = {\n  findTopic:function(alias, n = 1) {\n    return util.findTopic(alias, this, n)\n  },\n  showTopic:function(alias, n = 1) {\n    util.findTopic(alias, this, n).show()\n  },\n  hideTopic:function(alias, n = 1) {\n    util.findTopic(alias, this, n).hide()\n  },\n\n\n  talkto:function() {\n    if (settings.noTalkTo !== false) {\n      metamsg(settings.noTalkTo);\n      return false;\n    }\n\n    if (!player().testTalk(this)) return false\n    if (this.testTalk && !this.testTalk()) return false\n\n    // handle non-dynamic talkto\n    if (typeof this.talk === 'string') {\n      msg(this.talk, {char:this})\n      return true\n    }\n    if (typeof this.talk === 'function') {\n      return this.talk()\n    }\n\n    // handle dynamic talkto\n    const topics = this.getTopics()\n    player().conversingWithNpc = this\n    if (topics.length === 0) return failedmsg(this.no_topics ? this.no_topics : lang.no_topics, {char:player(), item:this});\n\n    if (this.greeting) {\n      printOrRun(this, this, \"greeting\");\n    }\n    topics.push(lang.never_mind)\n\n    const fn = io.menuFunctions[settings.funcForDynamicConv]\n    fn(lang.speak_to_menu_title(this), topics, function(result) {\n      if (result !== lang.never_mind) {\n        result.runscript();\n      }\n    })\n\n    return world.SUCCESS_NO_TURNSCRIPTS;\n  },\n\n  askTopics:function(...topics) {\n    const title = topics.shift()\n    const fn = io.menuFunctions[settings.funcForDynamicConv]\n    fn(title, topics, function(result) {\n      result.runscript();\n    })\n  },\n\n  getTopics:function() {\n    const list = [];\n    for (let key in w) {\n      if (w[key].isTopicVisible && w[key].isTopicVisible(this)) {\n        list.push(w[key]);\n      }\n    }\n    return list;\n  },\n\n}\n\nexport const AGENDA_FOLLOWER = function() {\n  const res = {}\n  res.agenda = []\n  res.suspended = false\n  res.followers = []\n  res.inSight = function() { return false }\n  res.endTurn = function(turn) {\n    if (!this.paused && !this.suspended && this.agenda.length > 0) this.doAgenda()\n    this.doEvent(turn)\n  }\n\n  res.setAgenda = function(agenda) {\n    this.agenda = agenda\n    this.suspended = false\n    this.agendaWaitCounter = false\n    this.patrolCounter = false\n  }\n\n  res.doAgenda = function() {\n    // If this NPC has followers, we fake it so it seems to be the group\n    if (this.followers.length !== 0) {\n      this.savedPronouns = this.pronouns;\n      this.savedAlias = this.alias\n      this.pronouns = lang.pronouns.plural;\n      this.followers.unshift(this.name);\n      this.alias = formatList(this.getFollowers(), {lastSep:lang.list_and});\n      this.followers.shift();\n    }\n\n    if (!Array.isArray(this.agenda)) throw \"Agenda is not a list for \" + this.name\n    if (typeof this.agenda[0] !== 'string') throw \"Next agenda item is not a string for \" + this.name\n    const arr = this.agenda[0].split(\":\");\n    const functionName = arr.shift();\n    if (typeof agenda[functionName] !== \"function\") {\n      errormsg(\"Unknown function `\" + functionName + \"' in agenda for \" + this.name);\n      return;\n    }\n    const flag = agenda[functionName](this, arr)\n    if (flag) this.agenda.shift()\n    if (flag === 'next') this.doAgenda()\n\n    // If we are faking the group, reset\n    if (this.savedPronouns) {\n      this.pronouns = this.savedPronouns\n      this.alias = this.savedAlias\n      this.savedPronouns = false\n    }\n  }\n\n  res.pause = function() {\n    //debugmsg(\"pausing \" + this.name);\n    if (this.leaderName) {\n      w[this.leaderName].pause();\n    }\n    else {\n      this.paused = true;\n    }\n  }\n\n  return res\n}\n\nexport const agenda = {\n  debug:function(s, npc, arr) {\n    if (settings.agendaDebugging && settings.playMode === 'dev') debugmsg('AGENDA for ' + npc.name + ': ' + s + '; ' + formatList(arr, {doNotSort:true}))\n  },\n  debugS:function(s) {\n    if (settings.agendaDebugging && settings.playMode === 'dev') debugmsg('AGENDA comment: ' + s)\n  },\n\n\n  // wait one turn\n  pause:function(npc, arr) {\n    return true;\n  },\n\n  // print the array as text if the player is here\n  // otherwise this will be skipped\n  // Used by several other functions, so this applies to them too\n  text:function(npc, arr) {\n    if (typeof npc[arr[0]] === \"function\") {\n      this.debug(\"text (function)\", npc, arr);\n      const fn = arr.shift();\n      const res = npc[fn](arr);\n      return (typeof res === \"boolean\" ? res : true);\n    }\n    this.debug(\"text (string)\", npc, arr);\n\n    if (npc.inSight()) msg(arr.join(':'))\n    return true;\n  },\n\n  msg:function(npc, arr) {\n    this.debug(\"msg (string)\", npc, arr)\n    msg(arr.join(':'))\n    return true\n  },\n\n  // Alias for text\n  run:function(npc, arr) { return this.text(npc, arr) },\n\n  // sets one attribute on the given item\n  // it will guess if Boolean, integer or string\n  setItemAtt:function(npc, arr) {\n    return this._setItemAtt(npc, arr, false)\n  },\n\n  // sets one attribute on the given item\n  // it will guess if Boolean, integer or string\n  setItemAttThen:function(npc, arr) {\n    return this._setItemAtt(npc, arr, true)\n  },\n\n\n  // sets one attribute on the given item\n  // it will guess if Boolean, integer or string\n  _setItemAtt:function(npc, arr, next) {\n    this.debug(\"setItemAtt\", npc, arr)\n    const item = arr.shift()\n    const att = arr.shift()\n    let value = arr.shift()\n    if (!w[item]) errormsg(\"Item '\" + item + \"' not recognised in the agenda of \" + npc.name)\n    if (value === \"true\") value = true\n    if (value === \"false\") value = false\n    if (/^\\d+$/.test(value)) value = parseInt(value)\n    w[item][att] = value\n    this.text(npc, arr)\n    return next ? 'next' : true\n  },\n\n  // delete one attribute on the given item\n  deleteItemAtt:function(npc, arr) {\n    this.debug(\"deleteItemAtt\", npc, arr)\n    const item = arr.shift()\n    const att = arr.shift()\n    if (!w[item]) errormsg(\"Item '\" + item + \"' not recognised in the agenda of \" + npc.name)\n    delete w[item][att]\n    this.text(npc, arr)\n    return true\n  },\n\n  // Wait n turns\n  wait:function(npc, arr) {\n    this.debug(\"wait\", npc, arr);\n    if (arr.length === 0) return true;\n    if (isNaN(arr[0])) errormsg(\"Expected wait to be given a number in the agenda of '\" + npc.name + \"'\");\n    const count = parseInt(arr.shift());\n    if (npc.agendaWaitCounter !== undefined) {\n      npc.agendaWaitCounter++;\n      if (npc.agendaWaitCounter >= count) {\n        this.debugS(\"Pass\")\n        this.text(npc, arr);\n        return true;\n      }\n      return false;\n    }\n    npc.agendaWaitCounter = 0;\n    return false;\n  },\n\n  // Wait until ...\n  // This may be repeated any number of times\n  waitFor:function(npc, arr) { return this.handleWaitFor(npc, arr, false) },\n  waitForNow:function(npc, arr) { return this.handleWaitFor(npc, arr, true) },\n\n  handleWaitFor:function(npc, arr, immediate) {\n    this.debug(\"waitFor\", npc, arr);\n    let name = arr.shift();\n    if (typeof npc[name] === \"function\") {\n      if (npc[name](arr)) {\n        this.text(npc, arr)\n        this.debugS(\"Pass\")\n        return (immediate ? 'next' : true)\n      }\n      else {\n        return false\n      }\n    }\n    else {\n      if (name === \"player\") name = player().name;\n      if (npc.loc === w[name].loc) {\n        this.text(npc, arr)\n        this.debugS(\"Pass\")\n        return (immediate ? 'next' : true)\n      }\n      else {\n        return false\n      }\n    }\n  },\n\n  waitUntil:function(npc, arr) { return agenda.handleWaitUntilWhile(npc, arr, true) },\n  waitUntilNow:function(npc, arr) { return agenda.handleWaitUntilWhile(npc, arr, true, true) },\n\n  waitWhile:function(npc, arr) { return agenda.handleWaitUntilWhile(npc, arr, false) },\n  waitWhileNow:function(npc, arr) { return agenda.handleWaitUntilWhile(npc, arr, false, true) },\n\n  handleWaitUntilWhile:function(npc, arr, reverse, immediate) {\n    const item = arr[0] === 'player' ? player() : w[arr[0]]\n    arr.shift()\n    const attName = arr.shift()\n    const value = util.guessMyType(arr.shift())\n    let flag = item[attName] === value\n    if (reverse) flag = !flag\n    if (flag) return false\n    msg(arr.join(':'))\n    return immediate ? 'next' : true\n  },\n\n  joinedBy:function(npc, arr) {\n    this.debug(\"joinedBy\", npc, arr);\n    const followerName = arr.shift();\n    w[followerName].setLeader(npc);\n    this.text(npc, arr);\n    return true;\n  },\n\n  joining:function(npc, arr) {\n    this.debug(\"joining\", npc, arr);\n    const leaderName = arr.shift();\n    npc.setLeader(w[leaderName]);\n    this.text(npc, arr);\n    return true;\n  },\n\n  disband:function(npc, arr) {\n    this.debug(\"disband\", npc, arr)\n    for (let s of npc.followers) {\n      const follower = w[s]\n      follower.leader = false\n    }\n    npc.followers = []\n    this.text(npc, arr)\n    return true\n  },\n\n  // Move the given item directly to the given location, then print the rest of the array as text\n  // Do not use for items with a funny location, such as COUNTABLES\n  moveItem:function(npc, arr) {\n    this.debug(\"moveItem\", npc, arr)\n    const item = arr.shift()\n    let dest = arr.shift()\n    if (dest === \"player\") {\n      dest = player().name\n    }\n    else if (dest === \"_\") {\n      dest = false\n    }\n    else {\n      if (!w[dest]) return errormsg(\"Location '\" + dest + \"' not recognized in the agenda of \" + npc.name)\n    }\n    w[item].moveToFrom({char:npc, toLoc:dest, item:item})\n    this.text(npc, arr)\n    return true\n  },\n\n  // Move directly to the given location, then print the rest of the array as text\n  // Use \"player\" to go directly to the room the player is in.\n  // Use an item (i.e., an object not flagged as a room) to have the NPC move\n  // to the room containing the item.\n  // None of the usual reactions will be performed, so items carried with not react to\n  // moving, any followers will be left behind, etc.\n  jumpTo:function(npc, arr) {\n    let dest = arr.shift()\n    if (dest === \"player\") {\n      dest = player().loc\n    }\n    else if (dest === \"_\") {\n      dest = undefined\n      this.text(npc, arr)\n    }\n    else {\n      if (!w[dest]) return errormsg(\"Location '\" + dest + \"' not recognised in the agenda of \" + npc.name)\n      if (!w[dest].room) dest = dest.loc  // go to the room the item is in\n      if (!w[dest]) return errormsg(\"Location '\" + dest + \"' not recognized in the agenda of \" + npc.name)\n    }\n    npc.loc = dest\n    this.text(npc, arr)\n    return true\n  },\n\n  // Move to the given location, then print the rest of the array as text.\n  // There must be an exit from the current room to that room.\n  moveTo:function(npc, arr) {\n    let dest = arr.shift()\n    if (!w[dest]) return errormsg(\"Location '\" + dest + \"' not recognised in the agenda of \" + npc.name)\n    if (!w[dest].room) dest = dest.loc  // go to the room the item is in\n    const exit = w[npc.loc].findExit(dest)\n    if (!exit)return errormsg(\"Could not find an exit to location '\" + dest + \"' in the agenda of \" + npc.name)\n    //log(\"Move \" + npc.name + \" to \" + dest)\n    npc.movingMsg(exit)\n    npc.moveChar(exit)\n    this.text(npc, arr)\n    return true\n  },\n\n  patrol:function(npc, arr) {\n    this.debug(\"patrol\", npc, arr);\n    if (npc.patrolCounter === undefined) npc.patrolCounter = -1;\n    npc.patrolCounter = (npc.patrolCounter + 1) % arr.length;\n    this.moveTo(npc, [arr[npc.patrolCounter]]);\n    return false;\n  },\n\n  // Move to another room via a random, unlocked exit, then print the rest of the array as text\n  walkRandom:function(npc, arr) {\n    this.debug(\"walkRandom\", npc, arr);\n    const exit = w[npc.loc].getRandomExit({excludeLocked:true, excludeScenery:true});\n    if (exit === null) {\n      this.text(npc, arr);\n      return true;\n    }\n    if (!w[exit.name]) errormsg(\"Location '\" + exit.name + \"' not recognised in the agenda of \" + npc.name)\n    npc.movingMsg(exit)\n    npc.moveChar(exit)\n    return false;\n  },\n\n  // Move to the given location, using available, unlocked exits, one room per turn\n  // then print the rest of the array as text\n  // Use \"player\" to go to the room the player is in (if the player moves, the NPC will head\n  // to the new position, but will be omniscient!).\n  // Use an item (i.e., an object not flagged as a room) to have the NPC move\n  // to the room containing the item.\n  // This may be repeated any number of turns\n  leadTo:function(npc, arr) {\n    this.debug(\"leadTo\", npc, arr)\n    if (npc.loc !== player().loc) return false\n    return this.walkTo(npc, arr)\n  },\n  walkTo:function(npc, arr) {\n    this.debug(\"walkTo\", npc, arr)\n    let dest = arr.shift();\n    if (dest === \"player\") dest = player().loc;\n    if (w[dest] === undefined) {\n      errormsg(\"Location '\" + dest + \"' not recognised in the agenda of \" + npc.name);\n      return true;\n    }\n    if (!w[dest].room) {\n      dest = w[dest].loc;\n      if (w[dest] === undefined) {\n        errormsg(\"Object location '\" + dest + \"' not recognised in the agenda of \" + npc.name);\n        return true;\n      }\n    }\n    if (npc.isAtLoc(dest)) {\n      this.text(npc, arr);\n      return true;\n    }\n    else {\n      const route = agenda.findPath(w[npc.loc], w[dest]);\n      if (!route) errormsg(\"Location '\" + dest + \"' not reachable in the agenda of \" + npc.name)\n      const exit = w[npc.loc].findExit(route[0])\n      npc.movingMsg(exit)\n      npc.moveChar(exit)\n      if (npc.isAtLoc(dest)) {\n        this.text(npc, arr);\n        return true;\n      }\n      else {\n        return false;\n      }\n    }\n  },\n\n  // Initiate a conversation, with this topic\n  showTopic:function(npc, arr) {\n    let alias = arr.shift()\n    npc.showTopic(alias)\n    this.text(npc, arr)\n    return true\n  },\n\n\n}\n\n// start and end are the objects, not their names!\nagenda.findPath = function(start, end, maxlength) {\n  if (start === end) return [];\n\n  if (!game.pathID) game.pathID = 0;\n  if (maxlength === undefined) maxlength = 999;\n  game.pathID++;\n  let currentList = [start];\n  let length = 0;\n  let nextList, dest, exits;\n  start.pathfinderNote = { id:game.pathID };\n\n  // At each iteration we look at the rooms linked from the previous one\n  // Any new rooms go into nextList\n  // Each room gets flagged with \"pathfinderNote\"\n  while (currentList.length > 0 && length < maxlength) {\n    nextList = [];\n    length++;\n    for (let room of currentList) {\n      exits = room.getExits({npc:true});\n      for (let exit of exits) {\n        if (exit.name === '_') continue\n        dest = w[exit.name];\n        if (dest === undefined) {\n          errormsg(\"Dest is undefined: \" + exit.name + ' (room ' + room.name + '). Giving up.');\n          console.log(this)\n          return false\n        }\n        if (dest.pathfinderNote && dest.pathfinderNote.id === game.pathID) continue;\n        dest.pathfinderNote = { jumpFrom:room, id:game.pathID };\n        if (dest === end) return agenda.extractPath(start, end);\n        nextList.push(dest);\n      }\n    }\n    currentList = nextList;\n  }\n  return false\n  /*console.error(\"Path-finding failed: \" + (currentList.length === 0 ? 'list is empty' : 'exceeded maximum length'))\n  log(\"start: \" + start.name)\n  log(\"end: \" + end.name)\n  log(\"maxlength: \" + maxlength)\n  console.trace()\n  throw(\"Path-finding failed, see comments above.\")*/\n}\n\nagenda.extractPath = function(start, end) {\n  let res = [end];\n  let current = end;\n  let count = 0;\n\n  do {\n    current = current.pathfinderNote.jumpFrom;\n    res.push(current);\n    count++;\n  } while (current !== start && count < 99);\n  res.pop();  // The last is the start location, which we do not ned\n  return res.reverse();\n}\n\nexport const CONSULTABLE = function() {\n  const res = {}\n  res.consultable = true\n\n  res.askabout = function(text1, text2) {\n    return this.asktellabout(text1, text2, lang.ask_about_intro, this.askOptions, \"ask\")\n  }\n  res.tellabout = function(text1, text2) {\n    return this.asktellabout(text1, text2, lang.tell_about_intro, this.tellOptions, \"tell\")\n  }\n\n  res.talkabout = function(text1, text2) {\n    let data = this.talkOptions\n    if (!this.talkOptions) data = this.tellOptions ? this.tellOptions.concat(this.askOptions) : this.askOptions\n    return this.asktellabout(text1, text2, lang.talk_about_intro, data, \"talk\");\n  }\n\n\n  res.asktellabout = function(text1, text2, intro, list, action) {\n    if (settings.noAskTell !== false) {\n      metamsg(settings.noAskTell);\n      return false;\n    }\n\n    if (!player().testTalk(this)) return false\n    if (this.testTalk && !this.testTalk(text1, action)) return false\n\n    if (!list || list.length === 0) {\n      metamsg(settings.noAskTell);\n      return errormsg(\"No \" + action + \"Options set for \" + this.name + \" and I think there should at least be default saying why.\")\n    }\n    if (settings.givePlayerAskTellMsg) msg(intro(this, text1, text2), {char:player()});\n\n    const params = {\n      text:text1,\n      text2:text2,\n      char:this,\n      action:action,\n      extraTest:function(params, response) {\n        if (!response.regex) return true\n        return response.regex.test(params.text)\n      },\n      afterScript:this.askTellDone\n    }\n    return respond(params, list)\n  }\n  res.askTellDone = function(params, response) {\n    if (!response) {\n      msg(lang.npc_no_interest_in, params)\n      return\n    }\n    if (response.mentions) {\n      for (let s of response.mentions) {\n        if (!player().mentionedTopics.includes(s)) player().mentionedTopics.push(s)\n      }\n    }\n    if (params.char.pause) params.char.pause()\n  }\n\n  return res;\n};\n\nexport class Question {\n  constructor(name, responses) {\n    this.name = name\n    this.responses = responses\n    this.countdown = settings.turnsQuestionsLast\n  }\n\n  sayResponse(char, s) {\n    const params = {\n      text:s,\n      char:char,\n      question:this,\n      extraTest:function(params, response) {\n        if (!response.regex) return true\n        return response.regex.test(params.text)\n      },\n      afterScript:function(params, response) {\n        if (this.oldQuestion) {\n          delete this.oldQuestion\n        }\n        else {\n        //if (!response || response.disableReset) return\n          params.char.sayBonus = 0\n          params.char.sayQuestion = false\n          delete params.char.questionExpiredFunction\n        }\n        if (params.question.afterScript) {\n          params.question.afterScript(params, response)\n        }\n      },\n      noResponseNotError:true,\n    }\n    return respond(params, this.responses)\n  }\n}\n\nutil.questionList = {}\nutil.createQuestion = function(name, responses, options = {}) {\n  const q = new Question(name, responses)\n  for (const key in options) q[key] = options[key]\n  util.questionList[name] = q\n  return q\n}\n\nexport const TOPIC = function(fromStart) {\n    return {\n      conversationTopic: true,\n      showTopic: fromStart,\n      hideTopic: false,\n      hideAfter: true,\n      properNoun: true, // we do not want \"the\" prepended\n      nowShow: [],\n      nowHide: [],\n      count: 0,\n      isVisible: () => true,\n      isAtLoc: () => false,\n      belongsTo: function (loc) {\n          return this.loc === loc\n      },\n      eventPeriod: 1,\n      eventIsActive: function () {\n          return this.showTopic && !this.hideTopic && this.countdown;\n      },\n      eventScript: function () {\n          this.countdown--\n          if (this.countdown < 0) this.hide()\n      },\n      runscript: function () {\n          let obj = player().conversingWithNpc\n          if (obj === undefined) return errormsg(\"No conversing NPC called \" + player().conversingWithNpc + \" found.\")\n          obj.pause()\n          this.hideTopic = this.hideAfter\n          if (!this.script && !this.msg) return errormsg(\"Topic \" + this.name + \" has neither script nor msg attributes.\")\n          if (this.script) {\n              if (typeof this.script !== \"function\") return errormsg(\"script for topic \" + this.name + \" is not a function.\")\n              this.script.bind(obj)({char: obj, player: player(), topic: this})\n          }\n          if (this.msg) {\n              if (typeof this.msg !== \"string\") return errormsg(\"msg for topic \" + this.name + \" is not a string.\")\n              msg(this.msg, {char: obj, topic: this})\n          }\n          this.showHideList(this.nowShow, true)\n          this.showHideList(this.nowHide, false)\n          this.count++\n          world.endTurn(world.SUCCESS)\n      },\n      isTopicVisible: function (char) {\n          return this.showTopic && !this.hideTopic && this.belongsTo(char.name) && this.isVisible(char)\n      },\n      showHideList: function (list, isShow) {\n          if (typeof list === \"string\") {\n              log(\"WARNING: \" + (isShow ? \"nowShow\" : \"nowHide\") + \" for topic \" + this.name + \" is a string.\")\n              return\n          }\n          for (let s of list) {\n              const t = util.findTopic(s)\n              if (t) {\n                  t[isShow ? 'showTopic' : 'hideTopic'] = true\n              } else {\n                  log(\"WARNING: Topic \" + this.name + \" wants to now show/hide a non-existent topic, \" + s)\n              }\n          }\n      },\n      show: function () {\n          return this.showTopic = true\n      },\n      hide: function () {\n          return this.hideTopic = true\n      },\n  };\n};\n","\"use strict\";\n\n//@DOC\n// ## Parser Functions\n//\n// Most of these are only for internal use! See here details of how it all works.\n// https://github.com/ThePix/QuestJS/wiki/The-Parser#technical-notes\n//\n//@UNDOC\n\nimport {\n    array,\n    io,\n    lang,\n    world,\n    w,\n    debugmsg,\n    parsermsg,\n    printError,\n    processText,\n    player,\n    loc,\n    settings, commands\n} from \"../index.js\";\n\nexport const parser = {};\n\nparser.currentCommand = null;\n// Stores the current values for it, him, etc.\nparser.pronouns = {}\nparser.specialText = {}\nparser.debug = false\nparser.BAD_SPECIAL = -14\nparser.DISALLOWED_MULTIPLE = -16\nparser.NO_OBJECT = -13\nparser.NONE_FOR_ALL = -12\nparser.NO_MATCH = -100\n\n//@DOC\n// The \"parse\" function should be sent either the text the player typed or null.\n// If sent null it will continue to work with the current values in currentCommand.\n// This allows us to keep trying to process a single command until all the\n//  disambiguations have been resolved.\nparser.parse = function(inputText) {\n  io.startCommand()\n  settings.performanceLogStart()\n  settings.performanceLog('Start command')\n\n  // This allows the command system to be temporarily overriden,\n  // say if the game asks a question\n  if (parser.override) {\n    parser.msg(\"Parser overriden\");\n    parser.override(inputText)\n    delete parser.override\n    return\n  }\n\n  if (settings.parserPreprocessor) inputText = settings.parserPreprocessor(inputText)\n\n  // Split into commands on full stop unless this is a user comment.\n  parser.inputTexts = parser.keepTogether(inputText) ? [inputText] : inputText.split(lang.command_split_regex)\n  while (parser.inputTexts.length > 0) {\n    const s = parser.inputTexts.shift()\n    settings.performanceLog('Start \"' + s + '\"')\n    parser.parseSingle(s)\n    settings.performanceLog('Done')\n  }\n}\n\nparser.abort = function() {\n  if (parser.inputTexts.length === 0) return\n  parsermsg(lang.abort_cmds + \": \" + parser.inputTexts.join('; '))\n  parser.inputTexts = []\n}\n\nparser.parseSingle = function(inputText) {\n  parser.msg(\"Input string: \" + inputText);\n\n  if (inputText) {\n    const res = parser.findCommand(inputText)\n    if (typeof res === \"string\") {\n      parsermsg(res)\n      parser.abort()\n      world.endTurn(world.PARSER_FAILURE)\n      return\n    }\n    if (res.tmp.score < 0) {\n      parsermsg(res.tmp.error)\n      parser.abort()\n      world.endTurn(world.PARSER_FAILURE)\n      return\n    }\n    parser.currentCommand = res;\n  }\n  settings.performanceLog('Command found')\n\n  // Need to disambiguate, until each of the lowest level lists has exactly one member\n  let needToDisAmbigFlag = false\n  for (let i = 0; i < parser.currentCommand.tmp.objects.length; i++) {\n    if (!Array.isArray(parser.currentCommand.tmp.objects[i])) continue\n    for (let j = 0; j < parser.currentCommand.tmp.objects[i].length; j++) {\n      if (parser.currentCommand.tmp.objects[i][j] instanceof Array) {\n        if (parser.currentCommand.tmp.objects[i][j].length === 1) {\n          parser.currentCommand.tmp.objects[i][j] = parser.currentCommand.tmp.objects[i][j][0];\n        }\n        else {\n          needToDisAmbigFlag = true;\n          parser.currentCommand.tmp.disambiguate1 = i;\n          parser.currentCommand.tmp.disambiguate2 = j;\n          const fn = io.menuFunctions[settings.funcForDisambigMenu]\n          fn(lang.disambig_msg, parser.currentCommand.tmp.objects[i][j], function(result) {\n            parser.currentCommand.tmp.objects[parser.currentCommand.tmp.disambiguate1][parser.currentCommand.tmp.disambiguate2] = result\n            parser.parseSingle(null)\n          }, function(input) {\n            parser.parse(input)\n          });\n        }\n      }\n    }\n  }\n\n  if (!needToDisAmbigFlag) {\n    settings.performanceLog('About to execute')\n    parser.execute();\n  }\n};\n\n//@DOC\n// You can use this to bypass the parser altogether, for the next input the player types.\n// Instead, the given function will be used, sent the text the player typed.\n//\n// Used by askQuestion in io.\nparser.overrideWith = function(fn) {\n  parser.override = fn\n}\n\n// Do it!\nparser.execute = function() {\n  parser.inspect();\n  let inEndTurnFlag = false\n  try {\n    // save objects for pronouns\n    if (parser.currentCommand.tmp.objects.length > 0 && Array.isArray(parser.currentCommand.tmp.objects[0]) && !parser.currentCommand.all) {\n      for (let obj of parser.currentCommand.tmp.objects[0]) {\n        parser.pronouns[obj.parserPronouns ? obj.parserPronouns.objective : obj.pronouns.objective] = obj\n      }\n    }\n    settings.performanceLog('About to run command script')\n    const outcome = parser.currentCommand.script(parser.currentCommand.tmp.objects)\n    if (outcome === undefined && settings.playMode === 'dev') log(\"WARNING: \" + parser.currentCommand.name + \" command did not return a result to indicate success or failure.\")\n    inEndTurnFlag = true\n    settings.performanceLog('About to run world.endTurn')\n    world.endTurn(outcome)\n  } catch (err) {\n    if (inEndTurnFlag) {\n      printError(\"Hit a coding error trying to process world.endTurn after that command.\", err)\n    }\n    else {\n      printError(\"Hit a coding error trying to process the command `\" + parser.currentCommand.cmdString + \"'.\", err)\n    }\n  }\n  settings.performanceLog('All done')\n};\n\n// This will return a dictionary, with these keys:\n// .inputString    the initial string\n// .cmdString      the sanitised string\n// .cmd            the matched command object\n// .objects        a list (of a list of a list), one member per capture group in the command regex\n// .objects[0]     a list (of a list), one member per object name given by the player for capture group 0\n// .objects[0][0]  a list of possible object matches for each object name given by the player for the\n//                      first object name in capture group 0\nparser.findCommand = function(inputText) {\n\n  // remove multiple spaces, and any from the ends\n  let cmdString = inputText.toLowerCase().trim().replace(/\\s+/g, ' ');\n\n  // convert numbers in words to digits\n  if (settings.convertNumbersInParser) {\n    cmdString = lang.convertNumbers(cmdString);\n  }\n\n  settings.performanceLog('Numbers converted')\n\n\n  // We now want to match potential objects\n  // This will help us narrow down the candidates (maybe)\n  // matchedCandidates is an array of dictionaries,\n  // each one containing a command and some matched objects if applicable\n  //let error = lang.general_obj_error;\n  let bestMatch\n\n  for (const el of commands) {\n    // matchItemsToCmd will attempt to fit the objects, returns a dictionary if successful\n    // or an error message otherwise. Could have more than one object,\n    // either because multiple were specified or because it was ambiguous (or both)\n    // We just keep the last error message as hopefully the most relevant.\n    // NB: Inside function so cannot use 'this'\n    el.matchItems(cmdString, inputText)\n\n    if (el.tmp.score > parser.NO_MATCH) {\n      if (!bestMatch || el.tmp.score > bestMatch.tmp.score) {\n        parser.msg(\"Candidate accepted!\");\n        bestMatch = el\n      }\n    }\n  }\n  settings.performanceLog('Best match found')\n\n  if (!bestMatch) {\n    io.reset()  // just in case something has gone wrong, call this to reset the interface\n    if (settings.playMode === 'dev') log(\"Command was [\" + inputText + \"]\")\n    return lang.not_known_msg;\n  }\n\n  bestMatch.tmp.string = inputText;\n  bestMatch.tmp.cmdString = cmdString;\n  parser.msg(\"This is the one:\" + bestMatch.name);\n  return bestMatch;\n};\n\nparser.matchToNames = function(s, scopes, cmdParams, res) {\n  // Within this item position, break the substring into each item section\n  // For PUT HAT, CUP IN BOX, the first will be ['hat', 'cup']\n  const objectNames = s.split(lang.joiner_regex).map(function(el){ return el.trim() }).filter(e =>  e)\n\n  let objectWordList = [], score = 0\n  for (let s of objectNames) {\n    const n = parser.matchToName(lang.article_filter_regex.exec(s)[1], scopes, cmdParams, objectWordList)\n    if (n < 0) {\n      res.score = n\n      res.error_s = s\n      return\n    }\n    if (n > score) score = n\n  }\n\n  if (objectWordList.length > 1 && !cmdParams.multiple) {\n    res.error = lang.no_multiples_msg;\n    res.score = parser.DISALLOWED_MULTIPLE;\n    return\n  }\n\n  res.objects.push(objectWordList)\n  res.score += score;\n}\n\n// Want to match items from scopes to this string fragment s\n// matches will go in objectWordList and matches, the score is returned\n// objectWordList is a list of lists of objects and corresponds to an item name typed by the user\nparser.matchToName = function(s, scopes, cmdParams, objectWordList) {\n  // objDisambigList is a list of objects that are in the given scope(s) and match the string fragment\n  let [objDisambigList, n] = this.findInScope(s, scopes, cmdParams)\n  if (n === 0) return parser.NO_OBJECT\n\n  // So create a new list that will contain objects in objDisambigList not already in objectWordList\n  // This can happen for an object like \"Ham and cheese sandwich\", which will be split up\n  // as \"ham\" and \"cheese sandwich\"\n  const objDisambigList2 = []\n  // Go though objDisambigList\n  for (const el of objDisambigList) {\n    let flag = false\n    for (const el1 of objectWordList) {\n      for (const el2 of el1) {\n        if (el2.name === el.name) flag = true\n      }\n    }\n    if (flag) {\n      parser.msg(\"..Skipping duplicate: \" + el.name)\n    }\n    else {\n      objDisambigList2.push(el)\n    }\n  }\n  if (objDisambigList2.length > 0) objectWordList.push(objDisambigList2)\n  return n\n\n}\n\n// Tries to match objects to the given string\n// It will return a list of matching objects (to be disambiguated if more than 1),\n// plus the score, depending on which list the object(s) was found in\n// (if there are three lists, the score will be 3 if found in the first list, 2 in the second,\n// or 1 if in the third list).\n// If not found the score will be 0, and an empty array returned.\nparser.findInScope = function(s, scopes, cmdParams) {\n  parser.msg(\"Now matching: \" + s)\n  // First handle IT etc.\n  for (const key in lang.pronouns) {\n    if (s === lang.pronouns[key].objective && parser.pronouns[lang.pronouns[key].objective]) {\n      return [[parser.pronouns[lang.pronouns[key].objective]], 1];\n    }\n  }\n\n  for (let i = 0; i < scopes.length; i++) {\n    parser.msg(\"..Looking for a match for: \" + s + \" (scope \" + (i + 1) + \")\")\n    const objList = this.findInList(s, scopes[i], cmdParams);\n    if (objList.length > 0) {\n      return [objList, scopes.length - i];\n    }\n  }\n  return [[], 0];\n};\n\n// Tries to match an object to the given string\n// But if there are more than 1 with the same score, it returns them all\n// s is the string to match\n// list is an array of items to match again\nparser.findInList = function(s, list, cmdParams) {\n  let res = [];\n  let score = 0;\n  let n;\n  parser.msg(\"-> Trying to match: \" + s)\n  for (let item of list) {\n    //log(item)\n    parser.msg(\"-> Considering: \" + item.name)\n    n = this.scoreObjectMatch(s, item, cmdParams);\n    if (n >=0 ) parser.msg(item.name + \" scores \" + n)\n    if (n > score) {\n      res = [];\n      score = n;\n    }\n    if (n >= score) {\n      res.push(item);\n    }\n  }\n  parser.msg(res.length > 1 ? \"Cannot decide between: \" + res.map(el => el.name).join(\", \") : (res.length === 1 ? \"..Going with: \" + res[0].name : \"Found no suitable objects\"))\n  return res\n}\n\n// Override to skip quotes in aliases\nparser.itemSetup = function(item) {\n  item.parserOptionsSet = true;\n  item.parserItemName = item.alias.toLowerCase();\n  item.parserItemNameParts = array.combos(item.parserItemName.split(' '))\n  if (item.pattern) {\n    if (!item.regex) item.regex = new RegExp(\"^(\" + item.pattern + \")$\")\n    if (!item.synonyms) item.synonyms = item.pattern.split('|');\n  }\n  if (item.synonyms) {\n    if (!Array.isArray(item.synonyms)) throw 'Expected \"synonyms\" to be an array for ' + item.name\n    item.synonyms.forEach(function (el) {\n      if (el.includes(' ')) {\n        item.parserItemNameParts = item.parserItemNameParts.concat(el.split(' '))\n      }\n    })\n  }\n}\n\nparser.scoreObjectMatch = function(s, item, cmdParams) {\n  if (!item.parserOptionsSet) parser.itemSetup(item)\n  const itemName = item.alias.toLowerCase();\n  let res = -1;\n  if (cmdParams.items && cmdParams.items.includes(item.name)) {\n    // does this pay any attention to what the player typed????\n    parser.msg('The command specifically mentions this item, so highest priority, score 100')\n    res = 100;\n  }\n  else if (s === item.parserItemName) {\n    parser.msg('The player has used the exact alias, score 60')\n    res = 60;\n  }\n  else if (item.regex && item.regex.test(s)) {\n    parser.msg('The player has used the exact string allowed in the regex, score 55')\n    parser.msg('' + item.regex)\n    parser.msg('>' + s + '<')\n    res = 55;\n  }\n  else if (item.parserItemNameParts && item.parserItemNameParts.some(function(el) { return el === s})) {\n    parser.msg('The player has matched a complete word, but not the full phrase, score 50')\n    res = 50;\n  }\n  else if (item.parserItemName.startsWith(s)) {\n    parser.msg('the player has used a string that matches the start of the alias, score length + 15')\n    res = s.length + 15;\n  }\n  else if (item.synonyms && item.synonyms.some(function(el) { return el.startsWith(s)})) {\n    parser.msg('the player has used a string that matches the start of an alt name, score length + 10')\n    res = s.length + 10;\n  }\n  else if (item.parserItemNameParts && item.parserItemNameParts.some(function(el) { return el.startsWith(s)})) {\n    parser.msg('the player has used a string that matches the start of an alt name, score length')\n    res = s.length;\n  }\n  else {\n    return -1;\n  }\n\n  if (item[cmdParams.attName]) {\n    parser.msg('bonus 20 as item has attribute ' + cmdParams.attName)\n    res += 20;\n  }\n  if (item.parserPriority) {\n    parser.msg('item.parserPriority is ' + item.parserPriority)\n    res += item.parserPriority;\n  }\n\n\n  // note what we matched against in case a command wants to use it later\n  // This is a little risky as at this point it is only a suggestion,\n  // but I cannot think of a situation where it would fail.\n  // Used by COUNTABLE\n  item.cmdMatch = s;\n  return res;\n};\n\n// For debugging only\n// Prints details about the parser.currentCommand so you can\n// see what the parser has made of the player's input\nparser.inspect = function() {\n  if (!parser.debug) return;\n\n  let s = \"PARSER RESULT:<br/>\";\n  s += \"Input text: \" + parser.currentCommand.string + \"<br/>\";\n  s += \"Matched command: \" + parser.currentCommand.name + \"<br/>\";\n  s += \"Matched regex: \" + parser.currentCommand.tmp.regex + \"<br/>\";\n  s += \"Match score: \" + parser.currentCommand.tmp.score + \"<br/>\";\n  if (parser.currentCommand.all) { s += \"Player typed ALL<br/>\"; }\n  s += \"Objects/texts (\" + parser.currentCommand.tmp.objects.length + \"):\" + \"<br/>\";\n  for (let obj of parser.currentCommand.tmp.objects) {\n    if (typeof obj === \"string\") {\n      s += \"&nbsp;&nbsp;&nbsp;&nbsp;Text: \" + obj + \"<br/>\";\n    }\n    else if (Array.isArray(obj)) {\n      s += \"&nbsp;&nbsp;&nbsp;&nbsp;Objects:\" + obj.map(function(el) { return el.name; }).join(\", \") + \"<br/>\";\n    }\n    else if (obj.name) {\n      s += \"&nbsp;&nbsp;&nbsp;&nbsp;Something called :\" + obj + \"<br/>\";\n    }\n    else {\n      s += \"&nbsp;&nbsp;&nbsp;&nbsp;Something else:\" + obj + \"<br/>\";\n    }\n  }\n  debugmsg(s);\n};\n\nparser.specialText.ignore = {\n  error:function(text) {\n    return false\n  },\n  exec:function(text) {\n    return false\n  },\n}\n\nparser.specialText.text = {\n  error:function(text) {\n    return false\n  },\n  exec:function(text) {\n    return text\n  },\n}\n\nparser.specialText.fluid = {\n  error:function(text) {\n    if (settings.fluids.includes(text)) return false\n    return processText(lang.not_a_fluid_here, {text:text})\n  },\n  exec:function(text) {\n    return text\n  },\n}\n\nparser.specialText.number = {\n  error:function(text) {\n    if (text.match(/^\\d+$/)) return false\n    return !lang.numberUnits.includes(text);\n\n  },\n  exec:function(text) {\n    if (text.match(/^\\d+$/)) return parseInt(text)\n    return lang.numberUnits.indexOf(text)\n  },\n}\n\nparser.msg = function(...ary) {\n  if (parser.debug) {\n    for (let s of ary) debugmsg(\"P&gt; \" + s)\n  }\n}\n\n// One scope for ALL (use allScope if available)\nparser.getScope = function(cmdParams) {\n  if (!cmdParams.scope) {\n    console.log(\"WARNING: No scope (or scope not found) in command\")\n    return world.scope\n  }\n\n  if (cmdParams.extendedScope) {\n    return parser.scopeFromWorld(cmdParams.allScope ? cmdParams.allScope : cmdParams.scope)\n  }\n  return parser.scopeFromScope(cmdParams.allScope ? cmdParams.allScope : cmdParams.scope)\n}\n\n// Multiple scopes when not ALL\nparser.getScopes = function(cmdParams) {\n  const baseScope = cmdParams.extendedScope ? parser.scopeFromWorld(cmdParams.scope) : parser.scopeFromScope(cmdParams.scope)\n    return [baseScope, world.scope]\n}\n\nparser.scopeFromScope = function(fn, options) {\n  const list = [];\n  for (const o of world.scope) {\n    if (fn(o, options)) {\n      list.push(o);\n    }\n  }\n  return list;\n}\n\nparser.scopeFromWorld = function(fn, options) {\n  const list = [];\n  for (const key in w) {\n    if (fn(w[key], options)) {\n      list.push(w[key]);\n    }\n  }\n  return list;\n}\n\nparser.keepTogether = function(s) {\n  return lang.regex.MetaUserComment.test(s)\n}\n\n// This set is used in the objects attribute of commands\n// The \"is\" functions are for looking at a specific place\n\n// Anywhere in the world\nparser.isInWorld = function(item) {\n  return true;\n}\n// Anywhere in the world\nparser.isReachable = function(item) {\n  return item.scopeStatus.canReach && world.ifNotDark(item);\n}\n// Anywhere in the location (used by the parser for the fallback)\nparser.isVisible = function(item) {\n  return item.scopeStatus.visible && world.ifNotDark(item);\n}\n// Held or here, but not in a container\nparser.isPresent = function(item) {\n  return parser.isHere(item) || parser.isHeld(item);\n}\n// Used by examine, so the player can X ME, even if something called metalhead is here.\nparser.isPresentOrMe = function(item) {\n  return parser.isHere(item) || parser.isHeld(item) || item === player();\n}\n// ... but not in a container\nparser.isHeldNotWorn = function(item) {\n  return item.isAtLoc(player().name, world.PARSER) && world.ifNotDark(item) && !item.getWorn();\n}\nparser.isHeld = function(item) {\n  return item.isAtLoc(player().name, world.PARSER) && world.ifNotDark(item);\n}\nparser.isHeldByNpc = function(item) {\n  const npcs = parser.scopeFromScope(parser.isReachable).filter(el => el.npc);\n  for (let npc of npcs) {\n    if (item.isAtLoc(npc.name, world.PARSER)) return true;\n  }\n  return false;\n}\nparser.isWorn = function(item) {\n  return item.isAtLoc(player().name, world.PARSER) && world.ifNotDark(item) && item.getWorn();\n}\nparser.isWornByNpc = function(item) {\n  const npcs = parser.scopeFromScope(parser.isReachable).filter(el => el.npc);\n  for (let npc of npcs) {\n    if (item.isAtLoc(npc.name, world.PARSER) && item.getWorn()) return true;\n  }\n  return false;\n}\n\nparser.isNpcOrHere = function(item) {\n  return (item.isAtLoc(player().loc, world.PARSER) && world.ifNotDark(item)) || item.npc || item.player;\n}\nparser.isNpcAndHere = function(item) {\n  return player().onPhoneTo === item.name || (item.isAtLoc(player().loc, world.PARSER) && (item.npc || item.player))\n}\nparser.isHere = function(item) {\n  return item.isAtLoc(player().loc, world.PARSER) && world.ifNotDark(item);\n}\n\nparser.isForSale = function(item) {\n  return item.isForSale && item.isForSale(player().loc) && world.ifNotDark(item);\n}\n\n//parser.isInside = function(item, options) {\n//  return item.isAtLoc(options.container.name, world.PARSER) && world.ifNotDark(item);\n//}\n\n//parser.isRoom = function(item) {\n//  return item.room;\n//}\n\n// Is in a container that is reachable\nparser.isContained = function(item) {\n  const containers = parser.scopeFromScope(parser.isReachable).filter(el => el.container);\n  for (let container of containers) {\n    if (container.closed) continue;\n    if (item.isAtLoc(container.name, world.PARSER)) return true;\n  }\n  return false;\n}\n// Is in a container that is reachable, not held by player\nparser.isLocationContained = function(item) {\n  const containers = parser.scopeFromScope(parser.isReachable).filter(el => el.container)\n  for (let container of containers) {\n    if (container.closed) continue\n    if (container.isUltimatelyHeldBy(player())) continue\n    if (item.isAtLoc(container.name, world.PARSER)) return true\n  }\n  return false;\n}\n// In this location, or in a container (used by TAKE)\nparser.isHereOrContained = function(item) {\n  if (parser.isHere(item)) return true;\n  return parser.isContained(item);\n\n}\n// In this location, or in a container not held by the player (used by TAKE ALL)\nparser.isHereOrLocationContained = function(item) {\n  if (item === loc()) return false\n  if (parser.isHere(item)) return true;\n  return parser.isLocationContained(item);\n}\n// Is a CONSTRUCTION and has no location\nparser.isUnconstructed = function(item) {\n  return !item.loc && item.construction;\n}\n\n//parser.debug = true\n","// A command has an arbitrary name, a regex or pattern,\n// and a script as a minimum.\n// regex           A regex to match against\n// objects         An array of matches in the regex (see wiki)\n// script          This will be run on a successful match\n// attName         If there is no script, then this attribute on the object will be used\n// nothingForAll   If the player uses ALL and there is nothing there, use this error message\n// noobjecterror   If the player specifies an object\n// noTurnscripts   Set to true to prevent turnscripts firing even when this command is successful\n\n\"use strict\";\n\nimport {\n    ambient, askText, Cmd, commentmsg, debugmsg, failedmsg, falsemsg, findCmd, formatList, getDir,\n    io, w, lang, regions, world, array, settings, test, util, parser, cmdRules, INDEFINITE, saveLoad,\n    metamsg, msg, msgTable, printOrRun, respond, runCmd, scopeBy, sentenceCase, verbify, player, loc\n} from \"../index.js\";\n\nconst cmdDirections = []\nfor (let exit of lang.exit_list) {\n  if (exit.type === 'nocmd') continue\n  cmdDirections.push(exit.name)\n  cmdDirections.push(exit.abbrev.toLowerCase())\n  if (exit.alt) cmdDirections.push(exit.alt)\n}\n\nexport const commands = [];\n\n  // ----------------------------------\n  // Single word commands\n\n  // Cannot just set the script to helpScript as we need to allow the\n  // author to change it in code.js, which is loaded after this.\n  new Cmd('MetaHello', {\n    script:lang.helloScript,\n  });\n  new Cmd('MetaHelp', {\n    script:lang.helpScript,\n  });\n  new Cmd('MetaHint', {\n    script:function() {\n      if (settings.hintResponses) {\n        respond({char:{msg:function(s) { settings.hintResponsesInGame ? msg(s) : metamsg(s)}}}, settings.hintResponses)\n        return world.SUCCESS_NO_TURNSCRIPTS\n\n      }\n      if (settings.hintSheetData) {\n        io.showHintSheet()\n        return world.SUCCESS_NO_TURNSCRIPTS\n      }\n      // if (settings.hintInvisiClues) {\n      //   metamsg(lang.linkHintInvisiClues)\n      //   return world.SUCCESS_NO_TURNSCRIPTS\n      // }\n      return lang.hintScript()\n    },\n  });\n  new Cmd('MetaCredits', {\n    script:lang.aboutScript,\n  });\n  new Cmd('MetaDarkMode', {\n    script:io.toggleDarkMode,\n  })\n  new Cmd('MetaNarrowMode', {\n    script:io.toggleNarrowMode,\n  })\n  new Cmd('MetaAutoScrollMode', {\n    script:io.toggleAutoScrollMode,\n  })\n  new Cmd('MetaPlainFontMode', {\n    script:io.togglePlainFontMode,\n  })\n  new Cmd('MetaSilent', {\n    script:function() {\n      if (settings.silent) {\n        metamsg(lang.mode_silent_off)\n        settings.silent = false\n      }\n      else {\n        metamsg(lang.mode_silent_on)\n        settings.silent = true\n        ambient()\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaWarnings', {\n    script:lang.warningsScript,\n  })\n\n  new Cmd('MetaSpoken', {\n    script:function() {\n      if (io.spoken) {\n        io.spoken = false\n        metamsg(lang.spoken_off)\n      }\n      else {\n        io.spoken = true\n        metamsg(lang.spoken_on)\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaIntro', {\n    script:function() {\n      io.spoken = true;\n      if (typeof settings.intro === \"string\") {\n        msg(settings.intro)\n      }\n      else {\n        for (let el of settings.intro) msg(el)\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaBrief', {\n    script:function() {\n      settings.verbosity = world.BRIEF\n      metamsg(lang.mode_brief)\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaTerse', {\n    script:function() {\n      settings.verbosity = world.TERSE\n      metamsg(lang.mode_terse)\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaVerbose', {\n    script:function() {\n      settings.verbosity = world.VERBOSE\n      metamsg(lang.mode_verbose)\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n\n  new Cmd('MetaTranscript', {\n    script:lang.transcriptScript,\n  })\n  new Cmd('MetaTranscriptStart', {\n    script:function() {\n      if (saveLoad.transcript) {\n        metamsg(lang.transcript_already_on)\n        return world.FAILED\n      }\n      saveLoad.transcriptClear()\n      saveLoad.transcriptStart()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaTranscriptOn', {\n    script:function() {\n      if (saveLoad.transcript) {\n        metamsg(lang.transcript_already_on)\n        return world.FAILED\n      }\n      saveLoad.transcriptStart()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaTranscriptOff', {\n    script:function() {\n      if (!saveLoad.transcript) {\n        metamsg(lang.transcript_already_off)\n        return world.FAILED\n      }\n      saveLoad.transcriptEnd()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaTranscriptClear', {\n    script:function() {\n      saveLoad.transcriptClear()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaTranscriptShow', {\n    script:function() {\n      saveLoad.transcriptShow()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaUserComment', {\n    script:function(arr) {\n      commentmsg(\"Comment: \" + arr[0])\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n\n  // ----------------------------------\n  // File system commands\n  new Cmd('MetaSave', {\n    script:lang.saveLoadScript,\n  })\n  new Cmd('MetaSaveOverwriteGame', {\n    script:function(arr) {\n      saveLoad.saveGame(arr[0], true)\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n  new Cmd('MetaSaveGame', {\n    script:function(arr) {\n      if (settings.localStorageDisabled) {\n        saveLoad.saveGameAsFile(arr[0])\n      }\n      else {\n        saveLoad.saveGame(arr[0])\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n  new Cmd('MetaFileSaveGame', {\n    script:function(arr) {\n      saveLoad.saveGameAsFile(arr[0])\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n  new Cmd('MetaLoad', {\n    script:function(arr) {\n      if (settings.localStorageDisabled) {\n        document.getElementById('fileDialog').click()\n      }\n      else {\n        lang.saveLoadScript()\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n    objects:[\n    ]\n  })\n  new Cmd('MetaLoadGame', {\n    script:function(arr) {\n      saveLoad.loadGameFromLS(arr[0])\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n  new Cmd('MetaFileLoadGame', {\n    script:function(arr) {\n      document.getElementById('fileDialog').click()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n  new Cmd('MetaDir', {\n    script:function() {\n      saveLoad.dirGame()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaDeleteGame', {\n    script:function(arr) {\n      saveLoad.deleteGame(arr[0])\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n\n  new Cmd('MetaUndo', {\n    script:function() {\n      if (settings.maxUndo === 0) {\n        metamsg(lang.undo_disabled)\n        return world.FAILED\n      }\n      if (world.gameState.length < 2) {\n        metamsg(lang.undo_not_available)\n        return world.FAILED\n      }\n      world.gameState.pop()\n      const gameState = world.gameState[world.gameState.length - 1]\n      metamsg(lang.undo_done)\n      saveLoad.loadTheWorld(gameState)\n      w[player().loc].description()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaAgain', {\n    script:function() {\n      return io.againOrOops(true)\n    },\n  })\n  new Cmd('MetaOops', {\n    script:function() {\n      return io.againOrOops(false)\n    },\n  })\n  new Cmd('MetaRestart', {\n    script:function() {\n      askText(lang.restart_are_you_sure, function(result) {\n        if (result.match(lang.yes_regex)) {\n          location.reload()\n        }\n        else {\n          metamsg(lang.restart_no)\n        }\n      });\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n  new Cmd('MetaPronouns', {\n    script:function() {\n      metamsg('See the developer console (F12) for the current pronouns')\n      console.log(parser.pronouns)\n    },\n  })\n  new Cmd('MetaScore', {\n    script:function() {\n      metamsg(lang.scores_not_implemented)\n    },\n  })\n  new Cmd('MetaTopicsNote', {\n    script:lang.topicsScript,\n  })\n\n  // These are kind of meta-commands - perhaps free commands is a better term.\n  // I see them as jogging the user's mind about the game world, rather than\n  // doing something in the game world, so by default\n  // no ttime passes.\n  // Set settings.lookCountsAsTurn to true if you disagree!\n  new Cmd('Look', {\n    script:function() {\n      loc().description(true);\n      return settings.lookCountsAsTurn ? world.SUCCESS : world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    score:50,\n  })\n  new Cmd('Exits', {\n    script:function() {\n      msg(lang.can_go, {char:player()});\n      return settings.lookCountsAsTurn ? world.SUCCESS : world.SUCCESS_NO_TURNSCRIPTS;\n    },\n  })\n  new Cmd('Inv', {\n    script:function() {\n      const listOfOjects = player().getContents(world.INVENTORY);\n      msg(lang.inventory_prefix + \" \" + formatList(listOfOjects, {\n          article:INDEFINITE, lastSep:lang.list_and,\n          modified:true, nothing:lang.list_nothing,\n          loc:player().name\n      }) + \".\", {char:player()});\n      return settings.lookCountsAsTurn ? world.SUCCESS : world.SUCCESS_NO_TURNSCRIPTS;\n    },\n  })\n  new Cmd('Map', {\n    script:function() {\n        // todo - wtf showMap?\n      if (typeof showMap !== 'undefined') {\n        showMap();\n        return settings.lookCountsAsTurn ? world.SUCCESS : world.SUCCESS_NO_TURNSCRIPTS;\n      }\n      else {\n        const zone = w[player().loc]\n        if (!zone.zone) {\n          return failedmsg(lang.no_map);\n        }\n        else {\n          const flag = zone.drawMap()\n          if (!flag) return failedmsg(lang.no_map);\n          return world.SUCCESS_NO_TURNSCRIPTS\n        }\n      }\n    },\n  })\n  new Cmd('Topics', {\n    attName:\"topics\",\n    objects:[\n      {scope:parser.isNpcAndHere},\n    ],\n    defmsg:lang.no_topics,\n  })\n\n  new Cmd('Wait', {\n    script:function() {\n      msg(lang.wait_msg);\n      return world.SUCCESS;\n    },\n  })\n  new Cmd('Smell', {\n    script:function() {\n      if (loc().smell) {\n        printOrRun(player(), loc(), \"smell\");\n      }\n      else if (loc()._region && regions[loc()._region].smell) {\n        msg(regions[loc()._region].smell)\n      }\n      else {\n        msg(lang.no_smell, {char:player()});\n      }\n      return world.SUCCESS;\n    },\n  })\n  new Cmd('Listen', {\n    script:function() {\n      if (loc().listen) {\n        printOrRun(player(), loc(), \"listen\");\n      }\n      else if (loc()._region && regions[loc()._region].listen) {\n        msg(regions[loc()._region].listen)\n      }\n      else {\n        msg(lang.no_listen, {char:player()});\n      }\n      return world.SUCCESS;\n    },\n  })\n  new Cmd('PurchaseFromList', {\n    script:function() {\n      const l = [];\n      for (let key in w) {\n        if (parser.isForSale(w[key])) {\n          const price = w[key].getBuyingPrice(player())\n          const row = [sentenceCase(w[key].getName()), world.Money(price)];\n          // todo - wtf Money and buy??\n          row.push(price > player().money ? \"-\" : \"{cmd:buy \" + w[key].alias + \":\" + buy + \"}\")\n          l.push(row)\n        }\n      }\n      if (l.length === 0) {\n        return failedmsg(lang.nothing_for_sale);\n      }\n      msg(lang.current_money + \": \" + world.Money(player().money));\n      msgTable(l, lang.buy_headings)\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n  })\n\n  // Out of convenient order as it needs to be before TAKE\n  new Cmd('GetFluid', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {special:'fluid'},\n    ],\n    score:5,\n    script:function(objects) {\n      const options = {char:player(), fluid:objects[0]}\n      if (!util.findSource(options)) return failedmsg(lang.no_fluid_here, options)\n      return failedmsg(lang.cannot_get_fluid, options)\n    },\n  })\n\n  // ----------------------------------\n  // Verb-object commands\n  new Cmd('Examine', {\n    npcCmd:true,\n    objects:[\n      {scope:parser.isPresent, multiple:true}\n    ],\n    defmsg:lang.default_examine,\n  })\n  new Cmd('LookAt', {  // used for NPCs\n    npcCmd:true,\n    attName:'examine',\n    objects:[\n      {scope:parser.isPresentOrMe}\n    ],\n    defmsg:lang.default_examine,\n  })\n  new Cmd('LookOut', {\n    npcCmd:true,\n    rules:[cmdRules.isPresent],\n    objects:[\n      {scope:parser.isPresent}\n    ],\n    attName:\"lookout\",\n    defmsg:lang.cannot_look_out,\n  })\n  new Cmd('LookBehind', {\n    npcCmd:true,\n    rules:[cmdRules.isPresent],\n    attName:\"lookbehind\",\n    objects:[\n      {scope:parser.isPresent}\n    ],\n    defmsg:lang.nothing_there,\n  })\n  new Cmd('LookUnder', {\n    npcCmd:true,\n    rules:[cmdRules.isPresent],\n    attName:\"lookunder\",\n    objects:[\n      {scope:parser.isPresent}\n    ],\n    defmsg:lang.nothing_there,\n  })\n  new Cmd('LookThrough', {\n    npcCmd:true,\n    rules:[cmdRules.isPresent],\n    attName:\"lookthrough\",\n    objects:[\n      {scope:parser.isPresent}\n    ],\n    defmsg:lang.nothing_there,\n  })\n  new Cmd('LookInside', {\n    npcCmd:true,\n    rules:[cmdRules.isPresent],\n    attName:\"lookinside\",\n    objects:[\n      {scope:parser.isPresent}\n    ],\n    defmsg:lang.nothing_inside,\n  })\n  new Cmd('Search', {\n    npcCmd:true,\n    rules:[cmdRules.isPresent],\n    attName:\"search\",\n    objects:[\n      {scope:parser.isPresent}\n    ],\n    defmsg:lang.nothing_there,\n  })\n\n  new Cmd('Take', {\n    npcCmd:true,\n    rules:[cmdRules.isHereAlready, cmdRules.testManipulate],\n    objects:[\n      {scope:parser.isHereOrContained, allScope:parser.isHereOrLocationContained, multiple:true},\n    ],\n    defmsg:lang.cannot_take,\n  })\n  new Cmd('Drop', {\n    npcCmd:true,\n    rules:[cmdRules.isHeldNotWorn, cmdRules.testManipulate],\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    default:function(options) { falsemsg(options.item.isAtLoc(options.char) ? lang.cannot_drop : lang.not_carrying, options) },\n  })\n  new Cmd('Wear2', {\n    npcCmd:true,\n    rules:[cmdRules.isHeldNotWorn, cmdRules.isHeld, cmdRules.testManipulate],\n    attName:\"wear\",\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    default:function(options) { falsemsg(options.item.ensemble ? lang.cannot_wear_ensemble : lang.cannot_wear, options) },\n  })\n  new Cmd('Wear', {\n    npcCmd:true,\n    rules:[cmdRules.isHeldNotWorn, cmdRules.testManipulate],\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    default:function(options) { falsemsg(options.item.ensemble ? lang.cannot_wear_ensemble : lang.cannot_wear, options) },\n  })\n  new Cmd('Remove', {\n    npcCmd:true,\n    rules:[cmdRules.isWorn, cmdRules.testManipulate],\n    objects:[\n      {scope:parser.isWorn, multiple:true},\n    ],\n    default:function(options) { falsemsg(options.item.ensemble ? lang.cannot_wear_ensemble : lang.not_wearing, options) },\n  })\n  new Cmd('Remove2', {\n    npcCmd:true,\n    rules:[cmdRules.isWorn, cmdRules.testManipulate],\n    attName:\"remove\",\n    objects:[\n      {scope:parser.isWorn, multiple:true},\n    ],\n    default:function(options) { falsemsg(options.item.ensemble ? lang.cannot_wear_ensemble : lang.not_wearing, options) },\n  })\n  new Cmd('Read', {\n    npcCmd:true,\n    rules:[cmdRules.isPresent],\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    defmsg:lang.cannot_read,\n  })\n  new Cmd('Purchase', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate],\n    objects:[\n      {scope:parser.isForSale},\n    ],\n    defmsg:lang.cannot_purchase_here,\n  })\n  new Cmd('Sell', {\n    npcCmd:true,\n    rules:[cmdRules.isHeldNotWorn, cmdRules.testManipulate],\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    defmsg:lang.cannot_sell_here,\n  })\n  new Cmd('Smash', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresent],\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    defmsg:lang.cannot_smash,\n  })\n  new Cmd('Turn', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isHere},\n    ],\n    defmsg:lang.cannot_turn,\n  })\n  new Cmd('TurnLeft', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isHere},\n    ],\n    defmsg:lang.cannot_turn,\n  })\n  new Cmd('TurnRight', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isHere},\n    ],\n    defmsg:lang.cannot_turn,\n  })\n  new Cmd('SwitchOn', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    attName:\"switchon\",\n    cmdCategory:\"SwitchOn\",\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    defmsg:lang.cannot_switch_on,\n  })\n  new Cmd('SwitchOn2', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    attName:\"switchon\",\n    cmdCategory:\"SwitchOn\",\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n    ],\n    defmsg:lang.cannot_switch_on,\n  })\n\n  new Cmd('SwitchOff2', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    attName:\"switchoff\",\n    cmdCategory:\"SwitchOff\",\n    objects:[\n      {scope:parser.isHeld, multiple:true, attName:\"switchon\"},\n    ],\n    defmsg:lang.cannot_switch_off,\n  })\n  new Cmd('SwitchOff', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    attName:\"switchoff\",\n    cmdCategory:\"SwitchOff\",\n    objects:[\n      {scope:parser.isHeld, multiple:true, attName:\"switchoff\"},\n    ],\n    defmsg:lang.cannot_switch_off,\n  })\n\n  new Cmd('Open', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent, multiple:true, attName:\"open\"},\n    ],\n    defmsg:lang.cannot_open,\n  })\n  new Cmd('OpenWith', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent, multiple:true, attName:\"open\"},\n      {scope:parser.isHeld, multiple:true},\n    ],\n    defmsg:lang.cannot_open_with,\n  })\n\n  new Cmd('Close', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent, multiple:true, attName:\"close\"},\n    ],\n    defmsg:lang.cannot_close,\n  })\n\n  new Cmd('Lock', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent, multiple:true, attName:\"lock\"},\n    ],\n    defmsg:lang.cannot_lock,\n  })\n  new Cmd('LockWith', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent, attName:\"lock\"},\n      {scope:parser.isHeld, attName:'key'},\n    ],\n    defmsg:lang.cannot_lock_with,\n  })\n\n  new Cmd('Unlock', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent, multiple:true, attName:\"unlock\"},\n    ],\n    defmsg:lang.cannot_unlock,\n  })\n  new Cmd('UnlockWith', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent, attName:\"unlock\"},\n      {scope:parser.isHeld, attName:'key'},\n    ],\n    defmsg:lang.cannot_unlock_with,\n  })\n\n  new Cmd('Push', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent},\n    ],\n    defmsg:lang.nothing_useful,\n  })\n\n  new Cmd('Pull', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent},\n    ],\n    defmsg:lang.nothing_useful,\n  })\n  new Cmd('Fill', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate],\n    objects:[\n      {scope:parser.isPresent},\n    ],\n    defmsg:lang.cannot_fill,\n  })\n  new Cmd('Empty', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {scope:parser.isPresent},\n    ],\n    defmsg:lang.cannot_empty,\n  })\n\n  new Cmd('SmellItem', {\n    npcCmd:true,\n    attName:\"smell\",\n    objects:[\n      {scope:parser.isPresent, attName:\"smell\"},\n    ],\n    defmsg:lang.cannot_smell,\n  })\n  new Cmd('ListenToItem', {\n    npcCmd:true,\n    attName:\"listen\",\n    objects:[\n      {scope:parser.isPresent, attName:\"listen\"},\n    ],\n    defmsg:lang.cannot_listen,\n  })\n\n  new Cmd('Eat', {\n    npcCmd:true,\n    rules:[cmdRules.isHeldNotWorn, cmdRules.testManipulate],\n    objects:[\n      {special:'text'},\n      {scope:parser.isHeld, multiple:true, attName:\"ingest\"},\n    ],\n    defmsg:lang.cannot_eat,\n  })\n  new Cmd('Drink', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {special:'text'},\n      {scope:parser.isPresent, attName:\"ingest\"},\n    ],\n    defmsg:lang.cannot_drink,\n  })\n  new Cmd('Ingest', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {special:'text'},\n      {scope:parser.isPresent, attName:\"ingest\"},\n    ],\n    defmsg:lang.cannot_ingest,\n  })\n\n  new Cmd('Sit', {\n    npcCmd:true,\n    cmdCategory:\"Posture\",\n    rules:[cmdRules.testPosture],\n    attName:\"siton\",\n    objects:[],\n    script:function() {\n      const objs = scopeBy(el => el.siton && el.isAtLoc(player().loc))\n      log(objs)\n      if (objs.length === 0) return failedmsg(lang.no_sit_object)\n      return objs[0].siton({char:player(), item:objs[0]}) ? world.SUCCESS : world.FAILED\n    },\n  })\n  new Cmd('Recline', {\n    npcCmd:true,\n    cmdCategory:\"Posture\",\n    rules:[cmdRules.testPosture],\n    attName:\"reclineon\",\n    objects:[],\n    script:function() {\n      const objs = scopeBy(el => el.reclineon && el.isAtLoc(player().loc))\n      log(objs)\n      if (objs.length === 0) return failedmsg(lang.no_recline_object)\n      return objs[0].reclineon({char:player(), item:objs[0]}) ? world.SUCCESS : world.FAILED\n    },\n  })\n  new Cmd('SitOn', {\n    npcCmd:true,\n    cmdCategory:\"Posture\",\n    rules:[cmdRules.testPosture, cmdRules.isHere],\n    attName:\"siton\",\n    objects:[\n      {scope:parser.isHere, attName:\"assumePosture\"},\n    ],\n    defmsg:lang.cannot_sit_on,\n  })\n  new Cmd('StandOn', {\n    npcCmd:true,\n    cmdCategory:\"Posture\",\n    rules:[cmdRules.testPosture, cmdRules.isHere],\n    attName:\"standon\",\n    objects:[\n      {scope:parser.isHere, attName:\"assumePosture\"},\n    ],\n    defmsg:lang.cannot_stand_on,\n  })\n  new Cmd('ReclineOn', {\n    npcCmd:true,\n    cmdCategory:\"Posture\",\n    rules:[cmdRules.testPosture, cmdRules.isHere],\n    attName:\"reclineon\",\n    objects:[\n      {scope:parser.isHere, attName:\"assumePosture\"},\n    ],\n    defmsg:lang.cannot_recline_on,\n  })\n  new Cmd('GetOff', {\n    npcCmd:true,\n    cmdCategory:\"Posture\",\n    score:5, // to give priority over TAKE\n    rules:[cmdRules.testPosture, cmdRules.isHere],\n    attName:\"getoff\",\n    objects:[\n      {scope:parser.isHere, attName:\"assumePosture\"},\n    ],\n    defmsg:lang.already,\n  })\n\n  new Cmd('Use', {\n    npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresentOrContained],\n    objects:[\n      {scope:parser.isPresent},\n    ],\n    script:function(objects) {\n      const obj = objects[0][0]\n      const options = {char:player(), item:obj, verb:'use'}\n\n      // Use this to bypass the rules, say if the object could be in a strange place\n      if (obj.useFunction) {\n        const result = obj.useFunction(options)\n        return result ? world.SUCCESS : world.FAILED\n      }\n\n      if (obj.use) {\n        const result = this.processCommand(options)\n        return result ? world.SUCCESS : world.FAILED\n      }\n\n      if (obj.useDefaultsTo) {\n        const cmd = findCmd(obj.useDefaultsTo(player()))\n        if (cmd) {\n          const result = cmd.processCommand(options);\n          return result ? world.SUCCESS : world.FAILED\n        }\n        else {\n          throw new Error(\"USE command defaulting to unknown command \" + obj.useDefaultsTo())\n        }\n      }\n\n      this.default({char:player(), item:obj})\n      return world.FAILED;\n    },\n    defmsg:lang.cannot_use,\n  })\n\n  new Cmd('TalkTo', {\n    rules:[cmdRules.canTalkTo],\n    attName:\"talkto\",\n    objects:[\n      {scope:parser.isNpcAndHere},\n    ],\n    defmsg:lang.cannot_talk_to,\n  })\n\n  // ----------------------------------\n  // Complex commands\n\n  new Cmd('Say', {\n    script:function(arr) {\n      const l = [];\n      for (let key in w) {\n        if (w[key].sayCanHear && w[key].sayCanHear(player(), arr[0])) l.push(w[key]);\n      }\n      l.sort(function(a, b) { return (b.sayPriority + b.sayBonus) - (a.sayPriority + b.sayBonus); });\n      if (l.length === 0) {\n          // todo - say_no_one_here is string!\n        // msg(lang.say_no_one_here(player, arr[0], arr[1]));\n        return world.SUCCESS;\n      }\n\n      const options = {char:player(), text: sentenceCase(arr[1])}\n      if (settings.givePlayerSayMsg) msg(lang.say_something, options)\n      for (let chr of l) {\n        if (chr.sayQuestion && chr.respondToAnswer(arr[1])) return world.SUCCESS;\n        if (chr.sayResponse && chr.sayResponse(arr[1], arr[0])) return world.SUCCESS;\n      }\n      if (settings.givePlayerSayMsg) {\n        msg(lang.say_no_response, options);\n      }\n      else {\n        msg(lang.say_no_response_full, options);\n      }\n      return world.SUCCESS;\n    },\n    objects:[\n      {special:'text'},\n      {special:'text'},\n    ]\n  })\n\n  new Cmd('Stand', {\n    rules:[cmdRules.testPosture],\n    script:handleStandUp,\n  })\n  new Cmd('NpcStand', {\n    rules:[cmdRules.testPosture],\n    cmdCategory:\"Posture\",\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n    ],\n    script:handleStandUp,\n  })\n\n  new Cmd('Make', {\n    objects:[\n      {scope:parser.isUnconstructed, extendedScope:true},\n    ],\n    script:function(objects) {\n      const obj = objects[0][0]\n      return obj.build({char:player(), item:obj}) ? world.SUCCESS : world.FAILED\n    },\n  })\n  new Cmd('MakeWith', {\n    objects:[\n      {scope:parser.isUnconstructed, extendedScope:true},\n      {scope:parser.isHere, multiple:true},\n    ],\n    script:function(objects) {\n      const obj = objects[0][0]\n      const options = {char:player(), item:obj}\n      if (!obj.testComponents(objects[1], options)) return world.FAILED\n      return obj.build(options) ? world.SUCCESS : world.FAILED\n    },\n  })\n  new Cmd('NpcMake', {\n    objects:[\n      {scope:parser.isUnconstructed},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0]\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      const obj = objects[0][0]\n      return obj.build({char:npc, item:obj}) ? world.SUCCESS : world.FAILED\n    },\n  })\n  new Cmd('NpcMakeWith', {\n    objects:[\n      {scope:parser.isUnconstructed},\n      {scope:parser.isHere, multiple:true},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0]\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      const obj = objects[0][0]\n      const options = {char:npc, item:obj}\n      if (!obj.testComponents(objects[1], options)) return world.FAILED\n      return obj.build(options) ? world.SUCCESS : world.FAILED\n    },\n  })\n\n  new Cmd('FillWith', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {scope:parser.isHeld},\n      {special:'fluid'},\n    ],\n    script:function(objects) {\n      return handleFillFromUnknown(player(), objects[0][0], objects[1]);\n    },\n  })\n  new Cmd('NpcFillWith', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Fill\",\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHeld},\n      {special:'fluid'},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0]\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      return handleFillFromUnknown(npc, objects[0][0], objects[1])\n    },\n  })\n  new Cmd('EmptyInto', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {scope:parser.isHeld},\n      {scope:parser.isPresent},\n    ],\n    script:function(objects) {\n      return handleFillFromVessel(player(), objects[0][0], objects[1][0], undefined);\n    },\n  })\n  new Cmd('NpcEmptyInto', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Fill\",\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHeld},\n      {scope:parser.isPresent},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0]\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      return handleFillFromVessel(npc, objects[0][0], objects[1][0], undefined)\n    },\n  })\n  new Cmd('EmptyFluidInto', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {special:'fluid'},\n      {scope:parser.isPresent},\n    ],\n    script:function(objects) {\n      return handleEmptyFluidInto(player(), objects[1][0], objects[0]);\n    },\n  })\n  new Cmd('NpcEmptyFluidInto', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Fill\",\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {special:'fluid'},\n      {scope:parser.isPresent},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0]\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      return handleEmptyFluidInto(npc, objects[1][0], objects[0])\n    },\n  })\n  new Cmd('PutFluidIn', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {special:'fluid'},\n      {scope:parser.isPresent, attName: \"container\"},\n    ],\n    script:function(objects) {\n      return handleFillFromUnknown(player(), objects[1][0], objects[0])\n    },\n  })\n\n  new Cmd('PutIn', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n      {scope:parser.isPresent, attName: \"container\"},\n    ],\n    script:function(objects) {\n      return handleInOutContainer(player(), objects, \"drop\", handleSingleDropInContainer)\n    },\n  })\n\n  new Cmd('NpcPutIn', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Drop/in\",\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHeldByNpc, multiple:true},\n      {scope:parser.isPresent, attName: \"container\"},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0]\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      return handleInOutContainer(npc, objects, \"drop\", handleSingleDropInContainer)\n    },\n  })\n\n  new Cmd('TakeOut', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresent],\n    objects:[\n      {scope:parser.isContained, multiple:true},\n      {scope:parser.isPresent, attName: \"container\"},\n    ],\n    script:function(objects) {\n      return handleInOutContainer(player(), objects, \"take\", handleSingleTakeOutContainer)\n    },\n  })\n\n  new Cmd('NpcTakeOut', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Take\",\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isContained, multiple:true},\n      {scope:parser.isPresent, attName: \"container\"},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0]\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      return handleInOutContainer(npc, objects, \"take\", handleSingleTakeOutContainer)\n    },\n  })\n\n  new Cmd('GiveTo', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    objects:[\n      {scope:parser.isHeld, multiple:true},\n      {scope:parser.isPresent, attName: \"npc\"},\n    ],\n    script:function(objects) {\n      return handleGiveToNpc(player(), objects)\n    },\n  })\n  new Cmd('NpcGiveTo', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Give\",\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHeldByNpc, multiple:true},\n      {scope:parser.isPresentOrMe, attName: \"npc\"},\n    ],\n    script:function(objects) {\n      const npc = objects[0][0];\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift()\n      return handleGiveToNpc(npc, objects)\n    },\n  })\n\n  new Cmd('Give', {\n    antiRegexes:[lang.regex.GiveTo],\n    matchItems:function(s) {\n      if (!this._test(s)) return\n      if (!this._testNot(s)) return\n\n      parser.msg(\"---------------------------------------------------------\");\n      parser.msg(\"* Looking at candidate: \" + this.name);\n\n      // this is a temporary set of data used while we parser one input\n      this.tmp.objectTexts = [];\n      this.tmp.objects = [];\n      this.tmp.score = this.score ? this.score : 10\n      this.tmp.error = undefined\n\n      let arr = this.tmp.regex.exec(s)\n      arr.shift()  // first element is the whole match, so discard\n\n      const scope = world.scope\n      const npcs = scope.filter(el => (el.npc && el !== player()))\n      const items = array.fromTokens(arr[0].split(' '), scope)\n      if (!items) return this.setError(parser.NO_OBJECT, lang.object_unknown_msg(arr[0]))\n\n      // The first item could be the NPC to give it to,\n      // and we want to pull that out.\n      // Disambiguation makes this tricky...\n      if (items[0].length === 1) {\n        // No need to disambig, only one item matched\n        if (items[0][0].npc) {\n          this.tmp.objects[1] = items[0]\n          items.shift()\n          this.tmp.objects[0] = items\n        }\n        else {\n          if (npcs.length === 0) return this.setError(parser.NO_OBJECT, lang.object_unknown_msg(arr[0]))\n          this.tmp.objects[1] = npcs\n          this.tmp.objects[0] = items\n        }\n      }\n      else {\n        // At least two items matched\n        // NPCs will take priority\n        const npcList = items[0].filter(el => el.npc)\n        if (npcList.length === 0) {\n          if (npcs.length === 0) return this.setError(parser.NO_OBJECT, lang.no_receiver)\n          this.tmp.objects[1] = npcs\n          this.tmp.objects[0] = items\n        }\n        else if (npcList.length === 1) {\n          this.tmp.objects[1] = [npcList[0]]\n          items.shift()\n          this.tmp.objects[0] = items\n        }\n        else {\n          this.tmp.objects[1] = [npcList]\n          items.shift()\n          this.tmp.objects[0] = items\n        }\n      }\n\n      // pre-disambig items in this.tmp.objects[0]\n      for (let i = 0; i < this.tmp.objects[0].length; i++) {\n        const el = this.tmp.objects[0][i]\n        if (el.length === 1) {\n          this.tmp.objects[0][i] = el[0]\n        }\n        else {\n          const held = el.filter(el => el.loc === player().name)\n          if (held.length === 1) {\n            this.tmp.objects[0][i] = held[0]\n          }\n          else if (held.length > 1) {\n            this.tmp.objects[0][i] = held\n          }\n          // otherwise, stick we hat we have\n        }\n      }\n\n      this.tmp.score = 10\n      parser.msg(\"..Base score: \" + this.tmp.score)\n    },\n\n    script:function(objects) {\n      return handleGiveToNpc(player(), objects)\n    },\n  })\n\n  new Cmd('NpcGive', {\n    antiRegexes:lang.regex.NpcGiveTo,\n    matchItems:function(s) {\n      if (!this._test(s)) return\n      if (!this._testNot(s)) return\n\n      parser.msg(\"---------------------------------------------------------\")\n      parser.msg(\"* Looking at candidate: \" + this.name)\n\n      // this is a temporary set of data used while we parse one input\n      this.tmp.objectTexts = [];\n      this.tmp.objects = [];\n      this.tmp.score = this.score ? this.score : 10\n      this.tmp.error = undefined\n\n      let arr = this.tmp.regex.exec(s)\n      arr.shift()  // first element is the whole match, so discard\n      const scope = world.scope\n\n      // Which NPC are we asking to do this?\n      let char\n      const charString = arr.shift()\n      const possibleChars = parser.findInList(charString, scope, {})\n      if (possibleChars.length === 0) return this.setError(parser.NO_OBJECT, lang.object_unknown_msg(charString))\n      if (possibleChars.length === 1) {\n        char = possibleChars[0]\n      }\n      else {\n        const actualChars = possibleChars.filter(el => ((el.npc || el.player) && el !== char))\n        if (possibleChars.length === 0) {\n          char = possibleChars\n        }\n        else if (possibleChars.length === 1) {\n          char = possibleChars[0]\n        }\n        else {\n          char = possibleChars\n        }\n      }\n\n      // npcs is a list of people we could be asking the character to give to\n      const npcs = scope.filter(el => ((el.npc || el.player) && el !== char))\n      const items = array.fromTokens(arr[0].split(' '), scope)\n      if (!items) return this.setError(parser.NO_OBJECT, lang.object_unknown_msg(arr[0]))\n\n      // The first item could be the NPC to give it to,\n      // and we want to pull that out.\n      // Disambiguation makes this tricky...\n      if (items[0].length === 1) {\n        // No need to disambig, only one item matched\n        if (items[0][0].npc || items[0][0] === player()) {\n          this.tmp.objects[1] = items[0]\n          items.shift()\n          this.tmp.objects[0] = items\n        }\n        else {\n          if (npcs.length === 0) return this.setError(parser.NO_OBJECT, lang.object_unknown_msg(arr[0]))\n          this.tmp.objects[1] = npcs\n          this.tmp.objects[0] = items\n        }\n      }\n      else {\n        // At least two items matched\n        // NPCs will take priority\n        const npcList = items[0].filter(el => el.npc || el.player)\n        if (npcList.length === 0) {\n          if (npcs.length === 0) return this.setError(parser.NO_OBJECT, lang.no_receiver)\n          this.tmp.objects[1] = npcs\n          this.tmp.objects[0] = items\n        }\n        else if (npcList.length === 1) {\n          this.tmp.objects[1] = [npcList[0]]\n          items.shift()\n          this.tmp.objects[0] = items\n        }\n        else {\n          this.tmp.objects[1] = [npcList]\n          items.shift()\n          this.tmp.objects[0] = items\n        }\n      }\n\n      // pre-disambig items in this.tmp.objects[0]\n      for (let i = 0; i < this.tmp.objects[0].length; i++) {\n        const el = this.tmp.objects[0][i]\n        if (el.length === 1) {\n          this.tmp.objects[0][i] = el[0]\n        }\n        else {\n          const held = el.filter(el => el.loc === char.name)\n          if (held.length === 1) {\n            this.tmp.objects[0][i] = held[0]\n          }\n          else if (held.length > 1) {\n            this.tmp.objects[0][i] = held\n          }\n          // otherwise, stick we hat we have\n        }\n      }\n      this.tmp.objects.unshift([char])\n\n      this.tmp.score = 10\n      parser.msg(\"..Base score: \" + this.tmp.score)\n    },\n\n    script:function(objects) {\n      const char = objects[0][0]\n      objects.shift()\n      return handleGiveToNpc(char, objects)\n    },\n  })\n\n  new Cmd('LookExit', {\n    script:function(objects) {\n\n      const dirName = getDir(objects[0])\n      const attName = 'look_' + dirName\n      const exit = loc()[dirName]\n      const tpParams = {char:player(), dir:dirName, exit:exit}\n\n      if (typeof loc()[attName] === \"function\") {\n        const res = loc()[attName](tpParams);\n        return res ? world.SUCCESS : world.FAILED;\n      }\n\n      if (!exit || exit.isHidden()) return failedmsg(lang.no_look_that_way, tpParams)\n      if (exit.isLocked()) return failedmsg(lang.locked_exit, {char:player(), exit:exit})\n\n      tpParams.dest = w[exit.name]\n      if (loc()[attName]) {\n        msg(loc()[attName], tpParams)\n      }\n      else if (typeof exit.look === \"function\") {\n        return exit.look(tpParams)\n      }\n      else if (exit.look) {\n        msg(exit.look, tpParams)\n      }\n      else {\n        msg(lang.default_look_exit, tpParams)\n        return world.SUCCESS_NO_TURNSCRIPTS\n      }\n      return world.SUCCESS\n    },\n    objects:[\n      {special:'text'},\n    ]\n  })\n\n  new Cmd('PushExit', {\n    rules:[cmdRules.testManipulate, cmdRules.isHere],\n    cmdCategory:\"Push\",\n    script:function(objects) {\n      return handlePushExit(player(), objects);\n    },\n    objects:[\n      {special:'text'},\n      {scope:parser.isHere, attName:\"shiftable\"},\n      {special:'text'},\n    ]\n  })\n  new Cmd('NpcPushExit', {\n    rules:[cmdRules.testManipulate, cmdRules.isHere],\n    cmdCategory:\"Push\",\n    script:function(objects) {\n      const npc = objects[0][0];\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift();\n      return handlePushExit(npc, objects);\n    },\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {special:'text'},\n      {scope:parser.isHere, attName:\"shiftable\"},\n      {special:'text'},\n    ]\n  })\n\n  new Cmd('TieUp', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Tie\",\n    objects:[\n      {scope:parser.isHeld, attName:\"rope\"},\n    ],\n    script:function(objects) {\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:player()})\n      return rope.handleTieTo(player())\n    },\n  })\n  new Cmd('TieTo', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Tie\",\n    objects:[\n      {scope:parser.isHeld, attName:\"rope\"},\n      {scope:parser.isHere, attName:\"attachable\"},\n    ],\n    script:function(objects) {\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:player()})\n      return rope.handleTieTo(player(), objects[1][0])\n    },\n  })\n  new Cmd('NpcTieUp', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Tie\",\n    script:function(objects) {\n      const npc = objects[0][0];\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift();\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:npc})\n      return rope.handleTieTo(npc)\n    },\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHeld, attName:\"rope\"},\n    ]\n  })\n  new Cmd('NpcTieTo', {\n    rules:[cmdRules.testManipulate, cmdRules.isHeld],\n    cmdCategory:\"Tie\",\n    script:function(objects) {\n      const npc = objects[0][0];\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift();\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:npc})\n      return rope.handleTieTo(npc, objects[1][0])\n    },\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHeld, attName:\"rope\"},\n      {scope:parser.isHere, attName:\"attachable\"},\n    ]\n  })\n\n  new Cmd('Untie', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresent],\n    cmdCategory:\"Untie\",\n    objects:[\n      {scope:parser.isHere, attName:\"rope\"},\n    ],\n    script:function(objects) {\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:player()})\n      return rope.handleUntieFrom(player())\n    },\n  })\n  new Cmd('NpcUntie', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresent],\n    cmdCategory:\"Tie\",\n    script:function(objects) {\n      const npc = objects[0][0];\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift();\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:npc})\n      return rope.handleUntieFrom(npc)\n    },\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHeld, attName:\"rope\"},\n    ]\n  })\n\n  new Cmd('UntieFrom', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresent],\n    cmdCategory:\"Untie\",\n    objects:[\n      {scope:parser.isHere, attName:\"rope\"},\n      {scope:parser.isHere, attName:\"attachable\"},\n    ],\n    script:function(objects) {\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:npc})\n      return rope.handleUntieFrom(player(), objects[1][0])\n    },\n  })\n  new Cmd('NpcUntieFrom', {\n    rules:[cmdRules.testManipulate, cmdRules.isPresent],\n    cmdCategory:\"Tie\",\n    script:function(objects) {\n      const npc = objects[0][0];\n      if (!npc.npc) return failedmsg(lang.not_npc, {char:player(), item:npc})\n      objects.shift();\n      const rope = objects[0][0]\n      if (!rope.rope) return failedmsg(lang.rope_not_attachable, {rope:rope, char:npc})\n      return rope.handleUntieFrom(npc, objects[1][0])\n    },\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHere, attName:\"rope\"},\n      {scope:parser.isHere, attName:\"attachable\"},\n    ]\n  })\n\n  new Cmd('UseWith', {\n    //npcCmd:true,\n    rules:[cmdRules.testManipulate, cmdRules.isPresent],\n    objects:[\n      {scope:parser.isPresent},\n      {scope:parser.isPresent},\n    ],\n    script:function(objects) {\n      const obj = objects[0][0]\n      const obj2 = objects[1][0]\n\n      if (obj.useWith) {\n        const result = obj.useWith(player(), obj2)\n        return result ? world.SUCCESS : world.FAILED\n      }\n      if (obj2.withUse) {\n        const result = obj2.withUse(player(), obj)\n        return result ? world.SUCCESS : world.FAILED\n      }\n\n      if (obj.useWithDefaultsTo) {\n        const cmd = findCmd(obj.useWithDefaultsTo())\n        if (cmd) {\n          const result = cmd.script(objects)\n          return result ? world.SUCCESS : world.FAILED\n        }\n        else {\n          throw new Error(\"USE command defaulting to unknown command \" + obj.useWithDefaultsTo)\n        }\n      }\n      if (obj2.withUseDefaultsTo) {\n        const cmd = findCmd(obj2.withUseDefaultsTo())\n        if (cmd) {\n          const result = cmd.script(objects)\n          return result ? world.SUCCESS : world.FAILED\n        }\n        else {\n          throw new Error(\"USE command defaulting to unknown command \" + obj2.withUseDefaultsTo)\n        }\n      }\n\n      this.default({char:player(), item:obj})\n      return world.FAILED;\n    },\n    defmsg:lang.cannot_use,\n  })\n\n  new Cmd('FollowMe', {\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n    ],\n    script:function(objects) {\n      const obj = objects[0][0]\n      const tpParams = {char:player(), npc:obj}\n      if (!obj.npc) return failedmsg(lang.cannot_follow, tpParams)\n      if (!obj.getAgreement(\"Follow\")) return world.FAILED\n      return obj.startFollow() ? world.SUCCESS : world.FAILED\n    },\n  })\n\n  new Cmd('WaitHere', {\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n    ],\n    script:function(objects) {\n      const obj = objects[0][0]\n      const tpParams = {item:obj}\n      if (!obj.npc) return falsemsg(lang.cannot_wait, tpParams)\n\n      return obj.endFollow() ? world.SUCCESS : world.FAILED\n    },\n  })\n\n  new Cmd('AskAbout', {\n    rules:[cmdRules.canTalkTo],\n    script:function(arr) {\n      if (!player().testTalk()) return false\n      if (!arr[0][0].askabout) return failedmsg(lang.cannot_ask_about, {char:player(), item:arr[0][0], text:arr[2]})\n\n      return arr[0][0].askabout(arr[2], arr[1]) ? world.SUCCESS : world.FAILED\n    },\n    objects:[\n      {scope:parser.isNpcAndHere},\n      {special:'text'},\n      {special:'text'},\n    ]\n  })\n  new Cmd('TellAbout', {\n    rules:[cmdRules.canTalkTo],\n    script:function(arr) {\n      if (!player().testTalk()) return false\n      if (!arr[0][0].tellabout) return failedmsg(lang.cannot_tell_about, {char:player(), item:arr[0][0], text:arr[1]})\n\n      return arr[0][0].tellabout(arr[2], arr[1]) ? world.SUCCESS : world.FAILED\n    },\n    objects:[\n      {scope:parser.isNpcAndHere},\n      {special:'text'},\n      {special:'text'},\n    ]\n  })\n  new Cmd('TalkAbout', {\n    rules:[cmdRules.canTalkTo],\n    //score:1, // to override TALK TO\n    script:function(arr) {\n      if (!player().testTalk()) return false\n      if (!arr[0][0].tellabout && !arr[0][0].askabout) return failedmsg(lang.cannot_tell_about, {char:player(), item:arr[0][0], text:arr[1]})\n\n      return arr[0][0].talkabout(arr[2], arr[1]) ? world.SUCCESS : world.FAILED\n    },\n    objects:[\n      {scope:parser.isNpcAndHere},\n      {special:'text'},\n      {special:'text'},\n    ]\n  })\n\nfor (const s of ['In', 'Out', 'Up', 'Down', 'Through']) {\n  new Cmd('Go' + s + 'Item', {\n    objects:[{scope:parser.isHere, attName:\"go\" + s + \"Direction\"}],\n    dirType:s,\n    script:function(objects) {\n      if (typeof objects[0][0][\"go\" + this.dirType + \"Item\"] === 'string') {\n        return failedmsg(objects[0][0][\"go\" + this.dirType + \"Item\"], {char:player(), item:objects[0][0]})\n      }\n      return loc().goItem(objects[0][0], this.dirType)\n    },\n  })\n  new Cmd('NpcGo' + s + 'Item', {\n    objects:[\n      {scope:parser.isHere, attName:\"npc\"},\n      {scope:parser.isHere, attName:\"go\" + s + \"Direction\"},\n    ],\n    dirType:s,\n    script:function(objects) {\n      if (typeof objects[1][0][\"go\" + this.dirType + \"Item\"] === 'string') {\n        return failedmsg(objects[1][0][\"go\" + this.dirType + \"Item\"], {char:objects[0][0], item:objects[1][0]})\n      }\n      return loc().goItem(objects[1][0], this.dirType, objects[0][0])\n    },\n  })\n}\n\nfor (const el of lang.questions) {\n  new Cmd('Question' + verbify(el.q), {\n    regex:new RegExp('^' + el.q + '\\\\??$'),\n    objects:[],\n    script:el.script,\n  })\n}\n\n// DEBUG commands\n\nif (settings.playMode === 'dev') {\n  new Cmd('DebugWalkThrough', {\n    objects:[\n      {special:'text'},\n    ],\n    script:function(objects) {\n        // todo wtf walkthroughts\n      if (typeof walkthroughs === \"undefined\") {\n        metamsg(\"No walkthroughs set\")\n        return world.FAILED\n      }\n      const wt = walkthroughs[objects[0]]\n      if (wt === undefined) return failedmsg(\"No walkthrough found called \" + objects[0])\n      settings.walkthroughInProgress = true\n      for (let el of wt) {\n        if (typeof el === \"string\") {\n          runCmd(el)\n        }\n        else if (typeof el === \"function\") {\n          el()\n        }\n        else {\n          settings.walkthroughMenuResponses = Array.isArray(el.menu) ? el.menu : [el.menu]\n          runCmd(el.cmd)\n          settings.walkthroughMenuResponses = []\n        }\n      }\n      settings.walkthroughInProgress = false\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n\n  new Cmd('DebugInspect', {\n    script:function(arr) {\n      const item = arr[0][0];\n      debugmsg(\"See the console for details on the object \" + item.name + \" (press F12 to world. the console)\");\n      console.log(item);\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n      {scope:parser.isInWorld},\n    ],\n  })\n\n  new Cmd('DebugInspectByName', {\n    script:function(arr) {\n      const item_name = arr[0]\n      if (!w[item_name]) {\n        debugmsg(\"No object called \" + item_name);\n        return world.FAILED;\n      }\n\n      debugmsg(\"See the console for details on the object \" + item_name + \" (press F12 to world. the console)\");\n      console.log(w[item_name]);\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n      {special:'text'},\n    ],\n  })\n\n  new Cmd('DebugWarpName', {\n    script:function(arr) {\n      const o = w[arr[0]]\n      if (!o) {\n        debugmsg(\"No object called \" + arr[0]);\n        return world.FAILED;\n      }\n\n      if (o.room) {\n        player().loc = o.name\n        debugmsg(\"Moved to \" + o.name)\n      }\n      else {\n        o.loc = player().name\n        delete o.scenery\n        debugmsg(\"Retrieved \" + o.name + \" (as long as it uses the \\\"loc\\\" attribute normally)\")\n      }\n      return world.SUCCESS\n    },\n    objects:[\n      {special:'text'},\n    ],\n  })\n\n  new Cmd('DebugTest', {\n    script:function() {\n      if (!settings.tests) {\n        metamsg('The TEST command is for unit testing during game development, and is not activated (F12 for more).')\n        console.log('To activate testing in your game, set settings.tests to true. More details here: https://github.com/ThePix/QuestJS/wiki/Unit-testing')\n        return world.SUCCESS_NO_TURNSCRIPTS;\n      }\n      if (typeof test.runTests !== 'function') {\n        console.log(test)\n        return world.FAILED\n      }\n      test.runTests();\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n  })\n\n  new Cmd('DebugInspectCommand', {\n    script:function(arr) {\n      debugmsg (\"Looking for \" + arr[0]);\n      for (let cmd of commands) {\n        if (cmd.name.toLowerCase() === arr[0] || (cmd.cmdCategory && cmd.cmdCategory.toLowerCase() === arr[0])) {\n          debugmsg(\"Name: \" + cmd.name);\n          for (let key in cmd) {\n            if (cmd.hasOwnProperty(key)) {\n               debugmsg(\"--\" + key + \": \" + cmd[key]);\n            }\n          }\n        }\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n      {special:'text'},\n    ],\n  })\n\n  new Cmd('DebugListCommands', {\n    script:function(arr) {\n      let count = 0;\n      for (let cmd of commands) {\n        if (!cmd.name.match(/\\d$/)) {\n          let s = cmd.name + \" (\" + cmd.regex\n\n          let altCmd\n          let n = 2\n          do {\n            altCmd = commands.find(el => el.name === cmd.name + n)\n            if (altCmd) s += \" or \" + altCmd.regex\n            n++\n          } while (altCmd)\n          s += \")\"\n\n          const npcCmd = commands.find(el => el.name === \"Npc\" + cmd.name + \"2\")\n          if (npcCmd) s += \" - NPC too\"\n          debugmsg(s);\n          count++;\n        }\n      }\n      debugmsg(\"... Found \" + count + \" commands.\");\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n    ],\n  })\n\n  new Cmd('DebugListCommands2', {\n    script:function(arr) {\n      let count = 0;\n      for (let cmd of commands) {\n        let s = cmd.name + \" (\" + cmd.regex + \")\"\n        debugmsg(s);\n        count++;\n      }\n      debugmsg(\"... Found \" + count + \" commands.\");\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n    ],\n  })\n\n  new Cmd('DebugParserToggle', {\n    script:function(arr) {\n      if (parser.debug) {\n        parser.debug = false\n        debugmsg (\"Parser debugging messages are off.\");\n      }\n      else {\n        parser.debug = true\n        debugmsg (\"Parser debugging messages are on.\");\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n    ],\n  })\n\n  new Cmd('DebugStats', {\n    script:function(arr) {\n      for (const el of settings.statsData) el.count = 0\n      for (const key in w) {\n        for (const el of settings.statsData) {\n          const res = el.test(w[key])\n          if (res === true) el.count++\n          if (typeof res === 'number') el.count += res\n        }\n      }\n      for (const el of settings.statsData) {\n        debugmsg(el.name + \": \" + el.count)\n      }\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n    ],\n  })\n\n\n  new Cmd('DebugHighlight', {\n    script:function(arr) {\n      for (const el of document.querySelectorAll('.parser')) {\n        el.style.color = 'black'\n        el.style.backgroundColor = 'yellow'\n      }\n      for (const el of document.querySelectorAll('.error')) {\n        el.style.backgroundColor = 'yellow'\n      }\n      for (const el of document.querySelectorAll('.meta')) {\n        el.style.color = 'black'\n        el.style.backgroundColor = '#8f8'\n      }\n      debugmsg (\"Previous parser and error messages are now highlighted.\");\n      return world.SUCCESS_NO_TURNSCRIPTS;\n    },\n    objects:[\n    ],\n  })\n\n\n  new Cmd('MetaTranscriptWalkthrough', {\n    script:function() {\n      saveLoad.transcriptWalk()\n      return world.SUCCESS_NO_TURNSCRIPTS\n    },\n  })\n\n}\n\n// Functions used by commands\n// (but not in the commands array)\n\n// Cannot handle multiple vessels\n// want to transfer a fluid from a source to a sink\n\nexport function handleFillFromUnknown(char, sink, fluid) {\n  // fluid can be undefined\n  const options = {fluid:fluid}\n  if (!util.findSource(options)) return failedmsg(fluid ? lang.no_fluid_here : lang.no_fluid_here_at_all, options)\n  if (options.source.vessel) return handleFillFromVessel(char, options.source, sink, options.fluid)\n  return handleFillFromSource(char, options.source, sink, options.fluid)\n}\n\nexport function handleFillFromVessel(char, source, sink, fluid) {\n  // fluid can be undefined\n  if (!fluid) fluid = source.containedFluidName\n  const options = {char:char, source:source, fluid:fluid, item:sink}\n\n  if (!source.vessel) return failedmsg(lang.not_vessel, options)\n  if (source.closed) return  failedmsg(lang.container_closed, options)\n  if (!source.containedFluidName) return failedmsg(lang.already_empty, options)\n  if (!sink.vessel && !sink.sink) return failedmsg(lang.not_sink, options)\n  if (sink.vessel && sink.containedFluidName) return failedmsg(lang.already_full, options)\n  if (!char.testManipulate(source, \"fill\")) return world.FAILED\n  if (!char.getAgreement(\"Fill\", {source:source, sink:sink, fluid:fluid})) return world.FAILED\n  if (!source.isAtLoc(char.name)) return failedmsg(lang.not_carrying, options)\n  if (source.containedFluidName !== fluid) return failedmsg(lang.no_fluid_here, options);\n  return source.doEmpty(options) ? world.SUCCESS: world.FAILED;\n}\n\nexport function handleFillFromSource(char, source, sink, fluid) {\n  const options = {char:char, source:source, fluid:fluid, item:sink}\n\n  if (!source.isSourceOf) return failedmsg(lang.not_source, options)\n  if (source.closed) return  failedmsg(lang.container_closed, options)\n  if (!sink.vessel) return failedmsg(lang.not_vessel, options)\n  if (sink.containedFluidName) return failedmsg(lang.already_full, options)\n  if (!char.testManipulate(sink, \"fill\")) return world.FAILED\n  if (!char.getAgreement(\"Fill\", {source:source, sink:sink, fluid:fluid})) return world.FAILED\n  // if the source is the room itself, we assume it is here\n  if (!source.room && !source.isAtLoc(char.loc)) return failedmsg(lang.not_here, options)\n  if (!source.isSourceOf(fluid)) return failedmsg(lang.no_fluid_here, options)\n  return sink.doFill(options) ? world.SUCCESS: world.FAILED;\n}\n\nexport function handleEmptyFluidInto(char, sink, fluid) {\n  for (const key in w) {\n    const o = w[key]\n    if (o.vessel && o.containedFluidName === fluid && o.loc === char.name) {\n      return handleFillFromVessel(char, o, sink, fluid)\n    }\n  }\n  return failedmsg(lang.not_carrying_fluid, {char:char, fluid:fluid});\n}\n\nexport function handleInOutContainer(char, objects, verb, func) {\n  let success = false;\n  const container = objects[1][0];\n  const options = {char:char, container:container, verb:verb, multiple:objects[0].length > 1 || parser.currentCommand.all}\n\n  if (container.handleInOutContainer) return container.handleInOutContainer(options, objects[0])\n\n  if (!container.container) return failedmsg(lang.not_container, options)\n  if (container.closed) {\n    if (container.containerAutoOpen) {\n      if (!container.open({char:char, item:container})) return false\n    }\n    else if (!container.containerIgnoreClosed) {\n      return failedmsg(lang.container_closed, options)\n    }\n  }\n\n  for (const obj of objects[0]) {\n    if (!char.testManipulate(obj, verb)) return world.FAILED\n    options.count = obj.countable ? obj.extractNumber() : undefined\n    options.item = obj\n    if (options.count) options[obj.name + '_count'] = options.count  // for the text processor\n    const flag = func(char, container, obj, options)\n    success = success || flag\n  }\n  if (success) char.pause();\n  return success ? world.SUCCESS : world.FAILED;\n}\n\nexport function handleSingleDropInContainer(char, container, obj, options) {\n  options.fromLoc = char.name\n  options.toLoc = container.name\n  if (!char.getAgreement(\"Drop/in\", {item:obj, container:container})) return\n  if (!container.testForRecursion(char, obj)) return false\n  if (obj.testDrop && !obj.testDrop(options)) return false\n  if (!obj.msgDropIn) return falsemsg(lang.cannot_drop, options)\n  if (container.testDropIn && !container.testDropIn(options)) return false\n  if (!obj.isAtLoc(char.name)) return failedmsg(lang.not_carrying, {char:char, item:obj})\n  if (obj.getTakeDropCount) obj.getTakeDropCount(options, char.name)\n\n  if (typeof obj.msgDropIn === 'function') {\n    obj.msgDropIn(options)\n  }\n  else {\n    msg(obj.msgDropIn, options)\n  }\n  obj.moveToFrom(options)\n  return true;\n}\n\nexport function handleSingleTakeOutContainer(char, container, obj, options) {\n  options.toLoc = char.name\n  options.fromLoc = container.name\n  if (!char.getAgreement(\"Take\", {item:obj})) return false\n  if (!obj.isAtLoc(container.name)) return failedmsg(lang.not_inside, {container:container, item:obj})\n  if (obj.getTakeDropCount) obj.getTakeDropCount(options, container.name)\n  if (obj.testTake && !obj.testTake(options)) return false\n  if (container.testTakeOut && !container.testTakeOut(options)) return false\n\n  msg(obj.msgTakeOut, options)\n  obj.moveToFrom(options)\n  return true\n}\n\nexport function handleGiveToNpc(char, objects) {\n  let success = false;\n  const npc = objects[1][0];\n  const multiple = objects[0].length > 1 || parser.currentCommand.all;\n  if (!npc.npc && npc !== player()) return failedmsg(lang.not_npc_for_give, {char:char, item:npc})\n  if (!npc.handleGiveTo) log(npc)\n\n  for (const obj of objects[0]) {\n    const flag = npc.handleGiveTo({char:char, npc:npc, multiple:multiple, item:obj, toLoc:npc.name, fromLoc:char.name})\n    success = success || flag\n  }\n  // noinspection EqualityComparisonWithCoercionJS\n    if (success == world.SUCCESS) char.pause();\n  return success ? world.SUCCESS : world.FAILED;\n}\n\nexport function handleStandUp(objects) {\n  let char\n  if (objects.length === 0) {\n    char = player()\n  }\n  else {\n    const npc = objects[0][0]\n    if (!npc.npc) {\n      failedmsg(lang.not_npc, {char:player(), item:npc});\n      return world.FAILED;\n    }\n    if (!npc.posture) {\n      failedmsg(lang.already, {item:npc});\n      return world.FAILED;\n    }\n    if (!npc.getAgreement(\"Posture\", {posture:\"stand\"})) {\n      // The getAgreement should give the response\n      return world.FAILED;\n    }\n    char = npc\n  }\n\n  if (!char.testPosture()) {\n    return world.FAILED;\n  }\n  if (char.posture) {\n    msg(lang.stop_posture(char))\n    char.pause();\n    return world.SUCCESS;\n  }\n}\n\n// we know the char can manipulate, we know the obj is here and not held\nexport function handlePushExit(char, objects) {\n  const verb = objects[0]\n  const obj = objects[1][0];\n  const dir = getDir(objects[2]);\n  const room = w[char.loc]\n  const tpParams = {char:char, item:obj, dir:dir}\n\n  if (!obj.shiftable && obj.takeable) return failedmsg(lang.take_not_push, tpParams)\n  if (!obj.shiftable) return failedmsg(lang.cannot_push, tpParams)\n  if (!room[dir] || room[dir].isHidden()) return failedmsg(lang.not_that_way, tpParams)\n  if (room[dir].isLocked()) return failedmsg(lang.locked_exit, {char:char, exit:room[dir]})\n  if (typeof room[dir].noShiftingMsg === \"function\") return failedmsg(room[dir].noShiftingMsg(char, item))\n  if (typeof room[dir].noShiftingMsg === \"string\") return failedmsg(room[dir].noShiftingMsg)\n  if (!char.getAgreement(\"Push\", {item:obj, dir:dir})) return false\n\n  if (typeof obj.shift === \"function\") {\n    const res = obj.shift(char, dir, verb);\n    return res ? world.SUCCESS : world.FAILED;\n  }\n\n  // by default, objects cannot be pushed up\n  if (dir === \"up\") {\n    msg(lang.cannot_push_up, tpParams);\n    return world.FAILED;\n  }\n\n  // not using moveToFrom; if there are\n  const dest = room[dir].name;\n  obj.moveToFrom({char:char, toLoc:dest, item:obj});\n  char.loc = dest;\n  tpParams.dest = w[dest]\n  msg(lang.push_exit_successful, tpParams);\n  return world.SUCCESS;\n}\n"],"names":["NULL_FUNC","test","log","debuglog","s","settings","parserlog","parser","runCmd","cmd","io","doOnce","o","c","str","saveLoad","commentmsg","printOrRun","char","item","attname","options","msg","errormsg","verbify","random","n1","n2","percentile","arr","deleteEntry","index","res","average","total","dice","negative","match","rolls","number","sides","i","n","highestOf","a","b","explodeOn","exploderCount","el","rerollOn","countIf","ary","s2","sentenceCase","titleCase","sentenceCaseForHTML","template","node","titleCaseForHTML","spaces","prefix","warningFor","formatList","itemArray","toRemove","toAdd","array","l","lang","listProperties","obj","arabic","roman","toRoman","result","displayMoney","showsign","displayNumber","control","regex","places","padding","factor","decimal","getDir","exit","rChunkString","len","r","chunk","ary1","ary2","x","attName","value","circular","att","count","newary","e","sep","j","k","scope","cmdParams","items","opt","scopeReachable","list","key","w","world","scopeHeldBy","chr","player","situation","scopeHereListed","scopeHereParser","scopeNpcHere","ignoreDark","scopeAllNpcHere","scopeBy","func","util","contName","falsemsg","util$1","num","min","max","eventName","triggerTime","interval","game","alias","p","object","currentValue","oldValue","strings","parts","respond","params","response","getResponseList","extraTest","route","data","sublist","level","modified","INDEFINITE","intervals","d","includeCurlyBraces","f","dict","timeInSeconds","time","seconds","minutes","hours","days","timeString","hour","minute","nowTime","targetTime","pronouns","setPlayer","name","room","fluids","objNames","objName","loc","toLoc","fromLoc","tpParams","dir","run","doc","path","file","filename","link","settings$1","dur","diag","text1","text2","npc","flag","metamsg","wait","html","now","type","suboptions","noun","bit","md","pos","hundreds","units","tens","or","verb","gender","conj","_global","this","bom","blob","opts","download","url","xhr","saveAs","corsEnabled","click","evt","isMacOSWebView","URL","popup","force","isSafari","isChromeIOS","reader","overwrite","comment","myFile","currentdate","tp","fileIn","contents","clearScreen","encodedTitle","removeHeader","endTurnUI","saveType","clonePrototype","cloneObject","hash","attType","error","Exit","arr0","arr1","arr2","_msg","keys","previous","achievementsJSON","achievements","processText","fn","left","end","start","colours","upper","lower","style","colour","cycling","def","val","transit","button","destName","s1","id","reverse","attValue","moreThan","orEqual","locAtt","listOfOjects","isPossessive","isList","subject","DEFINITE","COUNT","pronoun","name1","chr1","name2","chr2","printError","err","suppressTrace","event","processed","line","rawPrint","cssClass","msgPre","OutputTextNoBr","msgBlankLine","msgDiv","msgList","ordered","msgTable","headings","row","msgHeading","picture","width","height","src","image","sound","ambient","volume","video","draw","failedmsg","parsermsg","debugmsg","blankLine","hr","delay","text","trigger","showMenu","title","showMenuNumbersOnly","disableTextFunction","disable","showMenuWithNumbers","failFunction","input","showDropDown","showMenuDiag","displayFunction","showYesNoMenu","showYesNoMenuWithNumbers","showYesNoDropDown","askText","showDiag","submitButton","askDiag","update","createAdditionalPane","position","div","tab","myScript","reactFunction","keepSL","slID","last","newMask","command","mapImageWidth","margin","oldClass","newClass","collection","inv","st","itemName","uniq","action","htmlDiv","isSubItem","highlight","verbList","referenceNode","commands","keycode","range","altVoice","utterThis","giveOptions","textArea","successful","isAgain","prop","datatransform","js","words","uniqueWords","numbers","word","Cmd$1","first","score","specialError","special","exclude","objectNames","objects","success","suppressEndturn","secondItem","multiple","rule","NpcCmd","Cmd","ExitCmd","ex","exitObj","NpcExitCmd","initCommands","regexAsStr","el2","regexes","extractChar","findCmd","testCmd","cmdRules","DEFAULT_OBJECT","mode","turn","DEFAULT_ROOM","dest","locked","hidden","DEFAULT_ITEM","toLock","create","picocolors_browserModule","pico","require$$0","terminalHighlight","require$$1","CssSyntaxError","message","column","source","plugin","color","css","lines","maxWidth","mark","aside","bold","red","gray","gutter","spacing","code","cssSyntaxError","CssSyntaxError$3","symbols","DEFAULT_RAW","capitalize","Stringifier$2","builder","semicolon","right","between","string","child","before","after","own","detect","parent","root","method","buf","depth","indent","step","raw","stringifier","Stringifier","stringify","stringify_1","stringify$4","isClean","my","require$$2","require$$3","cloneNode","cloned","Node$4","defaults","overrides","nodes","bookmark","foundSelf","add","defaultType","keepBetween","_","inputs","fixed","emitInputs","inputsNextIndex","inputId","next","Node","declaration","Declaration","Declaration$4","urlAlphabet","nonSecure","nanoid","size","alphabet","defaultSize","SourceMapConsumer","SourceMapGenerator","existsSync","readFileSync","dirname","join","fromBase64","PreviousMap$2","prev","sourceMapString","comments","baseCharsetUri","baseUri","charsetUri","uri","encoding","prevPath","map","previousMap","PreviousMap","fileURLToPath","pathToFileURL","resolve","isAbsolute","require$$4","require$$5","require$$6","fromOffsetCache","sourceMapAvailable","pathAvailable","Input$4","offset","lastLine","lineToIndex","prevIndex","mid","endLine","endColumn","origin","consumer","from","to","fromUrl","json","Input","relative","mapGenerator","cssString","annotation","already","content","eol","noSource","mapping","Comment","Comment$4","parse","Rule","AtRule","Root","cleanSource","markDirtyUp","Container","callback","iterator","selector","children","exist","existIndex","pattern","decl","condition","sample","args","cb","other","dependant","container","Container$7","LazyResult","Processor","Document","document","Document$3","printed","warnOnce","Warning$2","warning","Warning","Result$3","processor","Result","SINGLE_QUOTE","DOUBLE_QUOTE","BACKSLASH","SLASH","NEWLINE","SPACE","FEED","TAB","CR","OPEN_SQUARE","CLOSE_SQUARE","OPEN_PARENTHESES","CLOSE_PARENTHESES","OPEN_CURLY","CLOSE_CURLY","SEMICOLON","ASTERISK","COLON","AT","RE_AT_END","RE_WORD_END","RE_BAD_BRACKET","RE_HEX_ESCAPE","tokenize","ignore","quote","escape","escaped","escapePos","currentToken","length","buffer","returned","unclosed","what","endOfFile","nextToken","ignoreUnclosed","controlChar","back","token","atRule","AtRule$3","Container$5","Root$5","Container$4","separators","current","split","inQuote","prevQuote","letter","list_1","list$3","values","Rule$3","Container$3","tokenizer","SAFE_COMMENT_NEIGHBOR","findLastWithPosition","tokens","colon","bracket","brackets","customProperty","firstSpaces","cache","shift","open","clean","all","lastTokenType","element","founded","Parser","parse_1","parse$3","Container$2","MapGenerator","require$$7","require$$8","TYPE_TO_CLASS_NAME","PLUGIN_PROPS","NOT_VISITORS","CHILDREN","isPromise","getEvents","toStack","events","cleanMarks","postcss","LazyResult$2","onFulfilled","onRejected","onFinally","promise","subRoot","visitors","visitor","roots","pluginName","pluginVer","runtimeVer","stack","filter","visit","lazyResult","Document$2","NoWorkResult$1","self","generatedCSS","generatedMap","noWorkResult","NoWorkResult","Processor$1","plugins","normalized","Document$1","fromJSON","ownInputs","inputHydrated","fromJSON_1","fromJSON$1","require$$9","require$$10","require$$11","require$$12","require$$13","require$$14","require$$15","require$$16","require$$17","initializer","warningPrinted","creator","transformer","processOpts","pluginOpts","postcss_1","TAKEABLE_DICTIONARY","TAKEABLE","SHIFTABLE","createEnsemble","ensembleMembers","createItem","worn","member","MERCH","locs","cost","COUNTABLE","countableLocs","sourceLoc","tryContainers","containers","m","WEARABLE","wear_layer","slots","toWear","slot","outer","OPENABLE_DICTIONARY","CONTAINER","openable","SURFACE","OPENABLE","alreadyOpen","LOCKED_WITH","keyNames","LOCKED_DOOR","loc1","loc2","room1","exit1","room2","exit2","KEY","READABLE","mustBeHeld","BACKSCENE","locationType","regions","addendum","FURNITURE","posture","adverb","SWITCHABLE","alreadyOn","nameModifier","lighting","COMPONENT","nameOfWhole","EDIBLE","isLiquid","VESSEL","CONSTRUCTION","componentNames","components","ROPE","tetheredTo","obj1","obj2","end1","holder1","end2","holder2","BUTTON_DICTIONARY","BUTTON","TRANSIT_BUTTON","nameOfTransit","transitDest","ROOM_SET","setName","EXIT_FAKER","TRANSIT","exitDir","transitButton","includeHidden","includeLocked","callEvent","previousDest","buttons","CHARACTER","cmdType","clothing","garment","state","held","follower","PLAYER","createItemOrRoom","TOPIC","createRoom","region","aliases","createFunc","createObject","newName","clone","copyObject","copy","listOfHashes","Link","reverseDir","dirs","out","light","somethingHappened","dirObj","setRegion","NPC","isFemale","CONSULTABLE","AGENDA_FOLLOWER","counter","npc_utilities","questionName","q","topics","agenda","functionName","immediate","followerName","leaderName","maxlength","currentList","nextList","exits","intro","Question","responses","fromStart","isShow","t","parser$1","inputText","needToDisAmbigFlag","inEndTurnFlag","outcome","cmdString","bestMatch","scopes","objectWordList","objDisambigList","objDisambigList2","el1","objList","npcs","cmdDirections","gameState","zone","price","objs","handleStandUp","handleFillFromUnknown","handleFillFromVessel","handleEmptyFluidInto","handleInOutContainer","handleSingleDropInContainer","handleSingleTakeOutContainer","handleGiveToNpc","npcList","charString","possibleChars","dirName","handlePushExit","rope","wt","item_name","altCmd","sink","fluid","handleFillFromSource"],"mappings":"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ACV,EACD,CACE,KAAK,SACL,SAAS,EACV,EACD,CACE,KAAK,QACL,SAAS,EACV,EACD,CACE,KAAK,OACL,SAAS,EACV,EACD,CACE,KAAK,UACL,SAAS,EACV,EAGD,CACE,KAAK,OACL,MAAM,GACN,SAAS,EACV,EACD,CACE,KAAK,MACN,EACD,CACE,KAAK,QACL,MAAM,GACN,SAAS,EACV,EACD,CACE,KAAK,OACL,MAAM,GACN,SAAS,EACV,EAGD,CACE,KAAK,QACL,SAAS,EACV,EACD,CACE,KAAK,cACL,SAAS,EACV,EACD,CACE,KAAK,aACL,SAAS,EACV,EACD,CACE,KAAK,SACL,MAAM,GACN,SAAS,EACV,EACD,CACE,KAAK,OACL,MAAM,GACN,SAAS,EACV,EACD,CACE,KAAK,QACL,MAAM,GACN,SAAS,EACV,EAGD,CACE,KAAK,QACL,MAAM,EACP,EACD,CACE,KAAK,cACL,SAAS,EACV,EACD,CACE,KAAK,WACL,MAAM,GACN,SAAS,GACT,SAAS,EACV,EAGD,CACE,KAAK,OACL,MAAM,GACN,KAAK,MACN,EACD,CACE,KAAK,OACL,MAAM,GACN,SAAS,GACT,KAAK,MACN,EACD,CACE,KAAK,OACL,MAAM,GACN,KAAK,MACN,EAGD,CACE,KAAK,KACN,EACD,CACE,KAAK,UACL,MAAM,GACN,SAAS,EACV,EACD,CACE,KAAK,OACL,SAAS,EACV,EACD,CACE,KAAK,UACL,SAAS,EACV,EACD,CACE,KAAK,QACL,MAAM,EACP,EACD,CACE,KAAK,QACL,MAAM,EACP,EACD,CACE,KAAK,QACL,MAAM,EACP,EAGD,CACE,KAAK,QACL,MAAM,EACP,EACD,CACE,KAAK,UACL,MAAM,EACP,EACD,CACE,KAAK,SACL,MAAM,EACP,CACH,EAEAH,EAAK,OAAS,SAASxG,EAAM,CAC3BjB,EAAI,uCAAuC,EAC3CA,EAAI,iDAAmDiB,EAAK,IAAI,EAChElB,EAAK,QAAU,GACf,UAAWwJ,KAAK9B,EAAK,eACf8B,EAAE,QACJxJ,EAAK,WAAa,CAAE,EACpBM,EAAO,MAAMkJ,EAAE,IA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","x_google_ignoreList":[9,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]}